<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>StableDiffusionWebUI鉴权设计 | aiken's blog</title>
<meta name=keywords content="AI,AIGC,Web,Flask"><meta name=description content="[> [!summary]+

this article purpose is to build an authority page for stable diffusion webui using nginx & python/js. Which can publish my personal stable diffusion server. Wrote by GPT(try).



  
    
  





Introduction
In the digital age, the security and user-friendliness of web services are not just conveniences; they are necessities. Balancing robust security protocols with an engaging user experience is key to maintaining both the integrity and popularity of any online service. This blog post dives into the intricacies of securing web services using Nginx for authentication, coupled with designing an appealing frontend. Our journey begins with a practical scenario:
publishing a stable diffusion webUI service, accessible only to an authenticated audience.
Setting Up Nginx for Secure Authentication
Nginx excels in serving web pages and as a reverse proxy, providing enhanced security through authentication mechanisms. Let’s explore a typical Nginx configuration for secure authentication:

/verify_token: This block forwards authentication requests to a dedicated server. By excluding the request body and focusing on essential headers, it ensures that only valid, authenticated requests proceed.

location = /verify_token {
    proxy_pass http://{your_auth_server}:2424;
    proxy_pass_request_body off;
    proxy_set_header Content-Length &#34;&#34;;
    proxy_set_header X-Original-URI $request_uri;
    proxy_set_header X-Original-Remote-Addr $remote_addr;
    proxy_set_header X-Original-Host $host;
}

/login: Catering to login requests, this configuration forwards the necessary details to the authentication server, preserving crucial information about the request&rsquo;s origin.

location /login {
    proxy_pass http://{your_auth_server}:2424;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}

Error Handling (@error401): A clever redirect mechanism that guides unauthenticated users to the login page, keeping the original URL intact.

location @error401 {
    return 302 {your_domain}/login;
}

Root Location (/): The gateway to your service, which rigorously checks each request for authentication, granting access only to verified users.

location / {
    auth_request /verify_token;
    error_page 401 = @error401;
    proxy_pass http://{your_server}:2323/;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_set_header Host $host;
    proxy_cache_bypass $http_upgrade;
}
This setup not only fortifies your service against unauthorized access but also maintains a seamless user experience, redirecting unauthenticated users without hassle."><meta name=author content="aikenhong"><link rel=canonical href=https://hugotest-phi.vercel.app/posts/stablediffusionwebui%E9%89%B4%E6%9D%83%E8%AE%BE%E8%AE%A1/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://hugotest-phi.vercel.app/favicon/ghost.ico><link rel=icon type=image/png sizes=16x16 href=https://hugotest-phi.vercel.app/favicon/ghost-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://hugotest-phi.vercel.app/favicon/ghost-32x32.png><link rel=apple-touch-icon href=https://hugotest-phi.vercel.app/favicon/ghost-apple-touch-icon.png><link rel=mask-icon href=https://hugotest-phi.vercel.app/favicon/ghost-192x192.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://hugotest-phi.vercel.app/posts/stablediffusionwebui%E9%89%B4%E6%9D%83%E8%AE%BE%E8%AE%A1/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script src=https://cdn.jsdmirror.com/npm/jquery@3.5.1/dist/jquery.min.js></script><link rel=stylesheet href=https://cdn.jsdmirror.com/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css><script src=https://cdn.jsdmirror.com/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js></script><link rel=stylesheet href=https://cdn.jsdmirror.com/npm/katex@0.16.11/dist/katex.min.css><script defer src=https://cdn.jsdmirror.com/npm/katex@0.16.11/dist/katex.min.js></script><script defer src=https://cdn.jsdmirror.com/npm/katex@0.16.11/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><link rel=stylesheet href=https://cdn.jsdmirror.com/npm/lxgw-wenkai-webfont@1.1.0/style.css><link rel=stylesheet href=https://cdn.jsdmirror.com/npm/lxgw-wenkai-lite-webfont@1.1.0/style.css><link rel=stylesheet href=https://cdn.jsdmirror.com/npm/lxgw-wenkai-tc-webfont@1.0.0/style.css><link rel=stylesheet href=https://cdn.jsdmirror.com/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap" rel=stylesheet><meta property="og:url" content="https://hugotest-phi.vercel.app/posts/stablediffusionwebui%E9%89%B4%E6%9D%83%E8%AE%BE%E8%AE%A1/"><meta property="og:site_name" content="aiken's blog"><meta property="og:title" content="StableDiffusionWebUI鉴权设计"><meta property="og:description" content="[> [!summary]+
this article purpose is to build an authority page for stable diffusion webui using nginx & python/js. Which can publish my personal stable diffusion server. Wrote by GPT(try).
Introduction In the digital age, the security and user-friendliness of web services are not just conveniences; they are necessities. Balancing robust security protocols with an engaging user experience is key to maintaining both the integrity and popularity of any online service. This blog post dives into the intricacies of securing web services using Nginx for authentication, coupled with designing an appealing frontend. Our journey begins with a practical scenario:
publishing a stable diffusion webUI service, accessible only to an authenticated audience.
Setting Up Nginx for Secure Authentication Nginx excels in serving web pages and as a reverse proxy, providing enhanced security through authentication mechanisms. Let’s explore a typical Nginx configuration for secure authentication:
/verify_token: This block forwards authentication requests to a dedicated server. By excluding the request body and focusing on essential headers, it ensures that only valid, authenticated requests proceed. location = /verify_token {proxy_pass http://{your_auth_server}:2424;proxy_pass_request_body off;proxy_set_header Content-Length &#34;&#34;;proxy_set_header X-Original-URI $request_uri;proxy_set_header X-Original-Remote-Addr $remote_addr;proxy_set_header X-Original-Host $host;} /login: Catering to login requests, this configuration forwards the necessary details to the authentication server, preserving crucial information about the request’s origin. location /login {proxy_pass http://{your_auth_server}:2424;proxy_set_header Host $host;proxy_set_header X-Real-IP $remote_addr;proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;proxy_set_header X-Forwarded-Proto $scheme;} Error Handling (@error401): A clever redirect mechanism that guides unauthenticated users to the login page, keeping the original URL intact. location @error401 {return 302 {your_domain}/login;} Root Location (/): The gateway to your service, which rigorously checks each request for authentication, granting access only to verified users. location / {auth_request /verify_token;error_page 401 = @error401;proxy_pass http://{your_server}:2323/;proxy_http_version 1.1;proxy_set_header Upgrade $http_upgrade;proxy_set_header Connection 'upgrade';proxy_set_header Host $host;proxy_cache_bypass $http_upgrade;} This setup not only fortifies your service against unauthorized access but also maintains a seamless user experience, redirecting unauthenticated users without hassle."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-01-27T15:42:36+00:00"><meta property="article:modified_time" content="2024-01-27T15:42:36+00:00"><meta property="article:tag" content="AI"><meta property="article:tag" content="AIGC"><meta property="article:tag" content="Web"><meta property="article:tag" content="Flask"><meta property="og:image" content="https://hugotest-phi.vercel.app/cover/cover16.jpeg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://hugotest-phi.vercel.app/cover/cover16.jpeg"><meta name=twitter:title content="StableDiffusionWebUI鉴权设计"><meta name=twitter:description content="[> [!summary]+

this article purpose is to build an authority page for stable diffusion webui using nginx & python/js. Which can publish my personal stable diffusion server. Wrote by GPT(try).



  
    
  





Introduction
In the digital age, the security and user-friendliness of web services are not just conveniences; they are necessities. Balancing robust security protocols with an engaging user experience is key to maintaining both the integrity and popularity of any online service. This blog post dives into the intricacies of securing web services using Nginx for authentication, coupled with designing an appealing frontend. Our journey begins with a practical scenario:
publishing a stable diffusion webUI service, accessible only to an authenticated audience.
Setting Up Nginx for Secure Authentication
Nginx excels in serving web pages and as a reverse proxy, providing enhanced security through authentication mechanisms. Let’s explore a typical Nginx configuration for secure authentication:

/verify_token: This block forwards authentication requests to a dedicated server. By excluding the request body and focusing on essential headers, it ensures that only valid, authenticated requests proceed.

location = /verify_token {
    proxy_pass http://{your_auth_server}:2424;
    proxy_pass_request_body off;
    proxy_set_header Content-Length &#34;&#34;;
    proxy_set_header X-Original-URI $request_uri;
    proxy_set_header X-Original-Remote-Addr $remote_addr;
    proxy_set_header X-Original-Host $host;
}

/login: Catering to login requests, this configuration forwards the necessary details to the authentication server, preserving crucial information about the request&rsquo;s origin.

location /login {
    proxy_pass http://{your_auth_server}:2424;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}

Error Handling (@error401): A clever redirect mechanism that guides unauthenticated users to the login page, keeping the original URL intact.

location @error401 {
    return 302 {your_domain}/login;
}

Root Location (/): The gateway to your service, which rigorously checks each request for authentication, granting access only to verified users.

location / {
    auth_request /verify_token;
    error_page 401 = @error401;
    proxy_pass http://{your_server}:2323/;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_set_header Host $host;
    proxy_cache_bypass $http_upgrade;
}
This setup not only fortifies your service against unauthorized access but also maintains a seamless user experience, redirecting unauthenticated users without hassle."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://hugotest-phi.vercel.app/posts/"},{"@type":"ListItem","position":2,"name":"StableDiffusionWebUI鉴权设计","item":"https://hugotest-phi.vercel.app/posts/stablediffusionwebui%E9%89%B4%E6%9D%83%E8%AE%BE%E8%AE%A1/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"StableDiffusionWebUI鉴权设计","name":"StableDiffusionWebUI鉴权设计","description":"[\u0026gt; [!summary]+\nthis article purpose is to build an authority page for stable diffusion webui using nginx \u0026amp; python/js. Which can publish my personal stable diffusion server. Wrote by GPT(try).\nIntroduction In the digital age, the security and user-friendliness of web services are not just conveniences; they are necessities. Balancing robust security protocols with an engaging user experience is key to maintaining both the integrity and popularity of any online service. This blog post dives into the intricacies of securing web services using Nginx for authentication, coupled with designing an appealing frontend. Our journey begins with a practical scenario:\npublishing a stable diffusion webUI service, accessible only to an authenticated audience.\nSetting Up Nginx for Secure Authentication Nginx excels in serving web pages and as a reverse proxy, providing enhanced security through authentication mechanisms. Let’s explore a typical Nginx configuration for secure authentication:\n/verify_token: This block forwards authentication requests to a dedicated server. By excluding the request body and focusing on essential headers, it ensures that only valid, authenticated requests proceed. location = /verify_token {\rproxy_pass http://{your_auth_server}:2424;\rproxy_pass_request_body off;\rproxy_set_header Content-Length \u0026#34;\u0026#34;;\rproxy_set_header X-Original-URI $request_uri;\rproxy_set_header X-Original-Remote-Addr $remote_addr;\rproxy_set_header X-Original-Host $host;\r} /login: Catering to login requests, this configuration forwards the necessary details to the authentication server, preserving crucial information about the request\u0026rsquo;s origin. location /login {\rproxy_pass http://{your_auth_server}:2424;\rproxy_set_header Host $host;\rproxy_set_header X-Real-IP $remote_addr;\rproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\rproxy_set_header X-Forwarded-Proto $scheme;\r} Error Handling (@error401): A clever redirect mechanism that guides unauthenticated users to the login page, keeping the original URL intact. location @error401 {\rreturn 302 {your_domain}/login;\r} Root Location (/): The gateway to your service, which rigorously checks each request for authentication, granting access only to verified users. location / {\rauth_request /verify_token;\rerror_page 401 = @error401;\rproxy_pass http://{your_server}:2323/;\rproxy_http_version 1.1;\rproxy_set_header Upgrade $http_upgrade;\rproxy_set_header Connection \u0026#39;upgrade\u0026#39;;\rproxy_set_header Host $host;\rproxy_cache_bypass $http_upgrade;\r} This setup not only fortifies your service against unauthorized access but also maintains a seamless user experience, redirecting unauthenticated users without hassle.\n","keywords":["AI","AIGC","Web","Flask"],"articleBody":"[\u003e [!summary]+\nthis article purpose is to build an authority page for stable diffusion webui using nginx \u0026 python/js. Which can publish my personal stable diffusion server. Wrote by GPT(try).\nIntroduction In the digital age, the security and user-friendliness of web services are not just conveniences; they are necessities. Balancing robust security protocols with an engaging user experience is key to maintaining both the integrity and popularity of any online service. This blog post dives into the intricacies of securing web services using Nginx for authentication, coupled with designing an appealing frontend. Our journey begins with a practical scenario:\npublishing a stable diffusion webUI service, accessible only to an authenticated audience.\nSetting Up Nginx for Secure Authentication Nginx excels in serving web pages and as a reverse proxy, providing enhanced security through authentication mechanisms. Let’s explore a typical Nginx configuration for secure authentication:\n/verify_token: This block forwards authentication requests to a dedicated server. By excluding the request body and focusing on essential headers, it ensures that only valid, authenticated requests proceed. location = /verify_token {\rproxy_pass http://{your_auth_server}:2424;\rproxy_pass_request_body off;\rproxy_set_header Content-Length \"\";\rproxy_set_header X-Original-URI $request_uri;\rproxy_set_header X-Original-Remote-Addr $remote_addr;\rproxy_set_header X-Original-Host $host;\r} /login: Catering to login requests, this configuration forwards the necessary details to the authentication server, preserving crucial information about the request’s origin. location /login {\rproxy_pass http://{your_auth_server}:2424;\rproxy_set_header Host $host;\rproxy_set_header X-Real-IP $remote_addr;\rproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\rproxy_set_header X-Forwarded-Proto $scheme;\r} Error Handling (@error401): A clever redirect mechanism that guides unauthenticated users to the login page, keeping the original URL intact. location @error401 {\rreturn 302 {your_domain}/login;\r} Root Location (/): The gateway to your service, which rigorously checks each request for authentication, granting access only to verified users. location / {\rauth_request /verify_token;\rerror_page 401 = @error401;\rproxy_pass http://{your_server}:2323/;\rproxy_http_version 1.1;\rproxy_set_header Upgrade $http_upgrade;\rproxy_set_header Connection 'upgrade';\rproxy_set_header Host $host;\rproxy_cache_bypass $http_upgrade;\r} This setup not only fortifies your service against unauthorized access but also maintains a seamless user experience, redirecting unauthenticated users without hassle.\nImplementing JWT for Robust Backend Authentication Implementing JWT (JSON Web Tokens) in a Flask web application provides a secure way of handling authentication. The provided Flask code demonstrates how JWT can be integrated for a robust backend authentication system:\nSetup and Environment Variables: The Flask app is configured with a secret key, essential for JWT encoding and decoding. 1 2 3 4 5 6 7 from flask import Flask import os from dotenv import load_dotenv load_dotenv() app = Flask(__name__) app.secret_key = os.getenv('SECRET_KEY') Login Route: The /login route handles user authentication. Upon successful login, a JWT is encoded with the user’s information and expiration time, then sent as a cookie. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 @app.route('/login', methods=['POST', 'GET']) def login(): count = update_visit_count() if request.method == 'POST': username = request.form['username'] password = request.form['password'] # Validate credentials (use a secure method in production) if username == os.getenv('chat_username') and password == os.getenv('password'): token = jwt.encode({ 'user': username, 'exp': datetime.datetime.utcnow() + datetime.timedelta(minutes=30) }, app.secret_key, algorithm='HS256') response = make_response(redirect('/')) response.set_cookie('token', token, max_age=1800) # Keep login status for 30 mins return response error = 'Invalid credentials' return render_template('login.html', error=error, count=count), 401 # Show login page return render_template('login.html',count=count) Token Verification: A decorator token_required is used to verify the JWT token in subsequent requests. This ensures that only authenticated users can access certain routes. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 def token_required(f): def decorator(*args, **kwargs): token = request.cookies.get('token') if not token: print('token is none') return redirect('/login') try: jwt.decode(token, app.secret_key, algorithms=['HS256']) except: print('token is invalid') return redirect('/login') return f(*args, **kwargs) decorator.__name__ = f.__name__ return decorator Token Validation Endpoint: The /verify_token endpoint checks the validity of the token, which is essential for integrating with the Nginx authentication mechanism. 1 2 3 4 5 6 7 8 9 10 11 @app.route('/verify_token') def verify_token(): token = request.cookies.get('token') if not token: return 'Access Denied', 401 try: jwt.decode(token, app.secret_key, algorithms=['HS256']) return 'Authorized', 200 except: return 'Access Denied', 401 Dynamic Secret Key Update: A function update_secret_key_in_env is included to update the secret key daily, enhancing security by invalidating old tokens. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 # Function to generate a new secret key and write it to the .env file def update_secret_key_in_env(): env_file_path = '.env' secret_key = f'SECRET_KEY={secrets.token_urlsafe(32)}' last_updated = f'LAST_UPDATED={datetime.datetime.now().strftime(\"%Y-%m-%d\")}' key_updated = False # Check if .env file exists and read the content if os.path.exists(env_file_path): with open(env_file_path, 'r') as file: lines = file.readlines() # Update or add SECRET_KEY and LAST_UPDATED for i, line in enumerate(lines): if 'LAST_UPDATED' in line: last_updated_date = line.strip().split('=')[1] if last_updated_date != datetime.datetime.now().strftime(\"%Y-%m-%d\"): lines[i] = last_updated + '\\n' key_updated = True elif 'SECRET_KEY' in line: if key_updated is True: lines[i] = secret_key + '\\n' else: print(\"no need to update the secret key today\") key_updated = True # If SECRET_KEY or LAST_UPDATED are not found, add them if not key_updated: lines.append(last_updated + '\\n') lines.append(secret_key + '\\n') key_updated = True # Write back to .env file with open(env_file_path, 'w') as file: file.writelines(lines) else: # If .env file doesn't exist, create one with open(env_file_path, 'w') as file: file.writelines([last_updated + '\\n', secret_key + '\\n']) key_updated = True if key_updated: print(\"Secret key and last updated date added/updated in .env file.\") else: print(\"No update required for today.\") Visitor Count Feature: As part of the user experience, a visitor count is maintained, which is updated with each visit. 1 2 3 4 5 6 7 8 9 10 def update_visit_count(): try: with open(\"visit_count.txt\", \"r\") as file: count = int(file.read()) with open(\"visit_count.txt\", \"w\") as file: count += 1 file.write(str(count)) return count except IOError: return \"Error\" This implementation of JWT in a Flask application exemplifies a secure and efficient way of handling user authentication, ensuring that only authorized users can access protected services.\nDesigning a User-Friendly Frontend In tandem with robust backend security, the frontend of your web service plays a crucial role in user engagement and satisfaction. Let’s delve into the key features of our project’s frontend design:\nTheme Toggle and Slogan:\nThe theme switcher allows users to choose between dark and light modes. 1 2 3 4 5 6 \u003cdiv class=\"theme-switch-wrapper\"\u003e \u003cbutton id=\"theme-toggle\" class=\"theme-toggle\"\u003e \u003cspan class=\"moon\"\u003e\u0026#9790;\u003c/span\u003e \u003cspan class=\"sun\"\u003e\u0026#9728;\u003c/span\u003e \u003c/button\u003e \u003c/div\u003e A catchy slogan is displayed, setting a creative and visionary tone. 1 \u003cdiv class=\"slogan\"\u003eCrafting Tomorrow's Narratives, Today.\u003c/div\u003e Login Interface: The entry point of any web service, the login page, is where security meets user experience. Our Flask-based web application presents a clean and intuitive login interface. It includes fields for username and password and a login button. This simplicity ensures ease of use while maintaining a professional appearance.\n1 2 3 4 5 \u003cform action=\"/login\" method=\"post\"\u003e \u003cinput type=\"email\" placeholder=\"Username\" name=\"username\" required\u003e \u003cinput type=\"password\" placeholder=\"Password\" name=\"password\" required\u003e \u003cbutton type=\"submit\"\u003eLogin\u003c/button\u003e \u003c/form\u003e Additional subtitle for contextual information. 1 \u003cp class=\"subtitle\"\u003eIf you want to reach this server, please contact Aiken or Metis.\u003c/p\u003e Interactive Error Handling:\nA unique error message display using a cat image, adding a touch of humor. 1 2 3 4 5 6 {% if error %} \u003cdiv class=\"error-cat\"\u003e \u003cimg src=\"{{ url_for('static', filename='images/cat.webp') }}\" alt=\"Cat\"\u003e \u003cdiv class=\"speech-bubble\"\u003e{{ error }}\u003c/div\u003e \u003c/div\u003e {% endif %} Footer with Visitor Count:\nDisplaying the visitor count adds an interactive and transparent element. 1 2 3 \u003cfooter\u003e This page has been visited {{ count }} times. \u003c/footer\u003e Comparing Authentication Methods: JWT, OAuth, and Basic Authentication In the realm of web security, selecting the right authentication method is crucial. Let’s compare JWT (JSON Web Tokens), OAuth, and Basic Authentication to understand their unique features and use cases:\nJWT (JSON Web Tokens):\nMechanism: Encoded tokens that carry claims and are used for secure data exchange. Use Cases: Ideal for single sign-on (SSO) and stateless applications. Pros: Highly flexible, supports cross-domain requests, and is self-contained with payload data. Cons: Requires careful management of secret keys and token expiration. OAuth:\nMechanism: An authorization framework allowing applications to secure designated access without revealing user credentials. Use Cases: Best for third-party access (like social logins) and granting limited access to user data. Pros: Enhanced security as user credentials are not exposed, and allows token-based access control. Cons: Complex implementation and requires understanding of tokens and scopes. Basic Authentication:\nMechanism: A simple authentication scheme built into the HTTP protocol using username and password. Use Cases: Suitable for simple login needs, especially when accessing APIs for internal use. Pros: Easy to implement and understand. Cons: Less secure as it sends credentials in base64 encoded format, vulnerable to interception. Each of these methods has its strengths and weaknesses, and the choice largely depends on the specific requirements of your web application.\nConclusion: Balancing Security and User Experience in Web Services As we conclude this journey through securing and personalizing web services, it’s clear that the right blend of backend security and frontend design can significantly enhance both the security and user experience of a web application.\nFrom implementing robust JWT authentication in a Flask application to designing an engaging and intuitive frontend, each aspect plays a pivotal role in delivering a seamless and secure user experience. Whether it’s the compact and scalable nature of JWTs, the interactive and user-friendly design elements on the frontend, or the comparative analysis of different authentication methods, each component contributes to a comprehensive web service solution.\nFor small projects, especially, the choice of JWT stands out for its efficiency, scalability, and ease of implementation, making it a wise choice for developers looking to secure their applications without compromising on performance or user experience.\nIn the end, the key takeaway is that security and usability do not have to be at odds; with the right tools and approaches, they can complement each other to create web services that are not only secure but also enjoyable to use.\nWe encourage our readers to explore the code and concepts discussed in this blog post and to visit the GitHub repository for the original code at ezEncryptYourService . Dive in, experiment, and elevate your web services to new heights of security and user engagement.\n","wordCount":"1693","inLanguage":"en","image":"https://hugotest-phi.vercel.app/cover/cover16.jpeg","datePublished":"2024-01-27T15:42:36Z","dateModified":"2024-01-27T15:42:36Z","author":[{"@type":"Person","name":"aikenhong"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://hugotest-phi.vercel.app/posts/stablediffusionwebui%E9%89%B4%E6%9D%83%E8%AE%BE%E8%AE%A1/"},"publisher":{"@type":"Organization","name":"aiken's blog","logo":{"@type":"ImageObject","url":"https://hugotest-phi.vercel.app/favicon/ghost.ico"}}}</script></head><body id=top><script type=module src=https://cdn.jsdmirror.com/npm/ionicons@7.1.0/dist/ionicons/ionicons.esm.js defer></script><script nomodule src=https://cdn.jsdmirror.com/npm/ionicons@7.1.0/dist/ionicons/ionicons.js defer></script><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://hugotest-phi.vercel.app/ accesskey=h title="aiken's blog (Alt + H)">aiken's blog</a><div class=logo-switches><button id=theme-toggle-nav accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://hugotest-phi.vercel.app/ title=home><span>home</span></a></li><li><a href=https://hugotest-phi.vercel.app/archives/ title=archives><span>archives</span></a></li><li><a href=https://hugotest-phi.vercel.app/search title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><div class=sidebar><ul><li class=logo style=--bg:#333><a href=#><div class=logo-icon><img src=/logo/logo.png></div><div class=logo-text>Aiken's Blog</div></a></li><div class=menulist><li style=--bg:#f44336><a href=https://hugotest-phi.vercel.app/ title=home><div class=logo-icon><ion-icon name=home-outline></ion-icon></div><div class=logo-text>home</div></a></li><li style=--bg:#b145e9><a href=https://hugotest-phi.vercel.app/posts/ title=posts><div class=logo-icon><ion-icon name=newspaper-outline></ion-icon></div><div class=logo-text>posts</div></a></li><li style=--bg:#0f93c7><a href=https://hugotest-phi.vercel.app/tags/ title=tags><div class=logo-icon><ion-icon name=pricetags-outline></ion-icon></div><div class=logo-text>tags</div></a></li><li style=--bg:#ffa117><a href=https://hugotest-phi.vercel.app/categories/ title=categories><div class=logo-icon><ion-icon name=grid-outline></ion-icon></div><div class=logo-text>categories</div></a></li><li style=--bg:#0fc70f><a href=https://hugotest-phi.vercel.app/archives/ title=archives><div class=logo-icon><ion-icon name=folder-outline></ion-icon></div><div class=logo-text>archives</div></a></li><li style=--bg:#d16111><a href=https://hugotest-phi.vercel.app/about/ title=about><div class=logo-icon><ion-icon name=person></ion-icon></div><div class=logo-text>about</div></a></li><li style=--bg:#15c095><a href=https://hugotest-phi.vercel.app/search title="search (Alt + /)" accesskey=/><div class=logo-icon><ion-icon name=search></ion-icon></div><div class=logo-text>search</div></a></li></div><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt +T)"><li><div class=logo-icon id=moon><ion-icon name=moon-outline></ion-icon></div><div class=logo-icon id=sun><ion-icon name=sunny-outline></ion-icon></div></li></button></div></ul></div><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://hugotest-phi.vercel.app/>Home</a>&nbsp;»&nbsp;<a href=https://hugotest-phi.vercel.app/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">StableDiffusionWebUI鉴权设计</h1><div class=post-meta><span title='2024-01-27 15:42:36 +0000 UTC'>January 27, 2024</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;1693 words&nbsp;·&nbsp;aikenhong&nbsp;·&nbsp;<a href=/tags/ai> AI</a>&nbsp;·&nbsp;<a href=/tags/aigc> AIGC</a>&nbsp;·&nbsp;<a href=/tags/web> Web</a>&nbsp;·&nbsp;<a href=/tags/flask> Flask</a>&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/StableDiffusionWebUI%e9%89%b4%e6%9d%83%e8%ae%be%e8%ae%a1.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=eager src=https://hugotest-phi.vercel.app/cover/cover16.jpeg alt></figure><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#introduction aria-label=Introduction>Introduction</a></li><li><a href=#setting-up-nginx-for-secure-authentication aria-label="Setting Up Nginx for Secure Authentication">Setting Up Nginx for Secure Authentication</a></li><li><a href=#implementing-jwt-for-robust-backend-authentication aria-label="Implementing JWT for Robust Backend Authentication">Implementing JWT for Robust Backend Authentication</a></li><li><a href=#designing-a-user-friendly-frontend aria-label="Designing a User-Friendly Frontend">Designing a User-Friendly Frontend</a></li><li><a href=#comparing-authentication-methods-jwt-oauth-and-basic-authentication aria-label="Comparing Authentication Methods: JWT, OAuth, and Basic Authentication">Comparing Authentication Methods: JWT, OAuth, and Basic Authentication</a></li><li><a href=#conclusion-balancing-security-and-user-experience-in-web-services aria-label="Conclusion: Balancing Security and User Experience in Web Services">Conclusion: Balancing Security and User Experience in Web Services</a></li></ul></div></details></div></aside><script>let activeElement,elements;document.addEventListener("DOMContentLoaded",function(){if(checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),elements.length>0){activeElement=elements[0];const e=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${e}"]`).classList.add("active")}const t=document.getElementById("top-link");t&&t.addEventListener("click",e=>{e.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})})},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{const e=window.pageYOffset||document.documentElement.scrollTop;if(e===0)return;elements&&elements.length>0&&(elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase(),n=document.querySelector(`.inner ul li a[href="#${t}"]`);n.classList.remove("read")}),activeElement=Array.from(elements).find(t=>{if(getOffsetTop(t)-e>0&&getOffsetTop(t)-e<window.innerHeight/2)return t})||activeElement,elements.forEach((t)=>{const o=encodeURI(t.getAttribute("id")).toLowerCase(),s=document.querySelector(`.inner ul li a[href="#${o}"]`);if(t===activeElement){s.classList.add("active");const e=document.querySelector(".toc .inner"),t=s.offsetTop,n=e.clientHeight,o=s.clientHeight,i=t-n/2+o/2;e.scrollTo({top:i,behavior:"smooth"})}else getOffsetTop(t)<e&&s.classList.add("read"),s.classList.remove("active")}))},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return!document.querySelector(".hugo-encryptor-prompt")&&elements.length!=0&&(elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),console.log("Elements re-queried:",elements)),0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>[> [!summary]+</p><blockquote><p>this article purpose is to build an authority page for stable diffusion webui using nginx & python/js. Which can publish my personal stable diffusion server. Wrote by GPT(try).</p></blockquote><p><div class=post-img-view><a data-fancybox=gallery href=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20240127161828.png><img alt=image.png loading=lazy src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20240127161828.png class=responsive-image src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20240127161828.png style="display:block;margin:0 auto" alt=image.png></a></div><script>document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".responsive-image"),t=window.innerHeight/2.5;e.forEach(function(e){e.style.maxHeight=t+"px"})})</script></p><h3 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h3><p>In the digital age, the security and user-friendliness of web services are not just conveniences; they are necessities. Balancing robust security protocols with an engaging user experience is key to maintaining both the integrity and popularity of any online service. This blog post dives into the intricacies of securing web services using Nginx for authentication, coupled with designing an appealing frontend. Our journey begins with a practical scenario:</p><p><strong>publishing a stable diffusion webUI service, accessible only to an authenticated audience.</strong></p><h3 id=setting-up-nginx-for-secure-authentication>Setting Up Nginx for Secure Authentication<a hidden class=anchor aria-hidden=true href=#setting-up-nginx-for-secure-authentication>#</a></h3><p>Nginx excels in serving web pages and as a reverse proxy, providing enhanced security through authentication mechanisms. Let’s explore a typical Nginx configuration for secure authentication:</p><ul><li><strong>/verify_token</strong>: This block forwards authentication requests to a dedicated server. By excluding the request body and focusing on essential headers, it ensures that only valid, authenticated requests proceed.</li></ul><pre tabindex=0><code class=language-conf data-lang=conf>location = /verify_token {
    proxy_pass http://{your_auth_server}:2424;
    proxy_pass_request_body off;
    proxy_set_header Content-Length &#34;&#34;;
    proxy_set_header X-Original-URI $request_uri;
    proxy_set_header X-Original-Remote-Addr $remote_addr;
    proxy_set_header X-Original-Host $host;
}
</code></pre><ul><li><strong>/login</strong>: Catering to login requests, this configuration forwards the necessary details to the authentication server, preserving crucial information about the request&rsquo;s origin.</li></ul><pre tabindex=0><code class=language-conf data-lang=conf>location /login {
    proxy_pass http://{your_auth_server}:2424;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}
</code></pre><ul><li><strong>Error Handling (@error401)</strong>: A clever redirect mechanism that guides unauthenticated users to the login page, keeping the original URL intact.</li></ul><pre tabindex=0><code class=language-conf data-lang=conf>location @error401 {
    return 302 {your_domain}/login;
}
</code></pre><ul><li><strong>Root Location (/)</strong>: The gateway to your service, which rigorously checks each request for authentication, granting access only to verified users.</li></ul><pre tabindex=0><code class=language-conf data-lang=conf>location / {
    auth_request /verify_token;
    error_page 401 = @error401;
    proxy_pass http://{your_server}:2323/;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection &#39;upgrade&#39;;
    proxy_set_header Host $host;
    proxy_cache_bypass $http_upgrade;
}
</code></pre><p>This setup not only fortifies your service against unauthorized access but also maintains a seamless user experience, redirecting unauthenticated users without hassle.</p><h3 id=implementing-jwt-for-robust-backend-authentication>Implementing JWT for Robust Backend Authentication<a hidden class=anchor aria-hidden=true href=#implementing-jwt-for-robust-backend-authentication>#</a></h3><p>Implementing JWT (JSON Web Tokens) in a Flask web application provides a secure way of handling authentication. The provided Flask code demonstrates how JWT can be integrated for a robust backend authentication system:</p><ol><li><strong>Setup and Environment Variables</strong>:<ul><li>The Flask app is configured with a secret key, essential for JWT encoding and decoding.</li></ul></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dotenv</span> <span class=kn>import</span> <span class=n>load_dotenv</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>load_dotenv</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>secret_key</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s1>&#39;SECRET_KEY&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ol><li><strong>Login Route</strong>:<ul><li>The <code>/login</code> route handles user authentication. Upon successful login, a JWT is encoded with the user&rsquo;s information and expiration time, then sent as a cookie.</li></ul></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>,</span> <span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>count</span> <span class=o>=</span> <span class=n>update_visit_count</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>username</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Validate credentials (use a secure method in production)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>username</span> <span class=o>==</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s1>&#39;chat_username&#39;</span><span class=p>)</span> <span class=ow>and</span> <span class=n>password</span> <span class=o>==</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>token</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>encode</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;user&#39;</span><span class=p>:</span> <span class=n>username</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;exp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span> <span class=o>+</span> <span class=n>datetime</span><span class=o>.</span><span class=n>timedelta</span><span class=p>(</span><span class=n>minutes</span><span class=o>=</span><span class=mi>30</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span> <span class=n>app</span><span class=o>.</span><span class=n>secret_key</span><span class=p>,</span> <span class=n>algorithm</span><span class=o>=</span><span class=s1>&#39;HS256&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>response</span> <span class=o>=</span> <span class=n>make_response</span><span class=p>(</span><span class=n>redirect</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>response</span><span class=o>.</span><span class=n>set_cookie</span><span class=p>(</span><span class=s1>&#39;token&#39;</span><span class=p>,</span> <span class=n>token</span><span class=p>,</span> <span class=n>max_age</span><span class=o>=</span><span class=mi>1800</span><span class=p>)</span>  <span class=c1># Keep login status for 30 mins</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>response</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>error</span> <span class=o>=</span> <span class=s1>&#39;Invalid credentials&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;login.html&#39;</span><span class=p>,</span> <span class=n>error</span><span class=o>=</span><span class=n>error</span><span class=p>,</span> <span class=n>count</span><span class=o>=</span><span class=n>count</span><span class=p>),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Show login page</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;login.html&#39;</span><span class=p>,</span><span class=n>count</span><span class=o>=</span><span class=n>count</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ol><li><strong>Token Verification</strong>:<ul><li>A decorator <code>token_required</code> is used to verify the JWT token in subsequent requests. This ensures that only authenticated users can access certain routes.</li></ul></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>token_required</span><span class=p>(</span><span class=n>f</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>decorator</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>token</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>cookies</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;token&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>token</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;token is none&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>jwt</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=n>app</span><span class=o>.</span><span class=n>secret_key</span><span class=p>,</span> <span class=n>algorithms</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;HS256&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;token is invalid&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>decorator</span><span class=o>.</span><span class=vm>__name__</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=vm>__name__</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>decorator</span>
</span></span></code></pre></td></tr></table></div></div><ol><li><strong>Token Validation Endpoint</strong>:<ul><li>The <code>/verify_token</code> endpoint checks the validity of the token, which is essential for integrating with the Nginx authentication mechanism.</li></ul></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/verify_token&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>verify_token</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>token</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>cookies</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;token&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>token</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;Access Denied&#39;</span><span class=p>,</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>jwt</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=n>app</span><span class=o>.</span><span class=n>secret_key</span><span class=p>,</span> <span class=n>algorithms</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;HS256&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;Authorized&#39;</span><span class=p>,</span> <span class=mi>200</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;Access Denied&#39;</span><span class=p>,</span> <span class=mi>401</span>
</span></span></code></pre></td></tr></table></div></div><ol><li><strong>Dynamic Secret Key Update</strong>:<ul><li>A function <code>update_secret_key_in_env</code> is included to update the secret key daily, enhancing security by invalidating old tokens.</li></ul></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Function to generate a new secret key and write it to the .env file</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>update_secret_key_in_env</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>env_file_path</span> <span class=o>=</span> <span class=s1>&#39;.env&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>secret_key</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;SECRET_KEY=</span><span class=si>{</span><span class=n>secrets</span><span class=o>.</span><span class=n>token_urlsafe</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>last_updated</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;LAST_UPDATED=</span><span class=si>{</span><span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s2>&#34;%Y-%m-</span><span class=si>%d</span><span class=s2>&#34;</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>key_updated</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Check if .env file exists and read the content</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>env_file_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>env_file_path</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>lines</span> <span class=o>=</span> <span class=n>file</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Update or add SECRET_KEY and LAST_UPDATED</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>line</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>lines</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=s1>&#39;LAST_UPDATED&#39;</span> <span class=ow>in</span> <span class=n>line</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>last_updated_date</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;=&#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>last_updated_date</span> <span class=o>!=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s2>&#34;%Y-%m-</span><span class=si>%d</span><span class=s2>&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=n>lines</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>last_updated</span> <span class=o>+</span> <span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>                    <span class=n>key_updated</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=s1>&#39;SECRET_KEY&#39;</span> <span class=ow>in</span> <span class=n>line</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>key_updated</span> <span class=ow>is</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>lines</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>secret_key</span> <span class=o>+</span> <span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;no need to update the secret key today&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>key_updated</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># If SECRET_KEY or LAST_UPDATED are not found, add them</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>key_updated</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>lines</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>last_updated</span> <span class=o>+</span> <span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>lines</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>secret_key</span> <span class=o>+</span> <span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>key_updated</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Write back to .env file</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>env_file_path</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>file</span><span class=o>.</span><span class=n>writelines</span><span class=p>(</span><span class=n>lines</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span> <span class=c1># If .env file doesn&#39;t exist, create one</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>env_file_path</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>file</span><span class=o>.</span><span class=n>writelines</span><span class=p>([</span><span class=n>last_updated</span> <span class=o>+</span> <span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>secret_key</span> <span class=o>+</span> <span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>key_updated</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>key_updated</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Secret key and last updated date added/updated in .env file.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;No update required for today.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ol><li><strong>Visitor Count Feature</strong>:<ul><li>As part of the user experience, a visitor count is maintained, which is updated with each visit.</li></ul></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>update_visit_count</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;visit_count.txt&#34;</span><span class=p>,</span> <span class=s2>&#34;r&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>count</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>file</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;visit_count.txt&#34;</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>count</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>count</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>IOError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;Error&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>This implementation of JWT in a Flask application exemplifies a secure and efficient way of handling user authentication, ensuring that only authorized users can access protected services.</p><p><div class=post-img-view><a data-fancybox=gallery href=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20240127161720.png><img alt=image.png loading=lazy src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20240127161720.png class=responsive-image src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20240127161720.png style="display:block;margin:0 auto" alt=image.png></a></div><script>document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".responsive-image"),t=window.innerHeight/2.5;e.forEach(function(e){e.style.maxHeight=t+"px"})})</script></p><h3 id=designing-a-user-friendly-frontend>Designing a User-Friendly Frontend<a hidden class=anchor aria-hidden=true href=#designing-a-user-friendly-frontend>#</a></h3><p>In tandem with robust backend security, the frontend of your web service plays a crucial role in user engagement and satisfaction. Let&rsquo;s delve into the key features of our project&rsquo;s frontend design:</p><p><strong>Theme Toggle and Slogan</strong>:</p><ul><li>The theme switcher allows users to choose between dark and light modes.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;theme-switch-wrapper&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>button</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;theme-toggle&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;theme-toggle&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;moon&#34;</span><span class=p>&gt;</span><span class=ni>&amp;#9790;</span><span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;sun&#34;</span><span class=p>&gt;</span><span class=ni>&amp;#9728;</span><span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>A catchy slogan is displayed, setting a creative and visionary tone.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;slogan&#34;</span><span class=p>&gt;</span>Crafting Tomorrow&#39;s Narratives, Today.<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Login Interface</strong>:
The entry point of any web service, the login page, is where security meets user experience. Our Flask-based web application presents a clean and intuitive login interface. It includes fields for username and password and a login button. This simplicity ensures ease of use while maintaining a professional appearance.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>form</span> <span class=na>action</span><span class=o>=</span><span class=s>&#34;/login&#34;</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;post&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;email&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;Username&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;username&#34;</span> <span class=na>required</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;password&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;Password&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;password&#34;</span> <span class=na>required</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>button</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span><span class=p>&gt;</span>Login<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Additional subtitle for contextual information.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;subtitle&#34;</span><span class=p>&gt;</span>If you want to reach this server, please contact Aiken or Metis.<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Interactive Error Handling</strong>:</p><ul><li>A unique error message display using a cat image, adding a touch of humor.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>{% if error %}
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;error-cat&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;{{ url_for(&#39;static&#39;, filename=&#39;images/cat.webp&#39;) }}&#34;</span> <span class=na>alt</span><span class=o>=</span><span class=s>&#34;Cat&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;speech-bubble&#34;</span><span class=p>&gt;</span>{{ error }}<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>{% endif %}
</span></span></code></pre></td></tr></table></div></div><p><strong>Footer with Visitor Count</strong>:</p><ul><li>Displaying the visitor count adds an interactive and transparent element.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>footer</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    This page has been visited {{ count }} times.
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>footer</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><div class=post-img-view><a data-fancybox=gallery href=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20240127161058.png><img alt=image.png loading=lazy src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20240127161058.png class=responsive-image src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20240127161058.png style="display:block;margin:0 auto" alt=image.png></a></div><script>document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".responsive-image"),t=window.innerHeight/2.5;e.forEach(function(e){e.style.maxHeight=t+"px"})})</script></p><h3 id=comparing-authentication-methods-jwt-oauth-and-basic-authentication>Comparing Authentication Methods: JWT, OAuth, and Basic Authentication<a hidden class=anchor aria-hidden=true href=#comparing-authentication-methods-jwt-oauth-and-basic-authentication>#</a></h3><p>In the realm of web security, selecting the right authentication method is crucial. Let&rsquo;s compare JWT (JSON Web Tokens), OAuth, and Basic Authentication to understand their unique features and use cases:</p><ol><li><p><strong>JWT (JSON Web Tokens)</strong>:</p><ul><li><strong>Mechanism</strong>: Encoded tokens that carry claims and are used for secure data exchange.</li><li><strong>Use Cases</strong>: Ideal for single sign-on (SSO) and stateless applications.</li><li><strong>Pros</strong>: Highly flexible, supports cross-domain requests, and is self-contained with payload data.</li><li><strong>Cons</strong>: Requires careful management of secret keys and token expiration.</li></ul></li><li><p><strong>OAuth</strong>:</p><ul><li><strong>Mechanism</strong>: An authorization framework allowing applications to secure designated access without revealing user credentials.</li><li><strong>Use Cases</strong>: Best for third-party access (like social logins) and granting limited access to user data.</li><li><strong>Pros</strong>: Enhanced security as user credentials are not exposed, and allows token-based access control.</li><li><strong>Cons</strong>: Complex implementation and requires understanding of tokens and scopes.</li></ul></li><li><p><strong>Basic Authentication</strong>:</p><ul><li><strong>Mechanism</strong>: A simple authentication scheme built into the HTTP protocol using username and password.</li><li><strong>Use Cases</strong>: Suitable for simple login needs, especially when accessing APIs for internal use.</li><li><strong>Pros</strong>: Easy to implement and understand.</li><li><strong>Cons</strong>: Less secure as it sends credentials in base64 encoded format, vulnerable to interception.</li></ul></li></ol><p>Each of these methods has its strengths and weaknesses, and the choice largely depends on the specific requirements of your web application.</p><h3 id=conclusion-balancing-security-and-user-experience-in-web-services>Conclusion: Balancing Security and User Experience in Web Services<a hidden class=anchor aria-hidden=true href=#conclusion-balancing-security-and-user-experience-in-web-services>#</a></h3><p>As we conclude this journey through securing and personalizing web services, it&rsquo;s clear that the right blend of backend security and frontend design can significantly enhance both the security and user experience of a web application.</p><p>From implementing robust JWT authentication in a Flask application to designing an engaging and intuitive frontend, each aspect plays a pivotal role in delivering a seamless and secure user experience. Whether it&rsquo;s the compact and scalable nature of JWTs, the interactive and user-friendly design elements on the frontend, or the comparative analysis of different authentication methods, each component contributes to a comprehensive web service solution.</p><p>For small projects, especially, the choice of JWT stands out for its efficiency, scalability, and ease of implementation, making it a wise choice for developers looking to secure their applications without compromising on performance or user experience.</p><p>In the end, the key takeaway is that security and usability do not have to be at odds; with the right tools and approaches, they can complement each other to create web services that are not only secure but also enjoyable to use.</p><p>We encourage our readers to explore the code and concepts discussed in this blog post and to visit the GitHub repository for the original code at <a href="https://github.com/AikenH/ezEncryptYourService?tab=readme-ov-file" target=_blank rel=noopener>ezEncryptYourService</a>
. Dive in, experiment, and elevate your web services to new heights of security and user engagement.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://hugotest-phi.vercel.app/tags/ai/>AI</a></li><li><a href=https://hugotest-phi.vercel.app/tags/aigc/>AIGC</a></li><li><a href=https://hugotest-phi.vercel.app/tags/web/>Web</a></li><li><a href=https://hugotest-phi.vercel.app/tags/flask/>Flask</a></li></ul><nav class=paginav><a class=prev href=https://hugotest-phi.vercel.app/posts/pwsh_bgtask/><span class=title>« Prev</span><br><span>Windows Powershell 01 后台任务</span>
</a><a class=next href=https://hugotest-phi.vercel.app/posts/backuptoolsforhomeserver/><span class=title>Next »</span><br><span>家庭服务器的备份工具选择</span></a></nav></footer><div id=disqus_thread></div><script>function loadDisqus(){var e=document,t=e.createElement("script");t.src="https://aiken-hugo.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t),window.disqus_config=function(){this.page.url=window.location.href,this.page.identifier=window.location.href.substring(18)}}var runningOnBrowser=typeof window!="undefined",isBot=runningOnBrowser&&!("onscroll"in window)||typeof navigator!="undefined"&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent),supportsIntersectionObserver=runningOnBrowser&&"IntersectionObserver"in window;setTimeout(function(){if(!isBot&&supportsIntersectionObserver){var e=new IntersectionObserver(function(t){t[0].isIntersecting&&(loadDisqus(),e.disconnect())},{threshold:[0]});e.observe(document.getElementById("disqus_thread"))}else loadDisqus()},1)</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by
Disqus.</a></noscript></article></main><footer class=footer><span>&copy; 2024 <a href=https://hugotest-phi.vercel.app/>aiken's blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a>
</span><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><span id=busuanzi_container>Visitors: <span id=busuanzi_value_site_uv></span>
Views: <span id=busuanzi_value_site_pv></span></span></footer><script>document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("busuanzi_value_site_uv"),t=document.getElementById("busuanzi_value_site_pv"),o=13863,i=16993;if(!e||!t){console.error("Busuanzi elements not found.");return}const n=new MutationObserver(e=>{for(let t of e)if(t.type==="childList"){n.disconnect(),t.target.innerHTML=parseInt(t.target.innerHTML||0)+o;break}}),s=new MutationObserver(e=>{for(let t of e)if(t.type==="childList"){s.disconnect(),t.target.innerHTML=parseInt(t.target.innerHTML||0)+i;break}});n.observe(e,{childList:!0}),s.observe(t,{childList:!0})})</script><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><span class=topInner><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
<span id=read_progress></span>
</span></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))}),document.getElementById("theme-toggle-nav").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script>document.addEventListener("scroll",function(){const t=document.getElementById("read_progress"),n=document.documentElement.scrollHeight,s=document.documentElement.clientHeight,o=document.documentElement.scrollTop||document.body.scrollTop;t.innerText=((o/(n-s)).toFixed(2)*100).toFixed(0)})</script><script>(function(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(e)}),i.parentNode.insertBefore(n,i)})("/js/pangu.js",function(){pangu.spacingPage()})</script></body></html>