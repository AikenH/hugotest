<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>基于Vue和Django的前后端开发实践 | aiken's blog</title>
<meta name=keywords content="Vue,Django,Mysql"><meta name=description content="
    
    







  
    
      文章的部分内容被密码保护：
    
  
  
    
    
  
  
    --- DON'T MODIFY THIS LINE ---
    @Aikenhong 2022 介绍基于Tdesign和Django的界面安装和前后端联调，ubuntu version，
该文章首先介绍如何配置环境，后续基于现有项目来介绍如何从零来构建基本的网页和后端服务。

基本信息
（已完成）下载编写好的网页压缩包：web-design，里面包含了vue和django模块。
路径两种方式打开：

（命令行） cd ~/workspace/web_design_group10/
（资源管理器）主目录下的workspace/web_design_group10

编辑代码方式：

使用vscode打开该文件夹进行编辑

启动服务
（以下的操作都分别基于web_design_group10路径）完整的网页启动需要分别启动前后端的服务，并均保持开启状态，所以需要使用两个终端窗口来分别启动。

前端服务：在view-design路径下使用命令:npm run dev，可参考VUE启动
后端服务：在vuebackend页面使用命令：



1


python manager.py runserver


（python版本需要是3以上）

数据库服务：数据库安装后好像是默认启动的，如果发现有数据库的错误，按照ubuntu 启动mysql执行。

在启动服务之前，有一些环境需要配置，接下来我们将描述初始的环境准备。
环境配置（Ubuntu）
配置主要有几个部分组成：配置前端环境（vue、node）、配置数据库（mysql）、配置后端（python包），我们首先描述前端环境的配置。
**特定项目迁移：**只需要安装node和NPM，然后再对应目录npm i即可
**初始化一个项目：**安装完node、npm之后，安装vue和tdesign，参考对应的官方文档即可，（npm install）
前端环境配置
前端项目基于NodeJS，所以我们需要首先安装Node和NPM，在Ubuntu中安装Node的命令如下：


1
2
3
4
5
6
7
8


# 首先更新NOdejs的软件源，基于基于需要的版本修改其中的版本号 14/16

# 接着使用apt命令下载nodejs 和 npm
sudo apt-get install npm, nodejs

# 查看版本验证安装是否成功
node -V
npm -V


接着对特定前端（NodeJS）项目安装依赖"><meta name=author content="aikenhong"><link rel=canonical href=https://hugotest-phi.vercel.app/posts/custom_web/><link crossorigin=anonymous href=/assets/css/stylesheet.2f85ca17c12c62fa86b1e474b8a51aca4856f0d645debfe4922a4d5ddc6aa978.css integrity="sha256-L4XKF8EsYvqGseR0uKUaykhW8NZF3r/kkipNXdxqqXg=" rel="preload stylesheet" as=style><link rel=icon href=https://hugotest-phi.vercel.app/favicon/ghost.ico><link rel=icon type=image/png sizes=16x16 href=https://hugotest-phi.vercel.app/favicon/ghost-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://hugotest-phi.vercel.app/favicon/ghost-32x32.png><link rel=apple-touch-icon href=https://hugotest-phi.vercel.app/favicon/ghost-apple-touch-icon.png><link rel=mask-icon href=https://hugotest-phi.vercel.app/favicon/ghost-192x192.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://hugotest-phi.vercel.app/posts/custom_web/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script src=https://cdn.jsdmirror.com/npm/jquery@3.5.1/dist/jquery.min.js></script><link rel=stylesheet href=https://cdn.jsdmirror.com/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css><script src=https://cdn.jsdmirror.com/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js></script><link rel=stylesheet href=https://cdn.jsdmirror.com/npm/katex@0.16.11/dist/katex.min.css><script defer src=https://cdn.jsdmirror.com/npm/katex@0.16.11/dist/katex.min.js></script><script defer src=https://cdn.jsdmirror.com/npm/katex@0.16.11/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><link rel=stylesheet href=https://cdn.jsdmirror.com/npm/lxgw-wenkai-webfont@1.1.0/style.css><link rel=stylesheet href=https://cdn.jsdmirror.com/npm/lxgw-wenkai-lite-webfont@1.1.0/style.css><link rel=stylesheet href=https://cdn.jsdmirror.com/npm/lxgw-wenkai-tc-webfont@1.0.0/style.css><link rel=stylesheet href=https://cdn.jsdmirror.com/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap" rel=stylesheet><meta property="og:url" content="https://hugotest-phi.vercel.app/posts/custom_web/"><meta property="og:site_name" content="aiken's blog"><meta property="og:title" content="基于Vue和Django的前后端开发实践"><meta property="og:description" content="文章的部分内容被密码保护：
--- DON'T MODIFY THIS LINE ---@Aikenhong 2022 介绍基于Tdesign和Django的界面安装和前后端联调，ubuntu version，
该文章首先介绍如何配置环境，后续基于现有项目来介绍如何从零来构建基本的网页和后端服务。
基本信息 （已完成）下载编写好的网页压缩包：web-design，里面包含了vue和django模块。
路径两种方式打开：
（命令行） cd ~/workspace/web_design_group10/ （资源管理器）主目录下的workspace/web_design_group10 编辑代码方式：
使用vscode打开该文件夹进行编辑 启动服务 （以下的操作都分别基于web_design_group10路径）完整的网页启动需要分别启动前后端的服务，并均保持开启状态，所以需要使用两个终端窗口来分别启动。
前端服务：在view-design路径下使用命令:npm run dev，可参考VUE启动 后端服务：在vuebackend页面使用命令： 1 python manager.py runserver （python版本需要是3以上）
数据库服务：数据库安装后好像是默认启动的，如果发现有数据库的错误，按照ubuntu 启动mysql执行。 在启动服务之前，有一些环境需要配置，接下来我们将描述初始的环境准备。
环境配置（Ubuntu） 配置主要有几个部分组成：配置前端环境（vue、node）、配置数据库（mysql）、配置后端（python包），我们首先描述前端环境的配置。
**特定项目迁移：**只需要安装node和NPM，然后再对应目录npm i即可
**初始化一个项目：**安装完node、npm之后，安装vue和tdesign，参考对应的官方文档即可，（npm install）
前端环境配置 前端项目基于NodeJS，所以我们需要首先安装Node和NPM，在Ubuntu中安装Node的命令如下：
1 2 3 4 5 6 7 8 # 首先更新NOdejs的软件源，基于基于需要的版本修改其中的版本号 14/16 # 接着使用apt命令下载nodejs 和 npm sudo apt-get install npm, nodejs # 查看版本验证安装是否成功 node -V npm -V 接着对特定前端（NodeJS）项目安装依赖"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-02T18:00:00+00:00"><meta property="article:modified_time" content="2022-10-02T18:00:00+00:00"><meta property="article:tag" content="Vue"><meta property="article:tag" content="Django"><meta property="article:tag" content="Mysql"><meta property="og:image" content="https://hugotest-phi.vercel.app/cover/cover13.jpeg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://hugotest-phi.vercel.app/cover/cover13.jpeg"><meta name=twitter:title content="基于Vue和Django的前后端开发实践"><meta name=twitter:description content="
    
    







  
    
      文章的部分内容被密码保护：
    
  
  
    
    
  
  
    --- DON'T MODIFY THIS LINE ---
    @Aikenhong 2022 介绍基于Tdesign和Django的界面安装和前后端联调，ubuntu version，
该文章首先介绍如何配置环境，后续基于现有项目来介绍如何从零来构建基本的网页和后端服务。

基本信息
（已完成）下载编写好的网页压缩包：web-design，里面包含了vue和django模块。
路径两种方式打开：

（命令行） cd ~/workspace/web_design_group10/
（资源管理器）主目录下的workspace/web_design_group10

编辑代码方式：

使用vscode打开该文件夹进行编辑

启动服务
（以下的操作都分别基于web_design_group10路径）完整的网页启动需要分别启动前后端的服务，并均保持开启状态，所以需要使用两个终端窗口来分别启动。

前端服务：在view-design路径下使用命令:npm run dev，可参考VUE启动
后端服务：在vuebackend页面使用命令：



1


python manager.py runserver


（python版本需要是3以上）

数据库服务：数据库安装后好像是默认启动的，如果发现有数据库的错误，按照ubuntu 启动mysql执行。

在启动服务之前，有一些环境需要配置，接下来我们将描述初始的环境准备。
环境配置（Ubuntu）
配置主要有几个部分组成：配置前端环境（vue、node）、配置数据库（mysql）、配置后端（python包），我们首先描述前端环境的配置。
**特定项目迁移：**只需要安装node和NPM，然后再对应目录npm i即可
**初始化一个项目：**安装完node、npm之后，安装vue和tdesign，参考对应的官方文档即可，（npm install）
前端环境配置
前端项目基于NodeJS，所以我们需要首先安装Node和NPM，在Ubuntu中安装Node的命令如下：


1
2
3
4
5
6
7
8


# 首先更新NOdejs的软件源，基于基于需要的版本修改其中的版本号 14/16

# 接着使用apt命令下载nodejs 和 npm
sudo apt-get install npm, nodejs

# 查看版本验证安装是否成功
node -V
npm -V


接着对特定前端（NodeJS）项目安装依赖"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://hugotest-phi.vercel.app/posts/"},{"@type":"ListItem","position":2,"name":"基于Vue和Django的前后端开发实践","item":"https://hugotest-phi.vercel.app/posts/custom_web/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"基于Vue和Django的前后端开发实践","name":"基于Vue和Django的前后端开发实践","description":"\r文章的部分内容被密码保护：\n--- DON'T MODIFY THIS LINE ---\r@Aikenhong 2022 介绍基于Tdesign和Django的界面安装和前后端联调，ubuntu version，\n该文章首先介绍如何配置环境，后续基于现有项目来介绍如何从零来构建基本的网页和后端服务。\n基本信息 （已完成）下载编写好的网页压缩包：web-design，里面包含了vue和django模块。\n路径两种方式打开：\n（命令行） cd ~/workspace/web_design_group10/ （资源管理器）主目录下的workspace/web_design_group10 编辑代码方式：\n使用vscode打开该文件夹进行编辑 启动服务 （以下的操作都分别基于web_design_group10路径）完整的网页启动需要分别启动前后端的服务，并均保持开启状态，所以需要使用两个终端窗口来分别启动。\n前端服务：在view-design路径下使用命令:npm run dev，可参考VUE启动 后端服务：在vuebackend页面使用命令： 1 python manager.py runserver （python版本需要是3以上）\n数据库服务：数据库安装后好像是默认启动的，如果发现有数据库的错误，按照ubuntu 启动mysql执行。 在启动服务之前，有一些环境需要配置，接下来我们将描述初始的环境准备。\n环境配置（Ubuntu） 配置主要有几个部分组成：配置前端环境（vue、node）、配置数据库（mysql）、配置后端（python包），我们首先描述前端环境的配置。\n**特定项目迁移：**只需要安装node和NPM，然后再对应目录npm i即可\n**初始化一个项目：**安装完node、npm之后，安装vue和tdesign，参考对应的官方文档即可，（npm install）\n前端环境配置 前端项目基于NodeJS，所以我们需要首先安装Node和NPM，在Ubuntu中安装Node的命令如下：\n1 2 3 4 5 6 7 8 # 首先更新NOdejs的软件源，基于基于需要的版本修改其中的版本号 14/16 # 接着使用apt命令下载nodejs 和 npm sudo apt-get install npm, nodejs # 查看版本验证安装是否成功 node -V npm -V 接着对特定前端（NodeJS）项目安装依赖\n","keywords":["Vue","Django","Mysql"],"articleBody":"\r文章的部分内容被密码保护：\n--- DON'T MODIFY THIS LINE ---\r@Aikenhong 2022 介绍基于Tdesign和Django的界面安装和前后端联调，ubuntu version，\n该文章首先介绍如何配置环境，后续基于现有项目来介绍如何从零来构建基本的网页和后端服务。\n基本信息 （已完成）下载编写好的网页压缩包：web-design，里面包含了vue和django模块。\n路径两种方式打开：\n（命令行） cd ~/workspace/web_design_group10/ （资源管理器）主目录下的workspace/web_design_group10 编辑代码方式：\n使用vscode打开该文件夹进行编辑 启动服务 （以下的操作都分别基于web_design_group10路径）完整的网页启动需要分别启动前后端的服务，并均保持开启状态，所以需要使用两个终端窗口来分别启动。\n前端服务：在view-design路径下使用命令:npm run dev，可参考VUE启动 后端服务：在vuebackend页面使用命令： 1 python manager.py runserver （python版本需要是3以上）\n数据库服务：数据库安装后好像是默认启动的，如果发现有数据库的错误，按照ubuntu 启动mysql执行。 在启动服务之前，有一些环境需要配置，接下来我们将描述初始的环境准备。\n环境配置（Ubuntu） 配置主要有几个部分组成：配置前端环境（vue、node）、配置数据库（mysql）、配置后端（python包），我们首先描述前端环境的配置。\n**特定项目迁移：**只需要安装node和NPM，然后再对应目录npm i即可\n**初始化一个项目：**安装完node、npm之后，安装vue和tdesign，参考对应的官方文档即可，（npm install）\n前端环境配置 前端项目基于NodeJS，所以我们需要首先安装Node和NPM，在Ubuntu中安装Node的命令如下：\n1 2 3 4 5 6 7 8 # 首先更新NOdejs的软件源，基于基于需要的版本修改其中的版本号 14/16 # 接着使用apt命令下载nodejs 和 npm sudo apt-get install npm, nodejs # 查看版本验证安装是否成功 node -V npm -V 接着对特定前端（NodeJS）项目安装依赖\n1 2 3 4 cd /web-design-group10/view-design # 执行如下命令可直接根据项目的进行package的安装 # npm install 可以简写为 npm i npm install 安装完基本依赖后，即可启动前端服务看看页面是否正常运行，默认的访问路径是localhost:3001\n1 2 3 # 启动前端项目在view-design目录下 npm run dev # 启动后可以看到对应的端口和ip（建议首先使用localhost对前后端进行调试） 启动服务后可以边修改页面边预览效果（感觉不对劲就手动重启下，有时候响应会出现问题）\nMySQL环境配置 由于Django（后面我们会讲）将诸多对于数据库，例如MySQL的操作都集成成了Python语句，所以对于MySQL配置的部分，我们只需要做如下的准备：\n安装MySQL -\u003e 初始化MySQL（设置密码）-\u003e为后端创建一个初始的数据库 -\u003e 在DJango中做好对应的设置。\n在Ubuntu上安装mysql：\n1 2 3 # install mysql(in ubuntu) sudo apt-get install mysql-client sudo apt-get install mysql-server 初始化MySQL（设置密码）：\n1 2 # 进入mysql sudo mysql 进入mysql之后，通过设置基本的密码来初始化sql的服务（执行别的命令之前我们需要该密码）\n1 2 3 4 5 6 mysql\u003e alter user 'root'@'localhost' indentify with mysql_native_password by 'passwd@of@my'; # 退出mysql数据库，验证是否正确初始化 mysql\u003e exit; ​\t上述命令中，密码的小引号不能省略\n接着验证密码：\n1 2 3 mysql -u root -p # 输入密码，如果正确的话会进入数据库，到这里已经可以了，我们开始创建后续django使用的数据库 # 通过show databases; 可以查看现在创建好的所有数据库 创建项目所需的数据库（建议和项目文件夹同名，方便记忆）\n1 2 3 4 5 6 7 8 9 10 11 12 # 创建数据库并设定utf8编码，避免编码问题 mysql\u003e create database \u003cproject-name\u003e character set utf8; # 使用show databass查看是否正确创建 mysql\u003e show databases; # 使用use 进入对应的数据库 mysql\u003e use \u003cdatabases-name\u003e; # 使用show tables查看已经创建好的表格 mysql\u003e show tables; 到这里对于数据库的配置就告一段落，后续只需要在Django中设置如下的内容即可：\n使用的数据库架构（mysql or else） 使用的具体数据库，（我们为后端创建的那个） 数据库的访问密码 之后就可以在Django的python代码中执行常见的数据库操作来进行响应的增删改查。\n参考链接：install 、刘江 Django环境配置（with mysql） Django 作为Python的一个库（Lib）安装过程实际上是配置一个python环境，这里主要考虑到结合mysql需要安装一些额外的库和设置，同样，会分成以下的几步：\n安装Django-\u003e安装Django-Mysql需要的库-\u003e建立Django和mysql连接（填写上面提到的密码等）-\u003e初始化项目\n安装Django 1 2 # 如果没有pip的话试试pip3，如果是pip3安装的，最后启动服务的时候要记得用python3来启动 pip install django 安装mysqlclient 1 pip install mysqlclient 创建一个空的Django项目： （cd）移动到一个我们放置项目的空目录（忽略\u003c\u003e），就会创建一个my-project-name的项目：\n1 django-admin startproject 其文件结构如下（具体作用解析：https://docs.djangoproject.com/zh-hans/4.1/intro/tutorial01/）：\n1 2 3 4 5 6 7 8 mysite/ manage.py mysite/ __init__.py settings.py urls.py # 接口的路由管理,也就是我们的接口在哪边访问 asgi.py wsgi.py 创建一个具体的“APP”，又被称作应用，这里的应用和上面创建的项目的区别在于（摘自官网）：\n项目和应用有什么区别？应用是一个专门做某件事的网络应用程序——比如博客系统，或者公共记录的数据库，或者小型的投票程序。项目则是一个网站使用的配置和应用的集合。项目可以包含很多个应用。应用可以被很多个项目使用。\n个人讲项目理解为项目，主要提供Django的基本功能和设置环境；应用则是我们进行具体功能开发的主要地方，比如我们这里创建一个webapi的应用，用来编写特定网站需要的所有接口：\n1 2 # 初始化APP python manager.py startapp webapi Django会创建路径如下：\n1 2 3 4 5 6 7 8 9 webapi/ __init__.py admin.py # 包含django管理界面的设置 apps.py # 包含webapi配置的设置 migrations/ __init__.py models.py # 定义数据库中的表 tests.py views.py # 定义API 创建完APP（应用后），我们需要在项目的设置中安装\n1 vim vuebackend/vuebackend/setting.py 找到INSTALLED_APPS字段，添加创建的APP，最终如下：\n1 2 3 4 5 6 7 8 9 10 INSTALLED_APPS = [ 'django.contrib.admin', 'django.contrib.auth', 'django.contrib.contenttypes', 'django.contrib.sessions', 'django.contrib.messages', 'django.contrib.staticfiles', 'corsheaders', 'webapi', ] 启动项目 1 2 3 4 python manage.py runserver # 如果希望除了localhost都能访问启动的时候可以监听所有的ip # 然后在allow url中填上自己的ip python manager.py runserver 0.0.0.0:8000 安装其他依赖项（启动项目，缺啥就pip install啥，搞定后关掉） 如果不需要数据库的话到这里就已经可以了，如果需要数据库的话，我们继续往下看。\n建立和数据库的连接 1 vim vuebackend/vuebackend/setting.py ​\t修改其中的DATABASES字段如下：\n1 2 3 4 5 6 7 8 9 10 DATABASES = { 'default': { 'ENGINE': 'django.db.backends.mysql', 'NAME': 'vuebackend', 'USER': 'root', 'PASSWORD': '__', 'HOST': '127.0.0.1', 'PORT': '3306', } } ENGINE，如果是mysql的引擎就填这个，别的数据去再去看，\nNAME：mysql中为后端创建的数据库的名称\nUSER：直接使用root用户，\nPASSWORD：我们初始化mysql时设置的密码\nHOST：127.0.0.1 指代本机\nPORT：3306为mysql默认的启动端口\n测试数据库功能 Django中model.py编写的内容，Django会用其自身的形式进行“包装”（封装），转换成对应的数据库操作，然后在数据库中执行对应的命令。（好像被称作ORM）\n而我们主要用到的功能是：创建类，会自动在数据库中生成表格，其中支持的数据类型可以在官网中找到参考 。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 from django.db import models # Create your models here. class Gamerecords(models.Model): \"\"\" the table for saving abs and the create info \"\"\" m_id = models.AutoField(primary_key=True) game_name = models.CharField(max_length = 150) author = models.CharField(max_length = 150) file_type = models.CharField(max_length = 150, default=\"Java\") create_time = models.DateTimeField() # 对应python中的Datetime类型 定义之后，命令行执行命令，将这些字段映射成数据库中的一张表，下述命令执行数据库操作\n1 2 3 python manage.py makemigrations (应用名，选填) python manage.py migrate (应用名，选填) python manager.py runserver 启动服务 执行完后可以去mysql对应的数据库中，使用show tables查看是否新建表成功。\n然后照常启动后端服务。\n参考链接：offical with mysql 、simple start with mysql 配置跨域便于和vue项目链接：需要安装django-cors-headers模块，并在设置setting.py中导入 1 pip install django-cors-headers 然后在项目中添加模块：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # books_demo/settings.py INSTALLED_APPS = [ ... # demo 'corsheaders', ... ] MIDDLEWARE = [ 'corsheaders.middleware.CorsMiddleware', # 需注意与其他中间件顺序，这里放在最前面即可 ... ] # 支持跨域配置开始 CORS_ORIGIN_ALLOW_ALL = True CORS_ALLOW_CREDENTIALS = True 开发指南 开发界面会基于如下的几个部分进行描述：前端开发、后端开发、前后端联通，每一部分的开发会从一个空项目开始，以现有的代码为例，来介绍各个部分的开发和联通。最后给出一个从0开始设计前端模块、后端功能、前后端传输的Task（demo）。其中也会介绍最raw的debug方式。\n一些不错的参考链接：前后端从零开始构建流程demo，包含使用curl测试api 、也是前后端搭建的Demo VUE和Tdesign前端开发 前端部分由于个人能力有限，仅了解到代码结构的大体构筑，和如何修改，因此不做从零开始的参数，仅以自己的认知去介绍如何修改代码，以及各个模块的交互方式介绍。\n参考链接：页面外观配置 、vue中引入html界面 必看！！！核心配置，整体的文件逻辑 具体介绍模块：代码结构、路由结构（如何删除页面的路由，对应的页面在什么地方）、页面的简单设计逻辑、页面之间的跳转\n前端的代码我们基本上只关注src路径下的代码，所有的页面和逻辑基本都在其中：\n整体的架构参考上面的链接，我们主要关注的是以下几个文件夹：\npage: 存放所有的页面 router： 存放路由跳转逻辑，其中index.js中*定义了默认的主页，其他文件中，定义页面的具体url，参考链接 页面的组成 可以参考page中的每个文件夹，核心就是：每个index.vue是一个页面。\n每个页面基本有三个部分组成：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u003ctempalte\u003e 样式布局，也就是基本的外观，按钮，乱七八糟的，去tdesign vue之类的网站上找模版，进行组合即可 \u003c/tempalte\u003e \u003cscript\u003e export default{ data 初始化和设置各种变量 created 里面的函数在页面创建的时候执行 mounted 里面的函数在页面挂载时候执行 method 定义的各种奇奇怪怪的函数，与后端交互的函数， } \u003c/script\u003e \u003cstyle\u003e 定义一些加粗之类的样式，用来对template的的基本组件进行加工 \u003c/style\u003e 其中script中各个部分里面放的函数在不同时候执行：生命周期可以参考https://juejin.cn/post/6874855535234170887，其实就是字面意思，在创建页面之前执行beforecreate啥的（大概意思，具体我也没有太了解）。\nmethod里面就是单纯的函数定义，我们的上传之类的交互代码可以放在这里，然后把函数：\n绑定到按下按钮等事件上或者 绑定到（放到）某些生命周期中，比如创建页面的时候执行一次，或者页面挂载的时候执行一次之类的 页面的跳转（结果页跳转之类） 我实现的**逻辑（Pipeline）**是这样的：\n（前置）跳转到的页面需要再router中注册过 -\u003e 编写一个函数，按下以后跳转到对应的页面，并传递一个id-\u003e跳转到的页面打开的时候读取id，读取数据。\nrouter的注册\n在router那个路径，我不确定是path还是name,还是重定向地址，反正调试的时候试试\n1 2 3 4 5 6 7 8 { \"path\": \"modelbase\", \"name\": \"modelbase\", \"component\": () =\u003e import(\"@/pages/list/modelbase/index.vue\"), \"meta\": { \"title\": \"上传模型\" } }, 页面跳转的函数\nRouter.push就会跳转到对应的页面,name页面名字，query就是传递过去的参数\n参考commandtable.vue，row是列表中的参数，代表列表中的某一项，\n1 2 3 4 handleClickDetail( row ) { const m_id_detail = row['row'].m_id; this.$router.push({ name: 'modelbase', query: { ids: m_id_detail } }); }, 跳转过去的页面加载参数\n根据传递过来的参数生成相应的数据用来展示，或者二次跳转？\n跳转过去的页面，在生成的生命周期中，使用whtch方法，route传递过来的参数以变化我们就执行下面的函数。\n1 2 3 4 5 6 7 8 created() { this.$watch(() =\u003e this.$route.query, (to_params, old_params) =\u003e { console.log(this.$route.query); this.gettaskinfo(); // your function here using the route.query中的参数 console.log(this.$route.query); }); }, 然后生成对应的报告之类的\n参考文献：详情页 关键词：vue详情页 商品页之类\n文件传输前端接口的编写 该部分的编写依托于elementui或者tdesign的upload组件封装\n其基本的编写逻辑如下：\naction中填写我们编写的后端接口url\nformatResponse中填写对后端返回值的格式处理，用以适应组件识别传输事件是否成功\n参考 suceess和fail事件的触发条件，用来编写format tdesign事件是在response中添加url信息和如果失败的话就用error字段传回失败原因 1 return {...res, url: xxx.xxx.xxx.xxx:xxxx, error : \"why you fail\"} 即可在可视化组件上绑定对应的文件上传\n静态HTML页面加载 再编写前端页面的时候，有时候需要处理后端生成的html页面，我们希望能够跳转到指定的html文件的。\n需要将HTML作为静态文件存储到VUE project中静态目录（public）中（防止VUE对HTML文件进行二次编译处理） 假如我们存储的目录为：public/result/index.html我们可以在vue中通过下列函数打开对应页面 函数如下:\n1 2 3 loadLocalHtml(){ windows.open('/result/index.html'); } 如果需要灵活加载详情页面，我们可以根据传入的参数来确定最后存储的地址（或者在后端对文件进行移动）\n前后端的联通 同样也是在mehtod中定义一个访问接口的方法，然后在合适的时候调用这个访问接口的函数就行。放在下面的前后端联动的部分\nDjango后端开发 实现基础功能的话，后端的逻辑和实现相对较为简单，本文介绍：开发api的流程（将自己的功能嵌入）、提供对数据库进行增删改查的例子、提供文件传输api的例子。文件传输好像有更优的解法，后续进行更新\n后端开发Pipeline\n（optional）model.py设计数据表 -\u003e view中设计api（数据获取，数据上传等任何功能）-\u003e注册api到特定的url-\u003e测试api-\u003edone.\n如果有数据库需求才使用，可以简单的存储（用户，时间，存储html路径，语言类型，项目名称等） view中有特定的八股文，下面为会讲到特定的占位部分，填入自己的功能，实现：**根据传来的数据或者GET请求，执行特定的操作，返回特定信息（不返回也行）**的流程即可。 将该域名注册个特定的api，便于访问该api 数据表设计 参考上述的例子（环境配置-Django-6数据库测试），在model.py文件中创建一个类，定义需要的表结构，然后执行两部数据库操作即可：\n下面给出一个Coverage-Test的上传信息类设计Demo：\n1 2 3 4 5 6 7 8 9 10 from django.db import models Class CoverageInfo(models.Model): m_id = models.AutoField(primary_key=True) task_name = models.CharField(max_length = 150, default = \"coverage test\") author = models.CharField(max_length = 150, default = \"anmous\") create_time = models.DateTimeField() lang_type = models.CharField(max_length = 150, default = \"JAVA\") res_path = models.CharField(max_length = 1000, defailt = \"~/workspace/coverage-res/author_default/\") code_path = models.CharField(max_length = 1000, default = '~/workspace/coverage-code/author_default/') 该Table的处理逻辑如下：\ntask_name、author、lang_type交由前端用户填写，传递到后端； m_id为mysql自动递增的数据逻辑我们无需处理，create_time在后端接受请求的时候自动计算 res_path在执行完覆盖率测试后，将文件存储指定定地点，然后将该地点返回，将该地点存进数据库，这样我们就可以随时查询任一个记录的覆盖率结果。 将这些信息存入数据库，便于增删改查，文件和结果则存储本地。\nmysql中生成表\n1 2 python manage.py makemigrations python manage.py migrate API设计 主要从前端接受两种请求：GET、POST，然后基于这两种请求，我们实现对数据增删改查的操作，或者其他的特定操作。API的定义在views.py中完成。基础的范式如下：\n需要注意的是，前后端之间的数据传输，基本都是约定为JSON这种KEY-VALUE格式的，故而我们好像需要进行什么序列化反序列化的操作，来对信息进行解读（理论后续补充）\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 from django.http import JsonResponse from django.views.decorators.http import require_http_methods from django.core import serializers @require_http_methods(['GET']) def get_games_index(request): response = {} try: # using get to get value from front ----\u003e receive = {} reveive['info1'] = request.GET.get('info1') ... # like that ， 应该也可以循环取出 # \u003c----- using get to get value from front # your function here 「----------------- # 基于我们从前端获取到的数据，做任何事情，执行任何函数 # -------------- your function here 」 # 可以给前端返回一些数据 response['res'] = ... 之类的,传过去之前要对数据进行序列话处理 # yourdata需要时{}存kv形式 response['res'] = json.loads(serializers.serialize(\"json\", yourdata)) response['msg'] = 'success' response['error_num'] = 0 except Exception as e: response['msg'] = str(e) response['error_num'] = 1 return JsonResponse(response) （带文件的post会比较特殊，后面在例子里面单独讲）POST例子和GET例子主要的区别在于：获取传递过来的数据的方式不同，注意这里的JSON.loads。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 @require_http_methods([\"POST\"]) def get_info_games(request): response = {} try: # 获取前端post过来的文件什么的 post_message = json.loads(request.body) # 获取前端post过来的参数什么的还是使用get reveive['params'] = request.GET.get('params') games = json.loads(serializers.serialize(\"json\", games)) response['games'] = games response['mag'] = 'success' response['error_num'] = 0 except Exception as e: response['msg'] = str(e) response['error_num'] = 1 return JsonResponse(response) 增删改查demo 以上述设计的coverage_test表格为例子，“增删改查”实际上都是对数据库进行的操作，因此实际上的操作范例都较为相似，下面废话不多说，直接给出demo进行讲解。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 # 增：实际上就是获取数据（post），将数据存储进数据库中，所以我们首先使用post协议，在根据上述的八股文，用json.load(request.body)获取post传过来的数据，其表现为字典的形式。 # 由于文件传输的类型是2进制数据流，没办法用json load，所以和普通的post处理比较不同，我们后面讲，这里先讲基本的post。 from models import CoverageInfo @require_http_methods([\"POST\"]) def update_task(request): response = {} try: post_message = json.loads(request.body) # print(post_message) # 讲数据存进我们定义的类结构中。 tasks = CoverageInfo(task_name = post_message['task_name'], author = post_message['author'], lang_type = post_message['lang_type'], create_time = datetime.datetime.now(), ) # 使用save命令将其存进数据库中 task.save() #可以返回一下我们存储起来的数据 response['task'] = json.loads(serializers.serialize(\"json\", games)) response['mag'] = 'success' response['error_num'] = 0 except Exception as e: response['msg'] = str(e) response['error_num'] = 2 return JsonResponse(response) 删除/修改/查询，实际上是类似的，都是先找到然后再进行操作，这里一并讲了\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 # 显示近期的5个task @require_http_methods(['GET']) def recent_tasks(request): response = {} num_to_show = 5 try: # .objects.filter()会返回符合filter条件的所有记录，如果是空的就会返回所有 # 所以删，改，查，就是从前端传递一个id回来，然后我们用filter找到他，然后print、覆盖、删除。 tasks = CoverageInfo.objects.filter() response['tasks'] = json.loads(serializers.serialize(\"json\", models)) response['tasks'] = response['tasks'][-num_to_show:] # print(response['models']) response['msg'] = 'success' response['error_num'] = 0 except Exception as e: response['msg'] = str(e) response['error_num'] = 1 return JsonResponse(response) 删、改、查，（使用get方法用参数来找到就行了）\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 @require_http_methods([\"GET\"]) def delete_models(request): response = {} try: get_id = request.GET.get(\"ID\") # ID是在前端定义好的传回来的key，随便定啥都行 # 查询 results = CoverageInfo.objects.filter(m_id = get_id) # 删除 CoverageInfo.objects.filter(m_id=get_id).delete() # 修改（基于查询那一步） results.author = request.GET.get('Author') ... # 重复操作每一条属性 response['mag'] = 'success' response['error_num'] = 0 except Exception as e: response['msg'] = str(e) response['error_num'] = 1 return JsonResponse(response) 文件接受API demo 由于我这边还没有完全掌握文件传输的方法，这里我的实现会和基本的post方法获取有一点区分，下面讲解文件传输的后端操作：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 @require_http_methods(['POST']) def accept_code_file(request): # 原版test_api response = {} # （存在本地）定义一个存储文件的基本地址，（本地先新建这个目录） base_path = \"/data/home/metis/workspace/code_file\" try: # 用作者名来管理文件的存储地址 author_name = request.GET.get('author') if not author_name: author_name = 'tmp' # 把地址和提交者名拼起来，没有的话新建文件夹 real_path = os.path.join(base_path, author_name) if not os.path.exists(real_path): os.mkdir(real_path) # 循环存储传过来的所有文件 for filename, file in request.FILES.items(): print(filename, file) tmp = file.read() # 文件的二进制数据流，也就是实际要存下来的数据 newfilename = random_filename(file.name) # 可以对文件名进行简单的处理 final_path = os.path.join(real_path, newfilename) # 拼接地址 print(final_path) # 讲文件存起来(使用chunk便于大文件的断点续传，避免大文件传输出现问题) # (TBD) 测试验证是否正确 （可能需要使用request.FILES['file']替代后面的file.chunks） with open(final_path, 'wb') as f: for chunk in file.chunks(): f.write(chunk) # 小文件传输的例子 with open(final_path, 'wb') as f: f.save(tmp) # 获取代码的类型,执行对应的代码,生成html文件,返回文件的地址 lang_type = request.GET.get('lang_type') # 逻辑是这样，如果处理覆盖率的时间比较长，可能要在后台跑，这个研究下怎么处理。 # 关键词 Django后台、Django多线程、还没查好，先放一些参考资料，可能就是用一个线程来执行任务 # https://www.tioit.cc/index.php/archives/6/ # https://zhuaxia.xyz/detail/11847 html_path = coverage_test(final_path, lang_type) # 建立数据库词条，可以新增一条代码存储的路径(数据) tasks = CoverageInfo( task_name = request.GET.get('task_name'), author = request.GET.get('author'), lang_type = request.GET.get('lang_type'), create_time = datetime.datetime.now(), res_path = request.GET.get('html_path'), code_path = final_path, ) task.save() # 将词条存进数据库里。 response['task'] = json.loads(serializers.serialize(\"json\", tasks)) response['msg'] = 'success' response['error_num'] = 0 except Exception as e: response['msg'] = str(e) response['error_num'] = 1 return JsonResponse(response) 注意pipeline写完接口后要去注册url。\nAPI注册 首先将我们的所有api都注册到/api/（可以自己改） 下面：在项目（vuebackend）的urls.py配置文件（这个可能是自己生成或者默认的）\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 \"\"\"vuebackend URL Configuration The `urlpatterns` list routes URLs to views. For more information please see: https://docs.djangoproject.com/en/3.2/topics/http/urls/ Examples: Function views 1. Add an import: from my_app import views 2. Add a URL to urlpatterns: path('', views.home, name='home') Class-based views 1. Add an import: from other_app.views import Home 2. Add a URL to urlpatterns: path('', Home.as_view(), name='home') Including another URLconf 1. Import the include() function: from django.urls import include, path 2. Add a URL to urlpatterns: path('blog/', include('blog.urls')) \"\"\" from django.contrib import admin from django.urls import path, include import vueapi.urls urlpatterns = [ path('admin/', admin.site.urls), path('api/', include(vueapi.urls)), # 改这里可以了（就初始化的时候改一下就行） ] 然后注册我们的每个API具体的地址/api/中\n1 2 3 4 5 6 7 8 # from django.urls import path, re_path from django.urls import re_path from . import views urlpatterns = [ re_path(r'accept_code_file$', views.accept_code_file), ] 注册完成后可以用curl命令测试api\n命令行使用curl命令测试API\n测试get 1 curl http://127.0.0.1:8000/api/?= 填我们在django的后端中注册的名字、key-value的形式输入我们传入后端的数据。\n1 curl http://127.0.0.1:8000/api/accept_code_file?author=aiken\u0026task_name=test 测试post 1 curl -d \"Key=Value\" 'http://127.0.0.1:8000/api/accept_code_file?author=aiken7task_name=test' -d后面是post获取的\n？后面是get获取的\n前后端联动 该部分主要从这几个部分开始介绍：Get请求后端操作返回数据、Post传输数据给后端并接受返回值、Debug方式、具体demo（文件传输、数据的增删改查、最近的数据显示）。\n前后端进行接口的交互主要是前端基于axios 这个模块向后端发送请求的（文件传输我用的这个写法），在tdesign 中还封装了一种形式，好像也是基于axios封装的（其他的我都用的这种写法）\n这一部分方法都在method（）中定义，然后在需要的地方定义，通常为更新data中的数据，\n发起一个Get请求 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 getModelList() { this.$request .get('http://9.134.13.0:8000/api/recent_models') # url .then((res) =\u003e { # 前端返回的数据在res中 const m_model_list = res.data.models; # 通过 res.data.\u003ckey\u003e的方式取出数据，就是我们返回的一整个json 看前端的console.log打印出来的值，可以知道其是一个列表形式的，而我们返回值是列表中的list[i].field.将其存进临时的列表中 const m_list_test = []; for (let i = 0; i \u003c m_model_list.length; ++i){ m_list_test.push(m_model_list[i].fields); } # this取全局变量，在data中定义好的，我们更新这个值用来渲染数据 this.model_list = m_list_test; console.log(this.model_list); }) .catch((e) =\u003e { console.log(e) }); }, 发起一个POST请求 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 getGameInfo() { console.log(\"start\") this.$request // 将上个路由界面穿过来的id作为参数，传到后端去，然后请求后端返回特定的数据 .post('http://9.134.13.0:8000/api/get_info_games', this.$route.query['ids']) .then((res) =\u003e { const task_list = res.data.games[0].fields; console.log(JSON.stringify(res)); const m_list_res = Array(); // 赋值变量 for (var key in task_list) { m_list_res.push({ name: key, value: task_list[key], }) } console.log(m_list_res); // 赋值全局变量 this.baseInfoData = m_list_res; }) .catch((e) =\u003e { console.log(e); }); }, 文件传输的特殊POST请求 普通的post\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 onSubmitPost() { console.log('submit! post'); this.$request // 将全局参数中的formdata用post传递到后端，接受后端返回到信息 .post(\"http://9.134.13.0:8000/api/create_battel\", this.formData) .then((res) =\u003e { console.log(JSON.stringify(res)); console.log('---------------------------'); console.log(JSON.stringify(this.formData)); }) .catch((e) =\u003e { console.log(e); alert(' create battel fail'); }); } 对应页面跳转的post\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 submit_file(file) { console.log(file) // 获取文件到临时的变量formdatas中 let formdatas = new FormData() formdatas.append('file', file) console.log(this.formData.author) axios({ url: 'http://9.134.13.0:8000/api/test_api', method: 'post', headers: { 'Content-Type': 'multipart/form-data' }, // data传递文件数据 params传递参数数据 data: formdatas, params: { 'author': this.formData.author }, }).then((res) =\u003e { console.log(res) this.$message.success(`文件 ${file.name} 上传成功`); }).finally(() =\u003e { // this.handleSuccess(); }); }, Debug 首先介绍简单的变更查看方式，方便知道别人在基础的项目上做了啥改动\n借助VsCode和Git，安装git，vscode，vscode的git插件\n初始化一个项目（无论是Django还是vue还是任何其他）\ngit init，git add，git commit 提交一次原始版本\n将别人的代码文件拖进来覆盖掉，即可在vscode边栏中的git项目管理中，看到与上次提交的不同，从而看出别人有多少改变，借助该工具也能轻松的还原回原始的样子。\n（该指令是基于git diff的，但是在命令行中没有那么易于查看，因此借助vscode，git diff也可以了解一下）\nnode重新安装依赖包\n1 2 3 4 rm -rv node_modules # del those files we downlaods rm package-lock.json # del the install info npm cache clear --force npm install NPM中包的安装路径\n节选自参考链接Link 本地安装 npm install 安装到当前路径的node_modules中 全局安装添加-g参数 全局文件的安装地址在: npm root -g ","wordCount":"1934","inLanguage":"en","image":"https://hugotest-phi.vercel.app/cover/cover13.jpeg","datePublished":"2022-10-02T18:00:00Z","dateModified":"2022-10-02T18:00:00Z","author":[{"@type":"Person","name":"aikenhong"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://hugotest-phi.vercel.app/posts/custom_web/"},"publisher":{"@type":"Organization","name":"aiken's blog","logo":{"@type":"ImageObject","url":"https://hugotest-phi.vercel.app/favicon/ghost.ico"}}}</script></head><body id=top><script type=module src=https://cdn.jsdmirror.com/npm/ionicons@7.1.0/dist/ionicons/ionicons.esm.js defer></script><script nomodule src=https://cdn.jsdmirror.com/npm/ionicons@7.1.0/dist/ionicons/ionicons.js defer></script><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://hugotest-phi.vercel.app/ accesskey=h title="aiken's blog (Alt + H)">aiken's blog</a><div class=logo-switches><button id=theme-toggle-nav accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://hugotest-phi.vercel.app/ title=home><span>home</span></a></li><li><a href=https://hugotest-phi.vercel.app/archives/ title=archives><span>archives</span></a></li><li><a href=https://hugotest-phi.vercel.app/search title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><div class=sidebar><ul><li class=logo style=--bg:#333><a href=#><div class=logo-icon><img src=/logo/logo.png></div><div class=logo-text>Aiken's Blog</div></a></li><div class=menulist><li style=--bg:#f44336><a href=https://hugotest-phi.vercel.app/ title=home><div class=logo-icon><ion-icon name=home-outline></ion-icon></div><div class=logo-text>home</div></a></li><li style=--bg:#b145e9><a href=https://hugotest-phi.vercel.app/posts/ title=posts><div class=logo-icon><ion-icon name=newspaper-outline></ion-icon></div><div class=logo-text>posts</div></a></li><li style=--bg:#0f93c7><a href=https://hugotest-phi.vercel.app/tags/ title=tags><div class=logo-icon><ion-icon name=pricetags-outline></ion-icon></div><div class=logo-text>tags</div></a></li><li style=--bg:#ffa117><a href=https://hugotest-phi.vercel.app/categories/ title=categories><div class=logo-icon><ion-icon name=grid-outline></ion-icon></div><div class=logo-text>categories</div></a></li><li style=--bg:#0fc70f><a href=https://hugotest-phi.vercel.app/archives/ title=archives><div class=logo-icon><ion-icon name=folder-outline></ion-icon></div><div class=logo-text>archives</div></a></li><li style=--bg:#d16111><a href=https://hugotest-phi.vercel.app/about/ title=about><div class=logo-icon><ion-icon name=person></ion-icon></div><div class=logo-text>about</div></a></li><li style=--bg:#15c095><a href=https://hugotest-phi.vercel.app/search title="search (Alt + /)" accesskey=/><div class=logo-icon><ion-icon name=search></ion-icon></div><div class=logo-text>search</div></a></li></div><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt +T)"><li><div class=logo-icon id=moon><ion-icon name=moon-outline></ion-icon></div><div class=logo-icon id=sun><ion-icon name=sunny-outline></ion-icon></div></li></button></div></ul></div><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://hugotest-phi.vercel.app/>Home</a>&nbsp;»&nbsp;<a href=https://hugotest-phi.vercel.app/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">基于Vue和Django的前后端开发实践</h1><div class=post-meta><span title='2022-10-02 18:00:00 +0000 UTC'>October 2, 2022</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;1934 words&nbsp;·&nbsp;aikenhong&nbsp;·&nbsp;<a href=/tags/vue> Vue</a>&nbsp;·&nbsp;<a href=/tags/django> Django</a>&nbsp;·&nbsp;<a href=/tags/mysql> Mysql</a>&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/custom_web.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=eager src=https://hugotest-phi.vercel.app/cover/cover13.jpeg alt></figure><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%9f%ba%e6%9c%ac%e4%bf%a1%e6%81%af aria-label=基本信息>基本信息</a><ul class=header-level-2><li><a href=#%e5%90%af%e5%8a%a8%e6%9c%8d%e5%8a%a1 aria-label=启动服务>启动服务</a></li></ul></li><li><a href=#%e7%8e%af%e5%a2%83%e9%85%8d%e7%bd%aeubuntu aria-label=环境配置（Ubuntu）>环境配置（Ubuntu）</a><ul class=header-level-2><li><a href=#%e5%89%8d%e7%ab%af%e7%8e%af%e5%a2%83%e9%85%8d%e7%bd%ae aria-label=前端环境配置>前端环境配置</a></li><li><a href=#mysql%e7%8e%af%e5%a2%83%e9%85%8d%e7%bd%ae aria-label=MySQL环境配置>MySQL环境配置</a></li><li><a href=#django%e7%8e%af%e5%a2%83%e9%85%8d%e7%bd%aewith-mysql aria-label="Django环境配置（with mysql）">Django环境配置（with mysql）</a></li></ul></li><li><a href=#%e5%bc%80%e5%8f%91%e6%8c%87%e5%8d%97 aria-label=开发指南>开发指南</a></li><li><a href=#vue%e5%92%8ctdesign%e5%89%8d%e7%ab%af%e5%bc%80%e5%8f%91 aria-label=VUE和Tdesign前端开发>VUE和Tdesign前端开发</a><ul class=header-level-2><li><a href=#%e9%a1%b5%e9%9d%a2%e7%9a%84%e7%bb%84%e6%88%90 aria-label=页面的组成>页面的组成</a></li><li><a href=#%e9%a1%b5%e9%9d%a2%e7%9a%84%e8%b7%b3%e8%bd%ac%e7%bb%93%e6%9e%9c%e9%a1%b5%e8%b7%b3%e8%bd%ac%e4%b9%8b%e7%b1%bb aria-label=页面的跳转（结果页跳转之类）>页面的跳转（结果页跳转之类）</a></li><li><a href=#%e6%96%87%e4%bb%b6%e4%bc%a0%e8%be%93%e5%89%8d%e7%ab%af%e6%8e%a5%e5%8f%a3%e7%9a%84%e7%bc%96%e5%86%99 aria-label=文件传输前端接口的编写>文件传输前端接口的编写</a></li><li><a href=#%e9%9d%99%e6%80%81html%e9%a1%b5%e9%9d%a2%e5%8a%a0%e8%bd%bd aria-label=静态HTML页面加载>静态HTML页面加载</a></li><li><a href=#%e5%89%8d%e5%90%8e%e7%ab%af%e7%9a%84%e8%81%94%e9%80%9a aria-label=前后端的联通>前后端的联通</a></li></ul></li><li><a href=#django%e5%90%8e%e7%ab%af%e5%bc%80%e5%8f%91 aria-label=Django后端开发>Django后端开发</a><ul class=header-level-2><li><a href=#%e6%95%b0%e6%8d%ae%e8%a1%a8%e8%ae%be%e8%ae%a1 aria-label=数据表设计>数据表设计</a></li><li><a href=#api%e8%ae%be%e8%ae%a1 aria-label=API设计>API设计</a><ul class=header-level-3><li><a href=#%e5%a2%9e%e5%88%a0%e6%94%b9%e6%9f%a5demo aria-label=增删改查demo>增删改查demo</a></li><li><a href=#%e6%96%87%e4%bb%b6%e6%8e%a5%e5%8f%97api-demo aria-label="文件接受API demo">文件接受API demo</a></li></ul></li><li><a href=#api%e6%b3%a8%e5%86%8c aria-label=API注册>API注册</a></li></ul></li><li><a href=#%e5%89%8d%e5%90%8e%e7%ab%af%e8%81%94%e5%8a%a8 aria-label=前后端联动>前后端联动</a><ul class=header-level-2><li><a href=#%e5%8f%91%e8%b5%b7%e4%b8%80%e4%b8%aaget%e8%af%b7%e6%b1%82 aria-label=发起一个Get请求>发起一个Get请求</a></li><li><a href=#%e5%8f%91%e8%b5%b7%e4%b8%80%e4%b8%aapost%e8%af%b7%e6%b1%82 aria-label=发起一个POST请求>发起一个POST请求</a></li><li><a href=#%e6%96%87%e4%bb%b6%e4%bc%a0%e8%be%93%e7%9a%84%e7%89%b9%e6%ae%8apost%e8%af%b7%e6%b1%82 aria-label=文件传输的特殊POST请求>文件传输的特殊POST请求</a></li></ul></li><li><a href=#debug aria-label=Debug>Debug</a></li></ul></div></details></div></aside><script>let activeElement,elements;document.addEventListener("DOMContentLoaded",function(){if(checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),elements.length>0){activeElement=elements[0];const e=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${e}"]`).classList.add("active")}const t=document.getElementById("top-link");t&&t.addEventListener("click",e=>{e.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})})},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{const e=window.pageYOffset||document.documentElement.scrollTop;if(e===0)return;elements&&elements.length>0&&(elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase(),n=document.querySelector(`.inner ul li a[href="#${t}"]`);n.classList.remove("read")}),activeElement=Array.from(elements).find(t=>{if(getOffsetTop(t)-e>0&&getOffsetTop(t)-e<window.innerHeight/2)return t})||activeElement,elements.forEach((t)=>{const o=encodeURI(t.getAttribute("id")).toLowerCase(),s=document.querySelector(`.inner ul li a[href="#${o}"]`);if(t===activeElement){s.classList.add("active");const e=document.querySelector(".toc .inner"),t=s.offsetTop,n=e.clientHeight,o=s.clientHeight,i=t-n/2+o/2;e.scrollTo({top:i,behavior:"smooth"})}else getOffsetTop(t)<e&&s.classList.add("read"),s.classList.remove("active")}))},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return!document.querySelector(".hugo-encryptor-prompt")&&elements.length!=0&&(elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),console.log("Elements re-queried:",elements)),0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><head><script src=https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/crypto-js/3.1.9-1/crypto-js.js></script></head><div class=hugo-encryptor-container><div class=hugo-encryptor-prompt><p>文章的部分内容被密码保护：</p></div><div class=hugo-encryptor-form><input class=hugo-encryptor-input placeholder=请输入密码>
<input class=hugo-encryptor-button type=button value=CLICK onclick=_click_handler(this)></div><div class=hugo-encryptor-cipher-text data-password=aikenhong_blog style=display:none><span style=display:none>--- DON'T MODIFY THIS LINE ---</span><p>@Aikenhong 2022 介绍基于Tdesign和Django的界面安装和前后端联调，ubuntu version，</p><p>该文章首先介绍如何配置环境，后续基于现有项目来介绍如何从零来构建基本的网页和后端服务。</p><h2 id=基本信息>基本信息<a hidden class=anchor aria-hidden=true href=#基本信息>#</a></h2><p>（已完成）下载编写好的网页压缩包：web-design，里面包含了vue和django模块。</p><p>路径两种方式打开：</p><ol><li>（命令行） <code>cd ~/workspace/web_design_group10/</code></li><li>（资源管理器）主目录下的workspace/web_design_group10</li></ol><p>编辑代码方式：</p><ol><li>使用vscode打开该文件夹进行编辑</li></ol><h3 id=启动服务>启动服务<a hidden class=anchor aria-hidden=true href=#启动服务>#</a></h3><p>（以下的操作都分别基于web_design_group10路径）完整的网页启动需要分别启动前后端的服务，并均保持开启状态，所以需要使用两个终端窗口来分别启动。</p><ol><li>前端服务：在view-design路径下使用命令:<code>npm run dev</code>，可参考VUE启动</li><li>后端服务：在vuebackend页面使用命令：</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python manager.py runserver
</span></span></code></pre></td></tr></table></div></div><p>（python版本需要是3以上）</p><ol start=3><li>数据库服务：数据库安装后好像是默认启动的，如果发现有数据库的错误，按照ubuntu 启动mysql执行。</li></ol><p>在启动服务之前，有一些环境需要配置，接下来我们将描述初始的环境准备。</p><h2 id=环境配置ubuntu>环境配置（Ubuntu）<a hidden class=anchor aria-hidden=true href=#环境配置ubuntu>#</a></h2><p>配置主要有几个部分组成：配置前端环境（vue、node）、配置数据库（mysql）、配置后端（python包），我们首先描述前端环境的配置。</p><p>**特定项目迁移：**只需要安装node和NPM，然后再对应目录npm i即可</p><p>**初始化一个项目：**安装完node、npm之后，安装vue和tdesign，参考对应的官方文档即可，（npm install）</p><h3 id=前端环境配置>前端环境配置<a hidden class=anchor aria-hidden=true href=#前端环境配置>#</a></h3><p>前端项目基于NodeJS，所以我们需要首先安装Node和NPM，在Ubuntu中安装Node的命令如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 首先更新NOdejs的软件源，基于基于需要的版本修改其中的版本号 14/16</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 接着使用apt命令下载nodejs 和 npm</span>
</span></span><span class=line><span class=cl>sudo apt-get install npm, nodejs
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看版本验证安装是否成功</span>
</span></span><span class=line><span class=cl>node -V
</span></span><span class=line><span class=cl>npm -V
</span></span></code></pre></td></tr></table></div></div><p>接着对特定前端（NodeJS）项目安装依赖</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /web-design-group10/view-design
</span></span><span class=line><span class=cl><span class=c1># 执行如下命令可直接根据项目的进行package的安装</span>
</span></span><span class=line><span class=cl><span class=c1># npm install 可以简写为 npm i</span>
</span></span><span class=line><span class=cl>npm install
</span></span></code></pre></td></tr></table></div></div><p>安装完基本依赖后，即可启动前端服务看看页面是否正常运行，默认的访问路径是localhost:3001</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 启动前端项目在view-design目录下</span>
</span></span><span class=line><span class=cl>npm run dev 
</span></span><span class=line><span class=cl><span class=c1># 启动后可以看到对应的端口和ip（建议首先使用localhost对前后端进行调试）</span>
</span></span></code></pre></td></tr></table></div></div><p>启动服务后可以边修改页面边预览效果（感觉不对劲就手动重启下，有时候响应会出现问题）</p><h3 id=mysql环境配置>MySQL环境配置<a hidden class=anchor aria-hidden=true href=#mysql环境配置>#</a></h3><p>由于Django（后面我们会讲）将诸多对于数据库，例如MySQL的操作都集成成了Python语句，所以对于MySQL配置的部分，我们只需要做如下的准备：</p><p><strong>安装MySQL</strong> -> <strong>初始化MySQL（设置密码）</strong>-><strong>为后端创建一个初始的数据库</strong> -> <strong>在DJango</strong>中做好对应的设置。</p><p>在Ubuntu上安装mysql：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># install mysql(in ubuntu)</span>
</span></span><span class=line><span class=cl>sudo apt-get install mysql-client
</span></span><span class=line><span class=cl>sudo apt-get install mysql-server
</span></span></code></pre></td></tr></table></div></div><p>初始化MySQL（设置密码）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 进入mysql</span>
</span></span><span class=line><span class=cl>sudo mysql
</span></span></code></pre></td></tr></table></div></div><p>进入mysql之后，通过设置基本的密码来初始化sql的服务（执行别的命令之前我们需要该密码）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>mysql</span><span class=o>&gt;</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>alter</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=s1>&#39;root&#39;</span><span class=o>@</span><span class=s1>&#39;localhost&#39;</span><span class=w> </span><span class=n>indentify</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=n>mysql_native_password</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=s1>&#39;passwd@of@my&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>退出</span><span class=n>mysql数据库</span><span class=err>，验证是否正确初始化</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>mysql</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>exit</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>​ 上述命令中，密码的小引号不能省略</p><p>接着验证密码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mysql -u root -p
</span></span><span class=line><span class=cl><span class=c1># 输入密码，如果正确的话会进入数据库，到这里已经可以了，我们开始创建后续django使用的数据库</span>
</span></span><span class=line><span class=cl><span class=c1># 通过show databases; 可以查看现在创建好的所有数据库</span>
</span></span></code></pre></td></tr></table></div></div><p>创建项目所需的数据库（建议和项目文件夹同名，方便记忆）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1># 创建数据库并设定utf8编码，避免编码问题
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>mysql</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>create</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=o>&lt;</span><span class=n>project</span><span class=o>-</span><span class=n>name</span><span class=o>&gt;</span><span class=w> </span><span class=k>character</span><span class=w> </span><span class=kt>set</span><span class=w> </span><span class=n>utf8</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1># 使用show databass查看是否正确创建
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>mysql</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>show</span><span class=w> </span><span class=k>databases</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1># 使用use &lt;database-name&gt; 进入对应的数据库
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>mysql</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=o>&lt;</span><span class=k>databases</span><span class=o>-</span><span class=n>name</span><span class=o>&gt;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1># 使用show tables查看已经创建好的表格
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>mysql</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>show</span><span class=w> </span><span class=kp>tables</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>到这里对于数据库的配置就告一段落，后续只需要在Django中设置如下的内容即可：</p><ul><li>使用的数据库架构（mysql or else）</li><li>使用的具体数据库，（我们为后端创建的那个）</li><li>数据库的访问密码</li></ul><p>之后就可以在Django的python代码中执行常见的数据库操作来进行响应的增删改查。</p><p><strong>参考链接</strong>：<a href=https://www.digitalocean.com/community/tutorials/how-to-install-mysql-on-ubuntu-20-04 target=_blank rel=noopener>install</a>
、<a href=https://www.liujiangblog.com/course/django/165 target=_blank rel=noopener>刘江</a></p><h3 id=django环境配置with-mysql>Django环境配置（with mysql）<a hidden class=anchor aria-hidden=true href=#django环境配置with-mysql>#</a></h3><p><a href=https://docs.djangoproject.com/zh-hans/4.1/ target=_blank rel=noopener>Django</a>
作为Python的一个库（Lib）安装过程实际上是配置一个python环境，这里主要考虑到结合mysql需要安装一些额外的库和设置，同样，会分成以下的几步：</p><p><strong>安装Django</strong>-><strong>安装Django-Mysql需要的库</strong>-><strong>建立Django和mysql连接</strong>（填写上面提到的密码等）-><strong>初始化项目</strong></p><ol><li><strong>安装Django</strong></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 如果没有pip的话试试pip3，如果是pip3安装的，最后启动服务的时候要记得用python3来启动</span>
</span></span><span class=line><span class=cl>pip install django
</span></span></code></pre></td></tr></table></div></div><ol start=2><li><strong>安装mysqlclient</strong></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pip install mysqlclient
</span></span></code></pre></td></tr></table></div></div><ol start=3><li><strong>创建一个空的Django项目</strong>：</li></ol><p>（cd）移动到一个我们放置项目的空目录（忽略&lt;>），就会创建一个my-project-name的项目：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>django-admin startproject &lt;my-project-name&gt;
</span></span></code></pre></td></tr></table></div></div><p>其文件结构如下（具体作用解析：https://docs.djangoproject.com/zh-hans/4.1/intro/tutorial01/）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mysite/
</span></span><span class=line><span class=cl>    manage.py
</span></span><span class=line><span class=cl>    mysite/
</span></span><span class=line><span class=cl>        __init__.py
</span></span><span class=line><span class=cl>        settings.py
</span></span><span class=line><span class=cl>        urls.py         <span class=c1># 接口的路由管理,也就是我们的接口在哪边访问</span>
</span></span><span class=line><span class=cl>        asgi.py
</span></span><span class=line><span class=cl>        wsgi.py
</span></span></code></pre></td></tr></table></div></div><p>创建一个具体的“APP”，又被称作<strong>应用</strong>，这里的<strong>应用</strong>和上面创建的<strong>项目</strong>的区别在于（摘自官网）：</p><blockquote><p>项目和应用有什么区别？应用是一个专门做某件事的网络应用程序——比如博客系统，或者公共记录的数据库，或者小型的投票程序。项目则是一个网站使用的配置和应用的集合。项目可以包含很多个应用。应用可以被很多个项目使用。</p></blockquote><p>个人讲项目理解为项目，主要提供Django的基本功能和设置环境；应用则是我们进行具体功能开发的主要地方，比如我们这里创建一个webapi的应用，用来编写特定网站需要的所有接口：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 初始化APP</span>
</span></span><span class=line><span class=cl>python manager.py startapp webapi
</span></span></code></pre></td></tr></table></div></div><p>Django会创建路径如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>webapi/
</span></span><span class=line><span class=cl>    __init__.py 
</span></span><span class=line><span class=cl>    admin.py            <span class=c1># 包含django管理界面的设置</span>
</span></span><span class=line><span class=cl>    apps.py             <span class=c1># 包含webapi配置的设置</span>
</span></span><span class=line><span class=cl>    migrations/
</span></span><span class=line><span class=cl>        __init__.py
</span></span><span class=line><span class=cl>    models.py            <span class=c1># 定义数据库中的表</span>
</span></span><span class=line><span class=cl>    tests.py
</span></span><span class=line><span class=cl>    views.py             <span class=c1># 定义API</span>
</span></span></code></pre></td></tr></table></div></div><p>创建完APP（应用后），我们需要在项目的设置中安装</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vim vuebackend/vuebackend/setting.py
</span></span></code></pre></td></tr></table></div></div><p>找到INSTALLED_APPS字段，添加创建的APP，最终如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>INSTALLED_APPS</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.admin&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.auth&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.contenttypes&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.sessions&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.messages&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.staticfiles&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;corsheaders&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;webapi&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><ol start=4><li><strong>启动项目</strong></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python manage.py runserver
</span></span><span class=line><span class=cl><span class=c1># 如果希望除了localhost都能访问启动的时候可以监听所有的ip</span>
</span></span><span class=line><span class=cl><span class=c1># 然后在allow url中填上自己的ip</span>
</span></span><span class=line><span class=cl>python manager.py runserver 0.0.0.0:8000
</span></span></code></pre></td></tr></table></div></div><ol start=5><li><strong>安装其他依赖项</strong>（启动项目，缺啥就pip install啥，搞定后关掉）</li></ol><p>如果不需要数据库的话到这里就已经可以了，如果需要数据库的话，我们继续往下看。</p><ol start=6><li><strong>建立和数据库的连接</strong></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vim vuebackend/vuebackend/setting.py
</span></span></code></pre></td></tr></table></div></div><p>​ 修改其中的DATABASES字段如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>DATABASES</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;ENGINE&#39;</span><span class=p>:</span> <span class=s1>&#39;django.db.backends.mysql&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;NAME&#39;</span><span class=p>:</span> <span class=s1>&#39;vuebackend&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;USER&#39;</span><span class=p>:</span> <span class=s1>&#39;root&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;PASSWORD&#39;</span><span class=p>:</span> <span class=s1>&#39;__&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;HOST&#39;</span><span class=p>:</span> <span class=s1>&#39;127.0.0.1&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;PORT&#39;</span><span class=p>:</span> <span class=s1>&#39;3306&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><p>ENGINE，如果是mysql的引擎就填这个，别的数据去再去看，</p></li><li><p>NAME：mysql中为后端创建的数据库的名称</p></li><li><p>USER：直接使用root用户，</p></li><li><p>PASSWORD：我们初始化mysql时设置的密码</p></li><li><p>HOST：127.0.0.1 指代本机</p></li><li><p>PORT：3306为mysql默认的启动端口</p></li></ul><ol start=7><li><strong>测试数据库功能</strong></li></ol><p>Django中model.py编写的内容，Django会用其自身的形式进行“包装”（封装），转换成对应的数据库操作，然后在数据库中执行对应的命令。（好像被称作ORM）</p><p>而我们主要用到的功能是：创建类，会自动在数据库中生成表格，其中支持的数据类型可以在<a href=https://docs.djangoproject.com/zh-hans/4.1/ref/models/fields/ target=_blank rel=noopener>官网中找到参考</a>
。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.db</span> <span class=kn>import</span> <span class=n>models</span>
</span></span><span class=line><span class=cl><span class=c1># Create your models here.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Gamerecords</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    the table for saving abs and the create info
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>m_id</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>AutoField</span><span class=p>(</span><span class=n>primary_key</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>game_name</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span> <span class=o>=</span> <span class=mi>150</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>author</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span> <span class=o>=</span> <span class=mi>150</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>file_type</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span> <span class=o>=</span> <span class=mi>150</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=s2>&#34;Java&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>create_time</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>DateTimeField</span><span class=p>()</span>   <span class=c1># 对应python中的Datetime类型</span>
</span></span></code></pre></td></tr></table></div></div><p>定义之后，命令行执行命令，将这些字段映射成数据库中的一张表，下述命令执行数据库操作</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python manage.py makemigrations <span class=o>(</span>应用名，选填<span class=o>)</span>
</span></span><span class=line><span class=cl>python manage.py migrate <span class=o>(</span>应用名，选填<span class=o>)</span>
</span></span><span class=line><span class=cl>python manager.py runserver 启动服务
</span></span></code></pre></td></tr></table></div></div><p>执行完后可以去mysql对应的数据库中，使用show tables查看是否新建表成功。</p><p>然后照常启动后端服务。</p><p>参考链接：<a href=https://docs.djangoproject.com/zh-hans/4.1/ref/databases/ target=_blank rel=noopener>offical with mysql</a>
、<a href=https://blog.csdn.net/diligentkong/article/details/79129820 target=_blank rel=noopener>simple start with mysql</a></p><ol start=8><li>配置跨域便于和vue项目链接：需要安装<code>django-cors-headers</code>模块，并在设置setting.py中导入</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pip install django-cors-headers
</span></span></code></pre></td></tr></table></div></div><p>然后在项目中添加模块：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># books_demo/settings.py</span>
</span></span><span class=line><span class=cl><span class=n>INSTALLED_APPS</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=c1># demo</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;corsheaders&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>MIDDLEWARE</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;corsheaders.middleware.CorsMiddleware&#39;</span><span class=p>,</span> <span class=c1># 需注意与其他中间件顺序，这里放在最前面即可</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 支持跨域配置开始</span>
</span></span><span class=line><span class=cl><span class=n>CORS_ORIGIN_ALLOW_ALL</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=n>CORS_ALLOW_CREDENTIALS</span> <span class=o>=</span> <span class=kc>True</span> 
</span></span></code></pre></td></tr></table></div></div><h2 id=开发指南>开发指南<a hidden class=anchor aria-hidden=true href=#开发指南>#</a></h2><p>开发界面会基于如下的几个部分进行描述：<strong>前端开发</strong>、<strong>后端开发</strong>、<strong>前后端联通</strong>，每一部分的开发会从一个空项目开始，以现有的代码为例，来介绍各个部分的开发和联通。最后给出一个从0开始设计前端模块、后端功能、前后端传输的Task（demo）。其中也会介绍最raw的debug方式。</p><p>一些不错的参考链接：<a href=https://juejin.cn/post/6974565289484615693#heading-3 target=_blank rel=noopener>前后端从零开始构建流程demo，包含使用curl测试api</a>
、<a href=https://developer.aliyun.com/article/932995 target=_blank rel=noopener>也是前后端搭建的Demo</a></p><h2 id=vue和tdesign前端开发>VUE和Tdesign前端开发<a hidden class=anchor aria-hidden=true href=#vue和tdesign前端开发>#</a></h2><p>前端部分由于个人能力有限，仅了解到代码结构的大体构筑，和如何修改，因此不做从零开始的参数，仅以自己的认知去介绍如何修改代码，以及各个模块的交互方式介绍。</p><p>参考链接：<a href=https://tdesign.tencent.com/starter/docs/vue/custom-config target=_blank rel=noopener>页面外观配置</a>
、<a href=https://blog.csdn.net/qq_18671415/article/details/119118905 target=_blank rel=noopener>vue中引入html界面</a></p><p><a href=https://tdesign.tencent.com/starter/docs/vue/develop target=_blank rel=noopener>必看！！！核心配置，整体的文件逻辑</a></p><p>具体介绍模块：<strong>代码结构</strong>、<strong>路由结构（如何删除页面的路由，对应的页面在什么地方）</strong>、<strong>页面的简单设计逻辑</strong>、<strong>页面之间的跳转</strong></p><p>前端的代码我们基本上只关注<code>src</code>路径下的代码，所有的页面和逻辑基本都在其中：</p><p>整体的架构参考上面的链接，我们主要关注的是以下几个文件夹：</p><p>page: 存放所有的页面
router： 存放路由跳转逻辑，其中index.js中*定义了默认的主页，其他文件中，定义页面的具体url，<a href=https://tdesign.tencent.com/starter/docs/vue/router-menu target=_blank rel=noopener>参考链接</a></p><h3 id=页面的组成>页面的组成<a hidden class=anchor aria-hidden=true href=#页面的组成>#</a></h3><p>可以参考page中的每个文件夹，核心就是：每个index.vue是一个页面。</p><p>每个页面基本有三个部分组成：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>tempalte</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nx>样式布局</span><span class=err>，</span><span class=nx>也就是基本的外观</span><span class=err>，</span><span class=nx>按钮</span><span class=err>，</span><span class=nx>乱七八糟的</span><span class=err>，</span><span class=nx>去tdesign</span> <span class=nx>vue之类的网站上找模版</span><span class=err>，</span><span class=nx>进行组合即可</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>tempalte</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=kr>export</span> <span class=k>default</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>data</span>
</span></span><span class=line><span class=cl>    	<span class=nx>初始化和设置各种变量</span>
</span></span><span class=line><span class=cl>  	<span class=nx>created</span>
</span></span><span class=line><span class=cl>    	<span class=nx>里面的函数在页面创建的时候执行</span>
</span></span><span class=line><span class=cl>  	<span class=nx>mounted</span>
</span></span><span class=line><span class=cl>  		<span class=nx>里面的函数在页面挂载时候执行</span>
</span></span><span class=line><span class=cl>		<span class=nx>method</span>
</span></span><span class=line><span class=cl>  		<span class=nx>定义的各种奇奇怪怪的函数</span><span class=err>，</span><span class=nx>与后端交互的函数</span><span class=err>，</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nx>定义一些加粗之类的样式</span><span class=err>，</span><span class=nx>用来对template的的基本组件进行加工</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>其中script中各个部分里面放的函数在不同时候执行：生命周期可以参考https://juejin.cn/post/6874855535234170887，其实就是字面意思，在创建页面之前执行beforecreate啥的（大概意思，具体我也没有太了解）。</p><p>method里面就是单纯的函数定义，我们的上传之类的交互代码可以放在这里，然后把函数：</p><ol><li>绑定到按下按钮等事件上或者</li><li>绑定到（放到）某些生命周期中，比如创建页面的时候执行一次，或者页面挂载的时候执行一次之类的</li></ol><h3 id=页面的跳转结果页跳转之类>页面的跳转（结果页跳转之类）<a hidden class=anchor aria-hidden=true href=#页面的跳转结果页跳转之类>#</a></h3><p>我实现的**逻辑（Pipeline）**是这样的：</p><p>（前置）跳转到的页面需要再router中注册过 -> 编写一个函数，按下以后跳转到对应的页面，并传递一个id->跳转到的页面打开的时候读取id，读取数据。</p><p><strong>router的注册</strong></p><p>在router那个路径，我不确定是path还是name,还是重定向地址，反正调试的时候试试</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-tsx data-lang=tsx><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=s2>&#34;path&#34;</span><span class=o>:</span> <span class=s2>&#34;modelbase&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=s2>&#34;name&#34;</span><span class=o>:</span> <span class=s2>&#34;modelbase&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=s2>&#34;component&#34;</span><span class=o>:</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s2>&#34;@/pages/list/modelbase/index.vue&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>		<span class=s2>&#34;meta&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=s2>&#34;title&#34;</span><span class=o>:</span> <span class=s2>&#34;上传模型&#34;</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>},</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>页面跳转的函数</strong></p><p>Router.push就会跳转到对应的页面,name页面名字，query就是传递过去的参数</p><p>参考commandtable.vue，row是列表中的参数，代表列表中的某一项，</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>    <span class=nx>handleClickDetail</span><span class=p>(</span> <span class=nx>row</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>m_id_detail</span> <span class=o>=</span> <span class=nx>row</span><span class=p>[</span><span class=s1>&#39;row&#39;</span><span class=p>].</span><span class=nx>m_id</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>$router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;modelbase&#39;</span><span class=p>,</span> <span class=nx>query</span><span class=o>:</span> <span class=p>{</span> <span class=nx>ids</span><span class=o>:</span> <span class=nx>m_id_detail</span> <span class=p>}</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>跳转过去的页面加载参数</strong></p><p>根据传递过来的参数生成相应的数据用来展示，或者二次跳转？</p><p>跳转过去的页面，在生成的生命周期中，使用whtch方法，route传递过来的参数以变化我们就执行下面的函数。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>created</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>$watch</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=k>this</span><span class=p>.</span><span class=nx>$route</span><span class=p>.</span><span class=nx>query</span><span class=p>,</span> <span class=p>(</span><span class=nx>to_params</span><span class=p>,</span> <span class=nx>old_params</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>$route</span><span class=p>.</span><span class=nx>query</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>gettaskinfo</span><span class=p>();</span>  <span class=c1>// your function here  using the route.query中的参数
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>$route</span><span class=p>.</span><span class=nx>query</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span></code></pre></td></tr></table></div></div><p>然后生成对应的报告之类的</p><p>参考文献：<a href=https://blog.csdn.net/weixin_46547740/article/details/109254290 target=_blank rel=noopener>详情页</a></p><p>关键词：vue详情页 商品页之类</p><h3 id=文件传输前端接口的编写>文件传输前端接口的编写<a hidden class=anchor aria-hidden=true href=#文件传输前端接口的编写>#</a></h3><p>该部分的编写依托于<code>elementui</code>或者<code>tdesign</code>的<code>upload</code>组件封装</p><p>其基本的编写逻辑如下：</p><ul><li><p><code>action</code>中填写我们编写的后端接口url</p></li><li><p><code>formatResponse</code>中填写对后端返回值的格式处理，用以适应组件识别传输事件是否成功</p><ol><li>参考 suceess和fail事件的触发条件，用来编写format</li><li>tdesign事件是在response中添加url信息和如果失败的话就用error字段传回失败原因</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>return</span> <span class=p>{...</span><span class=nx>res</span><span class=p>,</span> <span class=nx>url</span><span class=o>:</span> <span class=nx>xxx</span><span class=p>.</span><span class=nx>xxx</span><span class=p>.</span><span class=nx>xxx</span><span class=p>.</span><span class=nx>xxx</span><span class=o>:</span><span class=nx>xxxx</span><span class=p>,</span> <span class=nx>error</span> <span class=o>:</span> <span class=s2>&#34;why you fail&#34;</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>即可在可视化组件上绑定对应的文件上传</p></li></ul><h3 id=静态html页面加载>静态HTML页面加载<a hidden class=anchor aria-hidden=true href=#静态html页面加载>#</a></h3><p>再编写前端页面的时候，有时候需要处理后端生成的html页面，我们希望能够跳转到指定的html文件的。</p><ol><li>需要将HTML作为静态文件存储到VUE project中静态目录（<code>public</code>）中（防止VUE对HTML文件进行二次编译处理）</li><li>假如我们存储的目录为：<code>public/result/index.html</code>我们可以在vue中通过下列函数打开对应页面</li></ol><p>函数如下:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>loadLocalHtml</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>  <span class=nx>windows</span><span class=p>.</span><span class=nx>open</span><span class=p>(</span><span class=s1>&#39;/result/index.html&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>如果需要灵活加载详情页面，我们可以根据传入的参数来确定最后存储的地址（或者在后端对文件进行移动）</p><h3 id=前后端的联通>前后端的联通<a hidden class=anchor aria-hidden=true href=#前后端的联通>#</a></h3><p>同样也是在mehtod中定义一个访问接口的方法，然后在合适的时候调用这个访问接口的函数就行。放在下面的前后端联动的部分</p><h2 id=django后端开发>Django后端开发<a hidden class=anchor aria-hidden=true href=#django后端开发>#</a></h2><p>实现基础功能的话，后端的逻辑和实现相对较为简单，本文介绍：开发api的流程（将自己的功能嵌入）、提供对数据库进行<strong>增删改查</strong>的例子、提供<strong>文件传输</strong>api的例子。文件传输好像有更优的解法，后续进行更新</p><p><strong>后端开发Pipeline</strong></p><p>（optional）<code>model.py</code>设计数据表 -> <code>view</code>中设计api（数据获取，数据上传等任何功能）->注册api到特定的url->测试api->done.</p><ol><li>如果有数据库需求才使用，可以简单的存储（用户，时间，存储html路径，语言类型，项目名称等）</li><li>view中有特定的八股文，下面为会讲到特定的<code>&lt;func></code>占位部分，填入自己的功能，实现：**根据传来的数据或者GET请求，执行特定的操作，返回特定信息（不返回也行）**的流程即可。</li><li>将该域名注册个特定的api，便于访问该api</li></ol><h3 id=数据表设计>数据表设计<a hidden class=anchor aria-hidden=true href=#数据表设计>#</a></h3><p>参考上述的例子（环境配置-Django-6数据库测试），在<code>model.py</code>文件中创建一个类，定义需要的表结构，然后执行两部数据库操作即可：</p><p>下面给出一个Coverage-Test的上传信息类设计Demo：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.db</span> <span class=kn>import</span> <span class=n>models</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Class</span> <span class=n>CoverageInfo</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=n>m_id</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>AutoField</span><span class=p>(</span><span class=n>primary_key</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>task_name</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span> <span class=o>=</span> <span class=mi>150</span><span class=p>,</span> <span class=n>default</span> <span class=o>=</span> <span class=s2>&#34;coverage test&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>author</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span> <span class=o>=</span> <span class=mi>150</span><span class=p>,</span> <span class=n>default</span> <span class=o>=</span> <span class=s2>&#34;anmous&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>create_time</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>DateTimeField</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>lang_type</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span> <span class=o>=</span> <span class=mi>150</span><span class=p>,</span> <span class=n>default</span> <span class=o>=</span> <span class=s2>&#34;JAVA&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>res_path</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span> <span class=o>=</span> <span class=mi>1000</span><span class=p>,</span> <span class=n>defailt</span> <span class=o>=</span> <span class=s2>&#34;~/workspace/coverage-res/author_default/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>code_path</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span> <span class=o>=</span> <span class=mi>1000</span><span class=p>,</span> <span class=n>default</span> <span class=o>=</span> <span class=s1>&#39;~/workspace/coverage-code/author_default/&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>该Table的处理逻辑如下：</p><ul><li>task_name、author、lang_type交由前端用户填写，传递到后端；</li><li>m_id为mysql自动递增的数据逻辑我们无需处理，create_time在后端接受请求的时候自动计算</li><li>res_path在执行完覆盖率测试后，将文件存储指定定地点，然后将该地点返回，将该地点存进数据库，这样我们就可以随时查询任一个记录的覆盖率结果。</li></ul><p>将这些信息存入数据库，便于增删改查，文件和结果则存储本地。</p><p><strong>mysql中生成表</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python manage.py makemigrations 
</span></span><span class=line><span class=cl>python manage.py migrate
</span></span></code></pre></td></tr></table></div></div><h3 id=api设计>API设计<a hidden class=anchor aria-hidden=true href=#api设计>#</a></h3><p>主要从前端接受两种请求：GET、POST，然后基于这两种请求，我们实现对数据增删改查的操作，或者其他的特定操作。API的定义在<code>views.py</code>中完成。基础的范式如下：</p><p>需要注意的是，前后端之间的数据传输，基本都是约定为JSON这种KEY-VALUE格式的，故而我们好像需要进行什么序列化反序列化的操作，来对信息进行解读（理论后续补充）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.http</span> <span class=kn>import</span> <span class=n>JsonResponse</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.views.decorators.http</span> <span class=kn>import</span> <span class=n>require_http_methods</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.core</span> <span class=kn>import</span> <span class=n>serializers</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@require_http_methods</span><span class=p>([</span><span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_games_index</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1># using get to get value from front ----&gt;</span>
</span></span><span class=line><span class=cl>      <span class=n>receive</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>      <span class=n>reveive</span><span class=p>[</span><span class=s1>&#39;info1&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;info1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=o>...</span> <span class=c1># like that ， 应该也可以循环取出</span>
</span></span><span class=line><span class=cl>      <span class=c1># &lt;----- using get to get value from front </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1># your function here 「-----------------</span>
</span></span><span class=line><span class=cl>      <span class=c1># 基于我们从前端获取到的数据，做任何事情，执行任何函数</span>
</span></span><span class=line><span class=cl>      <span class=c1># -------------- your function here 」</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1># 可以给前端返回一些数据 response[&#39;res&#39;] = ... 之类的,传过去之前要对数据进行序列话处理</span>
</span></span><span class=line><span class=cl>      <span class=c1># yourdata需要时{}存kv形式</span>
</span></span><span class=line><span class=cl>      <span class=n>response</span><span class=p>[</span><span class=s1>&#39;res&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>serializers</span><span class=o>.</span><span class=n>serialize</span><span class=p>(</span><span class=s2>&#34;json&#34;</span><span class=p>,</span> <span class=n>yourdata</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=n>response</span><span class=p>[</span><span class=s1>&#39;msg&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;success&#39;</span>
</span></span><span class=line><span class=cl>      <span class=n>response</span><span class=p>[</span><span class=s1>&#39;error_num&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>response</span><span class=p>[</span><span class=s1>&#39;msg&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>response</span><span class=p>[</span><span class=s1>&#39;error_num&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=n>JsonResponse</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>（带文件的post会比较特殊，后面在例子里面单独讲）POST例子和GET例子主要的区别在于：获取传递过来的数据的方式不同，注意这里的JSON.loads。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@require_http_methods</span><span class=p>([</span><span class=s2>&#34;POST&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_info_games</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=n>response</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1># 获取前端post过来的文件什么的</span>
</span></span><span class=line><span class=cl>      <span class=n>post_message</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>body</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=c1># 获取前端post过来的参数什么的还是使用get</span>
</span></span><span class=line><span class=cl>      <span class=n>reveive</span><span class=p>[</span><span class=s1>&#39;params&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;params&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=n>games</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>serializers</span><span class=o>.</span><span class=n>serialize</span><span class=p>(</span><span class=s2>&#34;json&#34;</span><span class=p>,</span> <span class=n>games</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=n>response</span><span class=p>[</span><span class=s1>&#39;games&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>games</span>
</span></span><span class=line><span class=cl>      <span class=n>response</span><span class=p>[</span><span class=s1>&#39;mag&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;success&#39;</span>
</span></span><span class=line><span class=cl>      <span class=n>response</span><span class=p>[</span><span class=s1>&#39;error_num&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>response</span><span class=p>[</span><span class=s1>&#39;msg&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>response</span><span class=p>[</span><span class=s1>&#39;error_num&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=n>JsonResponse</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=增删改查demo>增删改查demo<a hidden class=anchor aria-hidden=true href=#增删改查demo>#</a></h4><p>以上述设计的coverage_test表格为例子，“增删改查”实际上都是对数据库进行的操作，因此实际上的操作范例都较为相似，下面废话不多说，直接给出demo进行讲解。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 增：实际上就是获取数据（post），将数据存储进数据库中，所以我们首先使用post协议，在根据上述的八股文，用json.load(request.body)获取post传过来的数据，其表现为字典的形式。</span>
</span></span><span class=line><span class=cl><span class=c1># 由于文件传输的类型是2进制数据流，没办法用json load，所以和普通的post处理比较不同，我们后面讲，这里先讲基本的post。</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>models</span> <span class=kn>import</span> <span class=n>CoverageInfo</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@require_http_methods</span><span class=p>([</span><span class=s2>&#34;POST&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>update_task</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>post_message</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>body</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(post_message)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 讲数据存进我们定义的类结构中。</span>
</span></span><span class=line><span class=cl>        <span class=n>tasks</span> <span class=o>=</span> <span class=n>CoverageInfo</span><span class=p>(</span><span class=n>task_name</span> <span class=o>=</span> <span class=n>post_message</span><span class=p>[</span><span class=s1>&#39;task_name&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                            <span class=n>author</span> <span class=o>=</span> <span class=n>post_message</span><span class=p>[</span><span class=s1>&#39;author&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                            <span class=n>lang_type</span> <span class=o>=</span> <span class=n>post_message</span><span class=p>[</span><span class=s1>&#39;lang_type&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                            <span class=n>create_time</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                            <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 使用save命令将其存进数据库中</span>
</span></span><span class=line><span class=cl>        <span class=n>task</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>#可以返回一下我们存储起来的数据</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;task&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>serializers</span><span class=o>.</span><span class=n>serialize</span><span class=p>(</span><span class=s2>&#34;json&#34;</span><span class=p>,</span> <span class=n>games</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;mag&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;success&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;error_num&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;msg&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;error_num&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>JsonResponse</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>删除/修改/查询，实际上是类似的，都是先找到然后再进行操作，这里一并讲了</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 显示近期的5个task</span>
</span></span><span class=line><span class=cl><span class=nd>@require_http_methods</span><span class=p>([</span><span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>recent_tasks</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=n>num_to_show</span> <span class=o>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      	<span class=c1># .objects.filter()会返回符合filter条件的所有记录，如果是空的就会返回所有</span>
</span></span><span class=line><span class=cl>        <span class=c1># 所以删，改，查，就是从前端传递一个id回来，然后我们用filter找到他，然后print、覆盖、删除。</span>
</span></span><span class=line><span class=cl>        <span class=n>tasks</span> <span class=o>=</span> <span class=n>CoverageInfo</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;tasks&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>serializers</span><span class=o>.</span><span class=n>serialize</span><span class=p>(</span><span class=s2>&#34;json&#34;</span><span class=p>,</span> <span class=n>models</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;tasks&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>response</span><span class=p>[</span><span class=s1>&#39;tasks&#39;</span><span class=p>][</span><span class=o>-</span><span class=n>num_to_show</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(response[&#39;models&#39;])</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;msg&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;success&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;error_num&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;msg&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;error_num&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>JsonResponse</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>删、改、查，（使用get方法用参数来找到就行了）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@require_http_methods</span><span class=p>([</span><span class=s2>&#34;GET&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>delete_models</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>        <span class=n>get_id</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;ID&#34;</span><span class=p>)</span> <span class=c1># ID是在前端定义好的传回来的key，随便定啥都行</span>
</span></span><span class=line><span class=cl>        <span class=c1># 查询</span>
</span></span><span class=line><span class=cl>        <span class=n>results</span> <span class=o>=</span> <span class=n>CoverageInfo</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>m_id</span> <span class=o>=</span> <span class=n>get_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 删除</span>
</span></span><span class=line><span class=cl>        <span class=n>CoverageInfo</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>m_id</span><span class=o>=</span><span class=n>get_id</span><span class=p>)</span><span class=o>.</span><span class=n>delete</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=c1># 修改（基于查询那一步）</span>
</span></span><span class=line><span class=cl>        <span class=n>results</span><span class=o>.</span><span class=n>author</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;Author&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=o>...</span> <span class=c1># 重复操作每一条属性</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;mag&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;success&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;error_num&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;msg&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;error_num&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>JsonResponse</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=文件接受api-demo>文件接受API demo<a hidden class=anchor aria-hidden=true href=#文件接受api-demo>#</a></h4><p>由于我这边还没有完全掌握文件传输的方法，这里我的实现会和基本的post方法获取有一点区分，下面讲解文件传输的后端操作：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@require_http_methods</span><span class=p>([</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>accept_code_file</span><span class=p>(</span><span class=n>request</span><span class=p>):</span> <span class=c1># 原版test_api</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=c1># （存在本地）定义一个存储文件的基本地址，（本地先新建这个目录）</span>
</span></span><span class=line><span class=cl>    <span class=n>base_path</span> <span class=o>=</span> <span class=s2>&#34;/data/home/metis/workspace/code_file&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      	<span class=c1># 用作者名来管理文件的存储地址</span>
</span></span><span class=line><span class=cl>        <span class=n>author_name</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;author&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>author_name</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>            <span class=n>author_name</span> <span class=o>=</span> <span class=s1>&#39;tmp&#39;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 把地址和提交者名拼起来，没有的话新建文件夹</span>
</span></span><span class=line><span class=cl>        <span class=n>real_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>base_path</span><span class=p>,</span> <span class=n>author_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>real_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>os</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>real_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 循环存储传过来的所有文件</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>filename</span><span class=p>,</span> <span class=n>file</span> <span class=ow>in</span> <span class=n>request</span><span class=o>.</span><span class=n>FILES</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=n>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>tmp</span> <span class=o>=</span> <span class=n>file</span><span class=o>.</span><span class=n>read</span><span class=p>()</span> <span class=c1># 文件的二进制数据流，也就是实际要存下来的数据</span>
</span></span><span class=line><span class=cl>            <span class=n>newfilename</span> <span class=o>=</span> <span class=n>random_filename</span><span class=p>(</span><span class=n>file</span><span class=o>.</span><span class=n>name</span><span class=p>)</span> <span class=c1># 可以对文件名进行简单的处理</span>
</span></span><span class=line><span class=cl>            <span class=n>final_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>real_path</span><span class=p>,</span> <span class=n>newfilename</span><span class=p>)</span> <span class=c1># 拼接地址</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>final_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># 讲文件存起来(使用chunk便于大文件的断点续传，避免大文件传输出现问题)</span>
</span></span><span class=line><span class=cl>            <span class=c1># (TBD) 测试验证是否正确 （可能需要使用request.FILES[&#39;file&#39;]替代后面的file.chunks）</span>
</span></span><span class=line><span class=cl>            <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>final_path</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>file</span><span class=o>.</span><span class=n>chunks</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                  <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># 小文件传输的例子</span>
</span></span><span class=line><span class=cl>            <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>final_path</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>             		<span class=n>f</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>tmp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 获取代码的类型,执行对应的代码,生成html文件,返回文件的地址</span>
</span></span><span class=line><span class=cl>        <span class=n>lang_type</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;lang_type&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 逻辑是这样，如果处理覆盖率的时间比较长，可能要在后台跑，这个研究下怎么处理。</span>
</span></span><span class=line><span class=cl>        <span class=c1># 关键词 Django后台、Django多线程、还没查好，先放一些参考资料，可能就是用一个线程来执行任务</span>
</span></span><span class=line><span class=cl>        <span class=c1># https://www.tioit.cc/index.php/archives/6/</span>
</span></span><span class=line><span class=cl>        <span class=c1># https://zhuaxia.xyz/detail/11847</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>html_path</span> <span class=o>=</span> <span class=n>coverage_test</span><span class=p>(</span><span class=n>final_path</span><span class=p>,</span> <span class=n>lang_type</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 建立数据库词条，可以新增一条代码存储的路径(数据)</span>
</span></span><span class=line><span class=cl>        <span class=n>tasks</span> <span class=o>=</span> <span class=n>CoverageInfo</span><span class=p>(</span>
</span></span><span class=line><span class=cl>          									<span class=n>task_name</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;task_name&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                            <span class=n>author</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;author&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                            <span class=n>lang_type</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;lang_type&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                            <span class=n>create_time</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                            <span class=n>res_path</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;html_path&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          									<span class=n>code_path</span> <span class=o>=</span> <span class=n>final_path</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                            <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>task</span><span class=o>.</span><span class=n>save</span><span class=p>()</span> <span class=c1># 将词条存进数据库里。</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;task&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>serializers</span><span class=o>.</span><span class=n>serialize</span><span class=p>(</span><span class=s2>&#34;json&#34;</span><span class=p>,</span> <span class=n>tasks</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;msg&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;success&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;error_num&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;msg&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;error_num&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>JsonResponse</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>注意pipeline</strong>写完接口后要去注册url。</p><h3 id=api注册>API注册<a hidden class=anchor aria-hidden=true href=#api注册>#</a></h3><p>首先将我们的所有api都注册到/api/（可以自己改） 下面：在项目（vuebackend）的<code>urls.py</code>配置文件（这个可能是自己生成或者默认的）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;vuebackend URL Configuration
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>The `urlpatterns` list routes URLs to views. For more information please see:
</span></span></span><span class=line><span class=cl><span class=s2>    https://docs.djangoproject.com/en/3.2/topics/http/urls/
</span></span></span><span class=line><span class=cl><span class=s2>Examples:
</span></span></span><span class=line><span class=cl><span class=s2>Function views
</span></span></span><span class=line><span class=cl><span class=s2>    1. Add an import:  from my_app import views
</span></span></span><span class=line><span class=cl><span class=s2>    2. Add a URL to urlpatterns:  path(&#39;&#39;, views.home, name=&#39;home&#39;)
</span></span></span><span class=line><span class=cl><span class=s2>Class-based views
</span></span></span><span class=line><span class=cl><span class=s2>    1. Add an import:  from other_app.views import Home
</span></span></span><span class=line><span class=cl><span class=s2>    2. Add a URL to urlpatterns:  path(&#39;&#39;, Home.as_view(), name=&#39;home&#39;)
</span></span></span><span class=line><span class=cl><span class=s2>Including another URLconf
</span></span></span><span class=line><span class=cl><span class=s2>    1. Import the include() function: from django.urls import include, path
</span></span></span><span class=line><span class=cl><span class=s2>    2. Add a URL to urlpatterns:  path(&#39;blog/&#39;, include(&#39;blog.urls&#39;))
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>from django.contrib import admin
</span></span><span class=line><span class=cl>from django.urls import path, include
</span></span><span class=line><span class=cl>import vueapi.urls
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>urlpatterns</span> <span class=o>=</span> <span class=o>[</span>
</span></span><span class=line><span class=cl>    path<span class=o>(</span><span class=s1>&#39;admin/&#39;</span>, admin.site.urls<span class=o>)</span>,
</span></span><span class=line><span class=cl>    path<span class=o>(</span><span class=s1>&#39;api/&#39;</span>, include<span class=o>(</span>vueapi.urls<span class=o>))</span>,   <span class=c1># 改这里可以了（就初始化的时候改一下就行）</span>
</span></span><span class=line><span class=cl><span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p>然后注册我们的每个API具体的地址<code>/api/&lt;specifal></code>中</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># from django.urls import path, re_path</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.urls</span> <span class=kn>import</span> <span class=n>re_path</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>.</span> <span class=kn>import</span> <span class=n>views</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>urlpatterns</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=n>re_path</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;accept_code_file$&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>accept_code_file</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>注册完成后可以用curl命令测试api</p><p><strong>命令行使用curl命令测试API</strong></p><ol><li>测试get</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl  http://127.0.0.1:8000/api/&lt;api_name&gt;?&lt;key&gt;<span class=o>=</span>&lt;value&gt;
</span></span></code></pre></td></tr></table></div></div><p><code>&lt;api></code> 填我们在django的后端中注册的名字、key-value的形式输入我们传入后端的数据。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://127.0.0.1:8000/api/accept_code_file?author<span class=o>=</span>aiken<span class=p>&amp;</span><span class=nv>task_name</span><span class=o>=</span><span class=nb>test</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>测试post</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -d <span class=s2>&#34;Key=Value&#34;</span> <span class=s1>&#39;http://127.0.0.1:8000/api/accept_code_file?author=aiken7task_name=test&#39;</span> 
</span></span></code></pre></td></tr></table></div></div><p>-d后面是post获取的</p><p>？后面是get获取的</p><h2 id=前后端联动>前后端联动<a hidden class=anchor aria-hidden=true href=#前后端联动>#</a></h2><p>该部分主要从这几个部分开始介绍：<strong>Get请求后端操作返回数据</strong>、<strong>Post传输数据给后端并接受返回值</strong>、<strong>Debug方式</strong>、具体demo（文件传输、数据的增删改查、最近的数据显示）。</p><p>前后端进行接口的交互主要是前端基于<a href=http://axios-js.com/zh-cn/docs/index.html target=_blank rel=noopener>axios</a>
这个模块向后端发送请求的（文件传输我用的这个写法），在<a href=https://tdesign.tencent.com/starter/docs/vue/request-data target=_blank rel=noopener>tdesign</a>
中还封装了一种形式，好像也是基于axios封装的（其他的我都用的这种写法）</p><p>这一部分方法都在method（）中定义，然后在需要的地方定义，通常为更新data中的数据，</p><h3 id=发起一个get请求>发起一个Get请求<a hidden class=anchor aria-hidden=true href=#发起一个get请求>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>    <span class=nx>getModelList</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>$request</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;http://9.134.13.0:8000/api/recent_models&#39;</span><span class=p>)</span>  <span class=err>#</span> <span class=nx>url</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nx>then</span><span class=p>((</span><span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>                                  <span class=err>#</span> <span class=nx>前端返回的数据在res中</span>
</span></span><span class=line><span class=cl>          <span class=kr>const</span> <span class=nx>m_model_list</span> <span class=o>=</span> <span class=nx>res</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>models</span><span class=p>;</span>           
</span></span><span class=line><span class=cl>          <span class=err>#</span> <span class=nx>通过</span> <span class=nx>res</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>key</span><span class=o>&gt;</span><span class=nx>的方式取出数据</span><span class=err>，</span><span class=nx>就是我们返回的一整个json</span>
</span></span><span class=line><span class=cl>          <span class=nx>看前端的console</span><span class=p>.</span><span class=nx>log打印出来的值</span><span class=err>，</span><span class=nx>可以知道其是一个列表形式的</span><span class=err>，</span><span class=nx>而我们返回值是列表中的list</span><span class=p>[</span><span class=nx>i</span><span class=p>].</span><span class=nx>field</span><span class=p>.</span><span class=nx>将其存进临时的列表中</span>
</span></span><span class=line><span class=cl>          <span class=kr>const</span> <span class=nx>m_list_test</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>          <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>m_model_list</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=o>++</span><span class=nx>i</span><span class=p>){</span>  
</span></span><span class=line><span class=cl>            <span class=nx>m_list_test</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>m_model_list</span><span class=p>[</span><span class=nx>i</span><span class=p>].</span><span class=nx>fields</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=err>#</span> <span class=nx>this取全局变量</span><span class=err>，</span><span class=nx>在data中定义好的</span><span class=err>，</span><span class=nx>我们更新这个值用来渲染数据</span>
</span></span><span class=line><span class=cl>          <span class=k>this</span><span class=p>.</span><span class=nx>model_list</span> <span class=o>=</span> <span class=nx>m_list_test</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>model_list</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=k>catch</span><span class=p>((</span><span class=nx>e</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=发起一个post请求>发起一个POST请求<a hidden class=anchor aria-hidden=true href=#发起一个post请求>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>    <span class=nx>getGameInfo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;start&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>$request</span>
</span></span><span class=line><span class=cl>      	 <span class=c1>// 将上个路由界面穿过来的id作为参数，传到后端去，然后请求后端返回特定的数据
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;http://9.134.13.0:8000/api/get_info_games&#39;</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>$route</span><span class=p>.</span><span class=nx>query</span><span class=p>[</span><span class=s1>&#39;ids&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nx>then</span><span class=p>((</span><span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=kr>const</span> <span class=nx>task_list</span> <span class=o>=</span> <span class=nx>res</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>games</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>fields</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>res</span><span class=p>));</span>
</span></span><span class=line><span class=cl>          <span class=kr>const</span> <span class=nx>m_list_res</span> <span class=o>=</span> <span class=nb>Array</span><span class=p>();</span>
</span></span><span class=line><span class=cl>          <span class=c1>// 赋值变量
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>key</span> <span class=k>in</span> <span class=nx>task_list</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>m_list_res</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span>
</span></span><span class=line><span class=cl>              <span class=nx>name</span><span class=o>:</span> <span class=nx>key</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nx>value</span><span class=o>:</span> <span class=nx>task_list</span><span class=p>[</span><span class=nx>key</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>m_list_res</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=c1>// 赋值全局变量
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=k>this</span><span class=p>.</span><span class=nx>baseInfoData</span> <span class=o>=</span> <span class=nx>m_list_res</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=k>catch</span><span class=p>((</span><span class=nx>e</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=文件传输的特殊post请求>文件传输的特殊POST请求<a hidden class=anchor aria-hidden=true href=#文件传输的特殊post请求>#</a></h3><p>普通的post</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>    <span class=nx>onSubmitPost</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;submit! post&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>$request</span>
</span></span><span class=line><span class=cl>      	<span class=c1>// 将全局参数中的formdata用post传递到后端，接受后端返回到信息
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s2>&#34;http://9.134.13.0:8000/api/create_battel&#34;</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>formData</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nx>then</span><span class=p>((</span><span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>res</span><span class=p>));</span>
</span></span><span class=line><span class=cl>          <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;---------------------------&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>formData</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=k>catch</span><span class=p>((</span><span class=nx>e</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=nx>alert</span><span class=p>(</span><span class=s1>&#39; create battel fail&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>对应页面跳转的post</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>    <span class=nx>submit_file</span><span class=p>(</span><span class=nx>file</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 获取文件到临时的变量formdatas中
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kd>let</span> <span class=nx>formdatas</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>FormData</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=nx>formdatas</span><span class=p>.</span><span class=nx>append</span><span class=p>(</span><span class=s1>&#39;file&#39;</span><span class=p>,</span> <span class=nx>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>formData</span><span class=p>.</span><span class=nx>author</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nx>axios</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>url</span><span class=o>:</span> <span class=s1>&#39;http://9.134.13.0:8000/api/test_api&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>method</span><span class=o>:</span> <span class=s1>&#39;post&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=s1>&#39;Content-Type&#39;</span><span class=o>:</span> <span class=s1>&#39;multipart/form-data&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=c1>// data传递文件数据 params传递参数数据
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>data</span><span class=o>:</span> <span class=nx>formdatas</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>params</span><span class=o>:</span> <span class=p>{</span> <span class=s1>&#39;author&#39;</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>formData</span><span class=p>.</span><span class=nx>author</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>      <span class=p>}).</span><span class=nx>then</span><span class=p>((</span><span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>$message</span><span class=p>.</span><span class=nx>success</span><span class=p>(</span><span class=sb>`文件 </span><span class=si>${</span><span class=nx>file</span><span class=p>.</span><span class=nx>name</span><span class=si>}</span><span class=sb> 上传成功`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}).</span><span class=k>finally</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// this.handleSuccess();
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=debug>Debug<a hidden class=anchor aria-hidden=true href=#debug>#</a></h2><p><strong>首先介绍简单的变更查看方式，方便知道别人在基础的项目上做了啥改动</strong></p><ol><li><p>借助VsCode和Git，安装git，vscode，vscode的git插件</p></li><li><p>初始化一个项目（无论是Django还是vue还是任何其他）</p></li><li><p>git init，git add，git commit 提交一次原始版本</p></li><li><p>将别人的代码文件拖进来覆盖掉，即可在vscode边栏中的git项目管理中，看到与上次提交的不同，从而看出别人有多少改变，借助该工具也能轻松的还原回原始的样子。</p></li></ol><p>（该指令是基于git diff的，但是在命令行中没有那么易于查看，因此借助vscode，git diff也可以了解一下）</p><p><strong>node重新安装依赖包</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rm -rv node_modules <span class=c1># del those files we downlaods</span>
</span></span><span class=line><span class=cl>rm package-lock.json <span class=c1># del the install info </span>
</span></span><span class=line><span class=cl>npm cache clear --force
</span></span><span class=line><span class=cl>npm install
</span></span></code></pre></td></tr></table></div></div><p><strong>NPM中包的安装路径</strong></p><p>节选自参考链接<a href=https://cloud.tencent.com/developer/article/1834667 target=_blank rel=noopener>Link</a></p><ol><li>本地安装 <code>npm install</code> 安装到当前路径的node_modules中</li><li>全局安装添加<code>-g</code>参数</li></ol><p>全局文件的安装地址在: <code>npm root -g</code></p></div></div><script>function sanitizeContent(e){return e.replace(/[\x00-\x1F\x7F]/g,"").trim()}function encryptContent(e,t){const n=CryptoJS.MD5(e).toString(),s=n.substring(16),o=padContent(t),i=CryptoJS.AES.encrypt(o,CryptoJS.enc.Utf8.parse(n),{iv:CryptoJS.enc.Utf8.parse(s),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return CryptoJS.enc.Base64.stringify(i.ciphertext)}function padContent(e){const t=32,n=t-e.length%t;return e}function processEncryptedBlocks(){const t=document.querySelectorAll(".hugo-encryptor-cipher-text");t.forEach(e=>{const t=e.getAttribute("data-password"),n=e.innerHTML.trim(),s=sanitizeContent(n),o=encryptContent(t,s);e.innerHTML=o,e.removeAttribute("data-password")});const e=document.createElement("script");e.src="/js/decrypt.js",document.body.appendChild(e)}document.addEventListener("DOMContentLoaded",processEncryptedBlocks)</script></div><footer class=post-footer><ul class=post-tags><li><a href=https://hugotest-phi.vercel.app/tags/vue/>Vue</a></li><li><a href=https://hugotest-phi.vercel.app/tags/django/>Django</a></li><li><a href=https://hugotest-phi.vercel.app/tags/mysql/>Mysql</a></li></ul><nav class=paginav><a class=prev href=https://hugotest-phi.vercel.app/posts/nodes/><span class=title>« Prev</span><br><span>Nodejs、yarn、npm关系辨析</span>
</a><a class=next href=https://hugotest-phi.vercel.app/posts/vue-chapter1/><span class=title>Next »</span><br><span>Vue Chapter1 基础语法</span></a></nav></footer><div id=disqus_thread></div><script>function loadDisqus(){var e=document,t=e.createElement("script");t.src="https://aiken-hugo.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t),window.disqus_config=function(){this.page.url=window.location.href,this.page.identifier=window.location.href.substring(18)}}var runningOnBrowser=typeof window!="undefined",isBot=runningOnBrowser&&!("onscroll"in window)||typeof navigator!="undefined"&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent),supportsIntersectionObserver=runningOnBrowser&&"IntersectionObserver"in window;setTimeout(function(){if(!isBot&&supportsIntersectionObserver){var e=new IntersectionObserver(function(t){t[0].isIntersecting&&(loadDisqus(),e.disconnect())},{threshold:[0]});e.observe(document.getElementById("disqus_thread"))}else loadDisqus()},1)</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by
Disqus.</a></noscript></article></main><footer class=footer><span>&copy; 2024 <a href=https://hugotest-phi.vercel.app/>aiken's blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a>
</span><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><span id=busuanzi_container>Visitors: <span id=busuanzi_value_site_uv></span>
Views: <span id=busuanzi_value_site_pv></span></span></footer><script>document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("busuanzi_value_site_uv"),t=document.getElementById("busuanzi_value_site_pv"),o=13863,i=16993;if(!e||!t){console.error("Busuanzi elements not found.");return}const n=new MutationObserver(e=>{for(let t of e)if(t.type==="childList"){n.disconnect(),t.target.innerHTML=parseInt(t.target.innerHTML||0)+o;break}}),s=new MutationObserver(e=>{for(let t of e)if(t.type==="childList"){s.disconnect(),t.target.innerHTML=parseInt(t.target.innerHTML||0)+i;break}});n.observe(e,{childList:!0}),s.observe(t,{childList:!0})})</script><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><span class=topInner><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
<span id=read_progress></span>
</span></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))}),document.getElementById("theme-toggle-nav").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script>document.addEventListener("scroll",function(){const t=document.getElementById("read_progress"),n=document.documentElement.scrollHeight,s=document.documentElement.clientHeight,o=document.documentElement.scrollTop||document.body.scrollTop;t.innerText=((o/(n-s)).toFixed(2)*100).toFixed(0)})</script><script>(function(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(e)}),i.parentNode.insertBefore(n,i)})("/js/pangu.js",function(){pangu.spacingPage()})</script></body></html>