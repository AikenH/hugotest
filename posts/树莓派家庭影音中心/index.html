<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>树莓派01 家庭影音中心 | aiken's blog</title>
<meta name=keywords content="Dev,Raspberry-Pie,Kodi"><meta name=description content="
将 RaspBerry Pi 4B 作为家庭影视中心/机顶盒的核心就是 KODI 软件，这是考虑到以下的几点：遥控器的控制、对挂载 webdav 和其他的支持

最方便的方式可以选择以 KODI 为核心的两个 OS：LibreELEC、OSMC（推荐），这两个系统以 KODI 为默认启动，同时也支持远程登录和 Docker 部署等 Linux 的功能。后者更为推荐应该是前者的官方改进版本。
考虑到后续可能会将该 SD 卡用于其他用处，因此本文选择的是使用 RaspBerryPi OS 的方案，以下围绕该方案进行展开：
RaspBerry Pi OS+Kodi+Alist 方案探究

可以参考 trouble shooting，可以发现实际上安装 kodi 最简单的方式就是直接使用 apt，无需做其他的 PPA 添加。

安装Kodi


1


sudo apt-get install kodi


安装完后，使用 kodi 命令开启或者在开始菜单的软件中心中选择 kodi 打开。
设置 GPU 显存（硬解相关）
首先做一下固件的升级：


1


sudo rpi-update


然后调整一下显存：系统设置里面将 gpu_mem 调高一些，我使用的是 4G，调整到了 256MB，切记不要调整太高，否则可能会开机失败，重启后查看显存是否设置成功。
查看 GPU 显存的方式：


1


vcgencmd get_mem arm && vcgencmd get_mem gpu


最后在 kodi 中查看相关的选项的开关情况：
参考资料：树莓派RaspberryPi 4B设置显存开启硬件加速 支持Emby|Plex|JellyFin转码 LiuJason&rsquo;sBlog
"><meta name=author content="aikenhong"><link rel=canonical href=https://hugotest-phi.vercel.app/posts/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%B6%E5%BA%AD%E5%BD%B1%E9%9F%B3%E4%B8%AD%E5%BF%83/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://hugotest-phi.vercel.app/favicon/ghost.ico><link rel=icon type=image/png sizes=16x16 href=https://hugotest-phi.vercel.app/favicon/ghost-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://hugotest-phi.vercel.app/favicon/ghost-32x32.png><link rel=apple-touch-icon href=https://hugotest-phi.vercel.app/favicon/ghost-apple-touch-icon.png><link rel=mask-icon href=https://hugotest-phi.vercel.app/favicon/ghost-192x192.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://hugotest-phi.vercel.app/posts/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%B6%E5%BA%AD%E5%BD%B1%E9%9F%B3%E4%B8%AD%E5%BF%83/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script src=https://cdn.jsdmirror.com/npm/jquery@3.5.1/dist/jquery.min.js></script><link rel=stylesheet href=https://cdn.jsdmirror.com/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css><script src=https://cdn.jsdmirror.com/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js></script><link rel=stylesheet href=https://cdn.jsdmirror.com/npm/katex@0.16.11/dist/katex.min.css><script defer src=https://cdn.jsdmirror.com/npm/katex@0.16.11/dist/katex.min.js></script><script defer src=https://cdn.jsdmirror.com/npm/katex@0.16.11/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><link rel=stylesheet href=https://cdn.jsdmirror.com/npm/lxgw-wenkai-webfont@1.1.0/style.css><link rel=stylesheet href=https://cdn.jsdmirror.com/npm/lxgw-wenkai-lite-webfont@1.1.0/style.css><link rel=stylesheet href=https://cdn.jsdmirror.com/npm/lxgw-wenkai-tc-webfont@1.0.0/style.css><link rel=stylesheet href=https://cdn.jsdmirror.com/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap" rel=stylesheet><meta property="og:url" content="https://hugotest-phi.vercel.app/posts/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%B6%E5%BA%AD%E5%BD%B1%E9%9F%B3%E4%B8%AD%E5%BF%83/"><meta property="og:site_name" content="aiken's blog"><meta property="og:title" content="树莓派01 家庭影音中心"><meta property="og:description" content=" 将 RaspBerry Pi 4B 作为家庭影视中心/机顶盒的核心就是 KODI 软件，这是考虑到以下的几点：遥控器的控制、对挂载 webdav 和其他的支持
最方便的方式可以选择以 KODI 为核心的两个 OS：LibreELEC、OSMC（推荐），这两个系统以 KODI 为默认启动，同时也支持远程登录和 Docker 部署等 Linux 的功能。后者更为推荐应该是前者的官方改进版本。
考虑到后续可能会将该 SD 卡用于其他用处，因此本文选择的是使用 RaspBerryPi OS 的方案，以下围绕该方案进行展开：
RaspBerry Pi OS+Kodi+Alist 方案探究 可以参考 trouble shooting，可以发现实际上安装 kodi 最简单的方式就是直接使用 apt，无需做其他的 PPA 添加。
安装Kodi 1 sudo apt-get install kodi 安装完后，使用 kodi 命令开启或者在开始菜单的软件中心中选择 kodi 打开。
设置 GPU 显存（硬解相关） 首先做一下固件的升级：
1 sudo rpi-update 然后调整一下显存：系统设置里面将 gpu_mem 调高一些，我使用的是 4G，调整到了 256MB，切记不要调整太高，否则可能会开机失败，重启后查看显存是否设置成功。
查看 GPU 显存的方式：
1 vcgencmd get_mem arm && vcgencmd get_mem gpu 最后在 kodi 中查看相关的选项的开关情况：
参考资料：树莓派RaspberryPi 4B设置显存开启硬件加速 支持Emby|Plex|JellyFin转码 LiuJason’sBlog "><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-06-28T07:28:27+00:00"><meta property="article:modified_time" content="2023-06-28T07:28:27+00:00"><meta property="article:tag" content="Dev"><meta property="article:tag" content="Raspberry-Pie"><meta property="article:tag" content="Kodi"><meta property="og:image" content="https://hugotest-phi.vercel.app/cover/cover25.jpeg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://hugotest-phi.vercel.app/cover/cover25.jpeg"><meta name=twitter:title content="树莓派01 家庭影音中心"><meta name=twitter:description content="
将 RaspBerry Pi 4B 作为家庭影视中心/机顶盒的核心就是 KODI 软件，这是考虑到以下的几点：遥控器的控制、对挂载 webdav 和其他的支持

最方便的方式可以选择以 KODI 为核心的两个 OS：LibreELEC、OSMC（推荐），这两个系统以 KODI 为默认启动，同时也支持远程登录和 Docker 部署等 Linux 的功能。后者更为推荐应该是前者的官方改进版本。
考虑到后续可能会将该 SD 卡用于其他用处，因此本文选择的是使用 RaspBerryPi OS 的方案，以下围绕该方案进行展开：
RaspBerry Pi OS+Kodi+Alist 方案探究

可以参考 trouble shooting，可以发现实际上安装 kodi 最简单的方式就是直接使用 apt，无需做其他的 PPA 添加。

安装Kodi


1


sudo apt-get install kodi


安装完后，使用 kodi 命令开启或者在开始菜单的软件中心中选择 kodi 打开。
设置 GPU 显存（硬解相关）
首先做一下固件的升级：


1


sudo rpi-update


然后调整一下显存：系统设置里面将 gpu_mem 调高一些，我使用的是 4G，调整到了 256MB，切记不要调整太高，否则可能会开机失败，重启后查看显存是否设置成功。
查看 GPU 显存的方式：


1


vcgencmd get_mem arm && vcgencmd get_mem gpu


最后在 kodi 中查看相关的选项的开关情况：
参考资料：树莓派RaspberryPi 4B设置显存开启硬件加速 支持Emby|Plex|JellyFin转码 LiuJason&rsquo;sBlog
"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://hugotest-phi.vercel.app/posts/"},{"@type":"ListItem","position":2,"name":"树莓派01 家庭影音中心","item":"https://hugotest-phi.vercel.app/posts/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%B6%E5%BA%AD%E5%BD%B1%E9%9F%B3%E4%B8%AD%E5%BF%83/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"树莓派01 家庭影音中心","name":"树莓派01 家庭影音中心","description":" 将 RaspBerry Pi 4B 作为家庭影视中心/机顶盒的核心就是 KODI 软件，这是考虑到以下的几点：遥控器的控制、对挂载 webdav 和其他的支持\n最方便的方式可以选择以 KODI 为核心的两个 OS：LibreELEC、OSMC（推荐），这两个系统以 KODI 为默认启动，同时也支持远程登录和 Docker 部署等 Linux 的功能。后者更为推荐应该是前者的官方改进版本。\n考虑到后续可能会将该 SD 卡用于其他用处，因此本文选择的是使用 RaspBerryPi OS 的方案，以下围绕该方案进行展开：\nRaspBerry Pi OS+Kodi+Alist 方案探究 可以参考 trouble shooting，可以发现实际上安装 kodi 最简单的方式就是直接使用 apt，无需做其他的 PPA 添加。\n安装Kodi 1 sudo apt-get install kodi 安装完后，使用 kodi 命令开启或者在开始菜单的软件中心中选择 kodi 打开。\n设置 GPU 显存（硬解相关） 首先做一下固件的升级：\n1 sudo rpi-update 然后调整一下显存：系统设置里面将 gpu_mem 调高一些，我使用的是 4G，调整到了 256MB，切记不要调整太高，否则可能会开机失败，重启后查看显存是否设置成功。\n查看 GPU 显存的方式：\n1 vcgencmd get_mem arm \u0026amp;\u0026amp; vcgencmd get_mem gpu 最后在 kodi 中查看相关的选项的开关情况：\n参考资料：树莓派RaspberryPi 4B设置显存开启硬件加速 支持Emby|Plex|JellyFin转码 LiuJason\u0026rsquo;sBlog ","keywords":["Dev","Raspberry-Pie","Kodi"],"articleBody":" 将 RaspBerry Pi 4B 作为家庭影视中心/机顶盒的核心就是 KODI 软件，这是考虑到以下的几点：遥控器的控制、对挂载 webdav 和其他的支持\n最方便的方式可以选择以 KODI 为核心的两个 OS：LibreELEC、OSMC（推荐），这两个系统以 KODI 为默认启动，同时也支持远程登录和 Docker 部署等 Linux 的功能。后者更为推荐应该是前者的官方改进版本。\n考虑到后续可能会将该 SD 卡用于其他用处，因此本文选择的是使用 RaspBerryPi OS 的方案，以下围绕该方案进行展开：\nRaspBerry Pi OS+Kodi+Alist 方案探究 可以参考 trouble shooting，可以发现实际上安装 kodi 最简单的方式就是直接使用 apt，无需做其他的 PPA 添加。\n安装Kodi 1 sudo apt-get install kodi 安装完后，使用 kodi 命令开启或者在开始菜单的软件中心中选择 kodi 打开。\n设置 GPU 显存（硬解相关） 首先做一下固件的升级：\n1 sudo rpi-update 然后调整一下显存：系统设置里面将 gpu_mem 调高一些，我使用的是 4G，调整到了 256MB，切记不要调整太高，否则可能会开机失败，重启后查看显存是否设置成功。\n查看 GPU 显存的方式：\n1 vcgencmd get_mem arm \u0026\u0026 vcgencmd get_mem gpu 最后在 kodi 中查看相关的选项的开关情况：\n参考资料：树莓派RaspberryPi 4B设置显存开启硬件加速 支持Emby|Plex|JellyFin转码 LiuJason’sBlog KODI 界面设置（中文） 里面 Interface 选项 -\u003e 皮肤 -\u003e 字体选择 Arial（支持中文，不然会乱码）\n如果皮肤下面没有字体的子项，可以选择切换左下角的模式，切换到专家就可看到\n切换完字体，选择皮肤下面的区域 Region-\u003e Language -\u003e Chinese 即可。\nKODI 添加 WebDav 首先选择资料库中的进入文件区 -\u003e 添加视频 -\u003e 添加视频源处选择浏览 -\u003e 添加网络位置处\n如果是本地挂载的协议一般选择 HTTP，服务器地址填写局域网 IP 即可，远程路径填写 Dav，端口是设定好的端口； 如果是远程的一些 Alist 网站，可以选择 WebDav 的 HTTPs ，其他的参考相关网站给出的设置即可。 本地就一葫芦画瓢就行，添加完后可以看到相关的源，然后选择文件夹和对应显示的名称即可，需要注意的是，这里我们最好不启用刮削服务（Alist 等网盘的情况下），避免被封号等一系列问题。\nKodi 设置 iptv 播放 kodi 支持 iptv 播放主要依赖于PVR IPTV Simple Client 插件，通过该插件设置 m3u 直播源即可实现 iptv 的播放。\nPVR IPTV Simple Client的几种安装方法：\nkodi 直接询问是否启用； kodi-\u003e设置-\u003e插件-\u003e从库安装-\u003epvr clients-\u003e PVR IPTV Simple Client 如果上述两个方法都失效，使用插件中的从 zip 安装，相关的 zip 文件可以从此处安装：Kodi中文网 安装后在插件的设置目录中，设置 m3u 的获取方式是本地文件还是 url 即可。\n设置完成后可在首页的 TV 观看电视直播，iptv 源的获取参照 Windows App01 Potplayer \u0026 Alist 一文中的 iptv 列表获取。\nKODI 手机遥控器设置和添加 手机端直接下载 Kodi remote control ，参考设置进行配置即可\n这里可能需要设置以下用户名和密码，来允许 HTTP 控制。\n树莓派投屏方案 根据 kodi 的 wiki 已知其已经不支持 ios8 以上的 Airplay 功能，因此针对投屏的需求，只能通过视频软件或者播放器的 UpnP/DLNA 支持进行投屏。\n在 kodi 的设置界面-\u003e服务-\u003eUpnP/DLNA 中选择启用的相关选项 在 ios 中设置-\u003e对应的视频软件（如bilibili）-\u003e本地网络选择启用 播放视频时左上角 tv 的按钮，并选中本地局域网中的 kodi 即可。\nTrouble Shooting 问题解决 Kodi 官方教程安装失败原因及解决 问题描述与分析\n尝试了 Ubuntu22.04+RaspBerry 4B+Kodi+Alist 的方案，发现这种方案遵循官方教程无法在 Ubuntu 中成功的安装 Kodi，成功安装后出现以下的问题：\ncommand not found 无对应的 desktop app desktop app 无法打开 该原因是由于基于官方PPA在 Ubuntu 上安装的 Kodi 似乎无法在 RaspBerry 的架构上执行，因此无法成功安装，具体可以参考如下的几个连接，其中的讨论对该原因也会有所讲解。\nHas anyone got kodi working on ubuntu 21.04 - Raspberry Pi Forums KODI for Ubuntu Raspberry Pi version : r/kodi (reddit.com) 同时官方 指出，这种方式不适用于 armhf，（似乎 raspberry 4b 的 arm64 也无法执行\nNote that this PPA only provides builds for Ubuntu i386 and Ubuntu amd64 but not for Ubuntu armhf, which can run on a Raspberry Pi.\n可以以此查看系统的架构：查看linux系统是哪种架构：AMD、ARM、x86、x86_64、pcc 或 查看Ubuntu的版本号-菜鸟笔记 (coonote.com) 架构间的区别如下：安装包amd,amd64,arm,arm64都有什么区别？ - Cloudreve Forum amd64是 X86架构的 CPU，64位版。amd64又叫 X86_64。主流的桌面 PC，笔记本电脑，服务器（包括虚拟机）都在用 X86_64的 CPU。 arm64是 ARM 架构的 CPU，64位版。苹果新出的电脑在用 ARM 架构的 CPU。有些路由器和嵌入式设备在用 arm64的 CPU。手机和安卓平板电脑最常用的 CPU 也是 ARM 架构的。 MIPS 是 MIPS 架构的 CPU。有些嵌入式设备和家用路由器在用 MIPS 架构的 CPU。 简单的说就是：\nAMD64=linux-64bit=X86 ARM64=linux- Aarch64 =ARM Aarch 指的就是 ARM architecture\n解决方案\n发现是架构不匹配的原因导致的时候，去查询相关的源是否有对应架构的安装包：Kodi Download (APK, DEB, EOPKG, PKG, RPM, TXZ, XBPS, ZST) (pkgs.org) 找到了 Arm64 的版本\n但是进去看可以发现实际上该安装还是指向了官方 PPA，安装的 ARCH 描述为 ALL（not true），不过好在后面有别的选项：\n找到下面的 arm64 的版本，详情页就能找到下载说明，由于是官方软件源，只需要 apt 安装就行，前提是将之前安装的会导致错误版本的 PPA 源卸载干净。\n可以到/etc/apt/sources.list.d/检查并将不需要的软件源删掉，再 sudo apt-get update 一下\nUbuntu 播放 4k 视频卡顿掉帧 这部分可能是由于 Ubuntu 和 RaspBerryPi 一起用的时候，对于硬件的控制比较麻烦，导致功能中的硬解没有开启的地方导致，而在后续开启 Ubuntu 22.04 硬解的时候，需要去修改 Bios 文件，导致我这边系统损坏了无法开机，就没有做进一步的测试。\n20.04 和之前的版本有找到对应的文档， 22.04 好像暂时没有，参考之前的方案进行修改的时候出现了开机损坏的情况，所以还是要慎重。\n检查硬解是否启用\n1 2 cat /proc/device-tree/soc/firmwarekms@7e600000/status cat /proc/device-tree/v3dbus/v3d@7ec04000/status 设置的参考资料：RPI4 \u0026 Ubuntu MATE - How to enable video acceleration (dedoimedo.com) 树莓派 HDMI 热插拔 树莓派的 HDMI 接口在长时间未使用，或者在开机的时候未连接显示器的时候，会默认以无显示输出的情况启动，导致电视无法正常输出图像。\n为此，我们需要开启设置中的 hdmi_force_hotplug=1，无论是否检测到 Hdmi 显示器，都默认有 hdmi 连接，确保无需每次需要视频输出的时候都重启树莓派，具体的操作步骤如下：\n适用于 RaspBerryPi OS\n1 vim /boot/config.txt # 默认配置文件的地址 如果不在该地址，就需要找到启动分区所在的目录，应该在该目录下，找到该文件后修改将以下两项打开或新增之后重启树莓派即可；\n1 2 hdmi_force_hotplug=1 hdmi_drive=2 hdmi_force_hotplug=1 设置树莓派使用 HDMI 热插拔模式，即使没有检测到 HDMI 显示器。 hdmi_drive=2 将树莓派设置为正常的 HDMI 模式（如果支持和启用，将发送声音）。如果没有这条线，树莓派将默认切换到 DVI（无音频）模式。 但是热插拔的情况下，可能会导致在最终使用 hdmi 输出的时候，树莓派自动设定的分辨率不符合我们的使用和设备预期，因此我们可能还要基于设备对树莓派的分辨率和输出模式做一个限制；\n1 2 hdmi_group=1 hdmi_mode=16 hdmi_group 指定分辨率格式1为 CEA，电视规格的分辨率；2为 DMT，计算机显示器使用的分辨率 hdmi_mode 不同分辨率格式下的指定分辨率和刷新率情况，具体可以见表 参考资料：\n解决树莓派不接HDMI导致开机VNC无信号问题和分辨率不对问题 – CyanDragon 树莓派配置文件 config.txt - HDMI 热插拔 | Cafeting (likfe.com) 自定义树莓派的显示分辨率 | 树莓派实验室 (nxez.com) 树莓派HDMI配置 — Cloud Atlas 0.1 文档 (cloud-atlas.readthedocs.io) FI","wordCount":"473","inLanguage":"en","image":"https://hugotest-phi.vercel.app/cover/cover25.jpeg","datePublished":"2023-06-28T07:28:27Z","dateModified":"2023-06-28T07:28:27Z","author":[{"@type":"Person","name":"aikenhong"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://hugotest-phi.vercel.app/posts/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%B6%E5%BA%AD%E5%BD%B1%E9%9F%B3%E4%B8%AD%E5%BF%83/"},"publisher":{"@type":"Organization","name":"aiken's blog","logo":{"@type":"ImageObject","url":"https://hugotest-phi.vercel.app/favicon/ghost.ico"}}}</script></head><body id=top><script type=module src=https://cdn.jsdmirror.com/npm/ionicons@7.1.0/dist/ionicons/ionicons.esm.js defer></script><script nomodule src=https://cdn.jsdmirror.com/npm/ionicons@7.1.0/dist/ionicons/ionicons.js defer></script><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://hugotest-phi.vercel.app/ accesskey=h title="aiken's blog (Alt + H)">aiken's blog</a><div class=logo-switches><button id=theme-toggle-nav accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://hugotest-phi.vercel.app/ title=home><span>home</span></a></li><li><a href=https://hugotest-phi.vercel.app/archives/ title=archives><span>archives</span></a></li><li><a href=https://hugotest-phi.vercel.app/search title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><div class=sidebar><ul><li class=logo style=--bg:#333><a href=#><div class=logo-icon><img src=/logo/logo.png></div><div class=logo-text>Aiken's Blog</div></a></li><div class=menulist><li style=--bg:#f44336><a href=https://hugotest-phi.vercel.app/ title=home><div class=logo-icon><ion-icon name=home-outline></ion-icon></div><div class=logo-text>home</div></a></li><li style=--bg:#b145e9><a href=https://hugotest-phi.vercel.app/posts/ title=posts><div class=logo-icon><ion-icon name=newspaper-outline></ion-icon></div><div class=logo-text>posts</div></a></li><li style=--bg:#0f93c7><a href=https://hugotest-phi.vercel.app/tags/ title=tags><div class=logo-icon><ion-icon name=pricetags-outline></ion-icon></div><div class=logo-text>tags</div></a></li><li style=--bg:#ffa117><a href=https://hugotest-phi.vercel.app/categories/ title=categories><div class=logo-icon><ion-icon name=grid-outline></ion-icon></div><div class=logo-text>categories</div></a></li><li style=--bg:#0fc70f><a href=https://hugotest-phi.vercel.app/archives/ title=archives><div class=logo-icon><ion-icon name=folder-outline></ion-icon></div><div class=logo-text>archives</div></a></li><li style=--bg:#d16111><a href=https://hugotest-phi.vercel.app/about/ title=about><div class=logo-icon><ion-icon name=person></ion-icon></div><div class=logo-text>about</div></a></li><li style=--bg:#15c095><a href=https://hugotest-phi.vercel.app/search title="search (Alt + /)" accesskey=/><div class=logo-icon><ion-icon name=search></ion-icon></div><div class=logo-text>search</div></a></li></div><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt +T)"><li><div class=logo-icon id=moon><ion-icon name=moon-outline></ion-icon></div><div class=logo-icon id=sun><ion-icon name=sunny-outline></ion-icon></div></li></button></div></ul></div><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://hugotest-phi.vercel.app/>Home</a>&nbsp;»&nbsp;<a href=https://hugotest-phi.vercel.app/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">树莓派01 家庭影音中心</h1><div class=post-meta><span title='2023-06-28 07:28:27 +0000 UTC'>June 28, 2023</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;473 words&nbsp;·&nbsp;aikenhong&nbsp;·&nbsp;<a href=/tags/dev> Dev</a>&nbsp;·&nbsp;<a href=/tags/raspberry-pie> Raspberry-Pie</a>&nbsp;·&nbsp;<a href=/tags/kodi> Kodi</a>&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/%e6%a0%91%e8%8e%93%e6%b4%be%e5%ae%b6%e5%ba%ad%e5%bd%b1%e9%9f%b3%e4%b8%ad%e5%bf%83.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=eager src=https://hugotest-phi.vercel.app/cover/cover25.jpeg alt></figure><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#raspberry-pi-oskodialist-%e6%96%b9%e6%a1%88%e6%8e%a2%e7%a9%b6 aria-label="RaspBerry Pi OS+Kodi+Alist 方案探究">RaspBerry Pi OS+Kodi+Alist 方案探究</a><ul class=header-level-2><li><a href=#%e5%ae%89%e8%a3%85kodi aria-label=安装Kodi>安装Kodi</a></li><li><a href=#%e8%ae%be%e7%bd%ae-gpu-%e6%98%be%e5%ad%98%e7%a1%ac%e8%a7%a3%e7%9b%b8%e5%85%b3 aria-label="设置 GPU 显存（硬解相关）">设置 GPU 显存（硬解相关）</a></li><li><a href=#kodi-%e7%95%8c%e9%9d%a2%e8%ae%be%e7%bd%ae%e4%b8%ad%e6%96%87 aria-label="KODI 界面设置（中文）">KODI 界面设置（中文）</a></li><li><a href=#kodi-%e6%b7%bb%e5%8a%a0-webdav aria-label="KODI 添加 WebDav">KODI 添加 WebDav</a></li><li><a href=#kodi-%e8%ae%be%e7%bd%ae-iptv-%e6%92%ad%e6%94%be aria-label="Kodi 设置 iptv 播放">Kodi 设置 iptv 播放</a></li><li><a href=#kodi-%e6%89%8b%e6%9c%ba%e9%81%a5%e6%8e%a7%e5%99%a8%e8%ae%be%e7%bd%ae%e5%92%8c%e6%b7%bb%e5%8a%a0 aria-label="KODI 手机遥控器设置和添加">KODI 手机遥控器设置和添加</a></li><li><a href=#%e6%a0%91%e8%8e%93%e6%b4%be%e6%8a%95%e5%b1%8f%e6%96%b9%e6%a1%88 aria-label=树莓派投屏方案>树莓派投屏方案</a></li></ul></li><li><a href=#trouble-shooting-%e9%97%ae%e9%a2%98%e8%a7%a3%e5%86%b3 aria-label="Trouble Shooting 问题解决">Trouble Shooting 问题解决</a><ul class=header-level-2><li><a href=#kodi-%e5%ae%98%e6%96%b9%e6%95%99%e7%a8%8b%e5%ae%89%e8%a3%85%e5%a4%b1%e8%b4%a5%e5%8e%9f%e5%9b%a0%e5%8f%8a%e8%a7%a3%e5%86%b3 aria-label="Kodi 官方教程安装失败原因及解决">Kodi 官方教程安装失败原因及解决</a></li><li><a href=#ubuntu-%e6%92%ad%e6%94%be-4k-%e8%a7%86%e9%a2%91%e5%8d%a1%e9%a1%bf%e6%8e%89%e5%b8%a7 aria-label="Ubuntu 播放 4k 视频卡顿掉帧">Ubuntu 播放 4k 视频卡顿掉帧</a></li><li><a href=#%e6%a0%91%e8%8e%93%e6%b4%be-hdmi-%e7%83%ad%e6%8f%92%e6%8b%94 aria-label="树莓派 HDMI 热插拔">树莓派 HDMI 热插拔</a></li></ul></li><li><a href=#fi aria-label=FI>FI</a></li></ul></div></details></div></aside><script>let activeElement,elements;document.addEventListener("DOMContentLoaded",function(){if(checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),elements.length>0){activeElement=elements[0];const e=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${e}"]`).classList.add("active")}const t=document.getElementById("top-link");t&&t.addEventListener("click",e=>{e.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})})},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{const e=window.pageYOffset||document.documentElement.scrollTop;if(e===0)return;elements&&elements.length>0&&(elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase(),n=document.querySelector(`.inner ul li a[href="#${t}"]`);n.classList.remove("read")}),activeElement=Array.from(elements).find(t=>{if(getOffsetTop(t)-e>0&&getOffsetTop(t)-e<window.innerHeight/2)return t})||activeElement,elements.forEach((t)=>{const o=encodeURI(t.getAttribute("id")).toLowerCase(),s=document.querySelector(`.inner ul li a[href="#${o}"]`);if(t===activeElement){s.classList.add("active");const e=document.querySelector(".toc .inner"),t=s.offsetTop,n=e.clientHeight,o=s.clientHeight,i=t-n/2+o/2;e.scrollTo({top:i,behavior:"smooth"})}else getOffsetTop(t)<e&&s.classList.add("read"),s.classList.remove("active")}))},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return!document.querySelector(".hugo-encryptor-prompt")&&elements.length!=0&&(elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),console.log("Elements re-queried:",elements)),0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><blockquote><p>将 RaspBerry Pi 4B 作为家庭影视中心/机顶盒的核心就是 KODI 软件，这是考虑到以下的几点：遥控器的控制、对挂载 webdav 和其他的支持</p></blockquote><p>最方便的方式可以选择以 KODI 为核心的两个 OS：LibreELEC、OSMC（推荐），这两个系统以 KODI 为默认启动，同时也支持远程登录和 Docker 部署等 Linux 的功能。后者更为推荐应该是前者的官方改进版本。</p><p>考虑到后续可能会将该 SD 卡用于其他用处，因此本文选择的是使用 RaspBerryPi OS 的方案，以下围绕该方案进行展开：</p><h2 id=raspberry-pi-oskodialist-方案探究>RaspBerry Pi OS+Kodi+Alist 方案探究<a hidden class=anchor aria-hidden=true href=#raspberry-pi-oskodialist-方案探究>#</a></h2><blockquote><p>可以参考 trouble shooting，可以发现实际上安装 kodi 最简单的方式就是直接使用 apt，无需做其他的 PPA 添加。</p></blockquote><h3 id=安装kodi>安装Kodi<a hidden class=anchor aria-hidden=true href=#安装kodi>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get install kodi
</span></span></code></pre></td></tr></table></div></div><p>安装完后，使用 kodi 命令开启或者在开始菜单的软件中心中选择 kodi 打开。</p><h3 id=设置-gpu-显存硬解相关>设置 GPU 显存（硬解相关）<a hidden class=anchor aria-hidden=true href=#设置-gpu-显存硬解相关>#</a></h3><p>首先做一下<strong>固件的升级</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo rpi-update
</span></span></code></pre></td></tr></table></div></div><p>然后<strong>调整一下显存</strong>：系统设置里面将 gpu_mem 调高一些，我使用的是 4G，调整到了 256MB，切记不要调整太高，否则可能会开机失败，重启后查看显存是否设置成功。</p><p><strong>查看 GPU 显存</strong>的方式：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vcgencmd get_mem arm <span class=o>&amp;&amp;</span> vcgencmd get_mem gpu
</span></span></code></pre></td></tr></table></div></div><p>最后在 kodi 中查看相关的选项的开关情况：</p><p>参考资料：<a href=https://www.liujason.com/article/656.html target=_blank rel=noopener>树莓派RaspberryPi 4B设置显存开启硬件加速 支持Emby|Plex|JellyFin转码 LiuJason&rsquo;sBlog</a></p><h3 id=kodi-界面设置中文>KODI 界面设置（中文）<a hidden class=anchor aria-hidden=true href=#kodi-界面设置中文>#</a></h3><p>里面 Interface 选项 -> 皮肤 -> 字体选择 Arial（支持中文，不然会乱码）</p><p><div class=post-img-view><a data-fancybox=gallery href=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230701092809.png><img alt=image.png loading=lazy src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230701092809.png class=responsive-image src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230701092809.png style="display:block;margin:0 auto" alt=image.png></a></div><script>document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".responsive-image"),t=window.innerHeight/2.5;e.forEach(function(e){e.style.maxHeight=t+"px"})})</script></p><p>如果皮肤下面没有字体的子项，可以选择切换左下角的模式，切换到专家就可看到</p><p><div class=post-img-view><a data-fancybox=gallery href=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230701093132.png><img alt=image.png loading=lazy src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230701093132.png class=responsive-image src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230701093132.png style="display:block;margin:0 auto" alt=image.png></a></div><script>document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".responsive-image"),t=window.innerHeight/2.5;e.forEach(function(e){e.style.maxHeight=t+"px"})})</script></p><p>切换完字体，选择皮肤下面的区域 Region-> Language -> Chinese 即可。</p><h3 id=kodi-添加-webdav>KODI 添加 WebDav<a hidden class=anchor aria-hidden=true href=#kodi-添加-webdav>#</a></h3><p>首先选择资料库中的进入文件区 -> 添加视频 -> 添加视频源处选择浏览 -> 添加网络位置处</p><p><div class=post-img-view><a data-fancybox=gallery href=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230701093315.png><img alt=image.png loading=lazy src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230701093315.png class=responsive-image src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230701093315.png style="display:block;margin:0 auto" alt=image.png></a></div><script>document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".responsive-image"),t=window.innerHeight/2.5;e.forEach(function(e){e.style.maxHeight=t+"px"})})</script></p><ul><li>如果是本地挂载的协议一般选择 HTTP，服务器地址填写局域网 IP 即可，远程路径填写 Dav，端口是设定好的端口；</li><li>如果是远程的一些 Alist 网站，可以选择 WebDav 的 HTTPs ，其他的参考相关网站给出的设置即可。</li></ul><p>本地就一葫芦画瓢就行，添加完后可以看到相关的源，然后选择文件夹和对应显示的名称即可，需要注意的是，这里我们最好不启用刮削服务（Alist 等网盘的情况下），避免被封号等一系列问题。</p><h3 id=kodi-设置-iptv-播放>Kodi 设置 iptv 播放<a hidden class=anchor aria-hidden=true href=#kodi-设置-iptv-播放>#</a></h3><p>kodi 支持 iptv 播放主要依赖于<strong>PVR IPTV Simple Client</strong> 插件，通过该插件设置 m3u 直播源即可实现 iptv 的播放。</p><p><strong>PVR IPTV Simple Client</strong>的几种安装方法：</p><ol><li>kodi 直接询问是否启用；</li><li>kodi->设置->插件->从库安装->pvr clients-> <strong>PVR IPTV Simple Client</strong></li><li>如果上述两个方法都失效，使用插件中的从 zip 安装，相关的 zip 文件可以从此处安装：<a href=http://www.kodiplayer.cn/plugins/2969.html target=_blank rel=noopener>Kodi中文网</a></li></ol><p>安装后在插件的设置目录中，设置 m3u 的获取方式是本地文件还是 url 即可。</p><p>设置完成后可在首页的 TV 观看电视直播，iptv 源的获取参照 <a href=https://aikenh.cn/cn/alist_potplayer/#Iptv-%E5%88%97%E8%A1%A8 target=_blank rel=noopener>Windows App01 Potplayer & Alist</a>
一文中的 iptv 列表获取。</p><h3 id=kodi-手机遥控器设置和添加>KODI 手机遥控器设置和添加<a hidden class=anchor aria-hidden=true href=#kodi-手机遥控器设置和添加>#</a></h3><p>手机端直接下载 Kodi remote control ，参考设置进行配置即可</p><p><div class=post-img-view><a data-fancybox=gallery href=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230701100221.png><img alt=image.png loading=lazy src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230701100221.png class=responsive-image src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230701100221.png style="display:block;margin:0 auto" alt=image.png></a></div><script>document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".responsive-image"),t=window.innerHeight/2.5;e.forEach(function(e){e.style.maxHeight=t+"px"})})</script></p><p><div class=post-img-view><a data-fancybox=gallery href=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230701100227.png><img alt=image.png loading=lazy src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230701100227.png class=responsive-image src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230701100227.png style="display:block;margin:0 auto" alt=image.png></a></div><script>document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".responsive-image"),t=window.innerHeight/2.5;e.forEach(function(e){e.style.maxHeight=t+"px"})})</script></p><p>这里可能需要设置以下用户名和密码，来允许 HTTP 控制。</p><h3 id=树莓派投屏方案>树莓派投屏方案<a hidden class=anchor aria-hidden=true href=#树莓派投屏方案>#</a></h3><blockquote><p>根据 kodi 的 wiki 已知其已经不支持 ios8 以上的 Airplay 功能，因此针对投屏的需求，只能通过视频软件或者播放器的 UpnP/DLNA 支持进行投屏。</p></blockquote><ul><li>在 kodi 的设置界面->服务->UpnP/DLNA 中选择启用的相关选项</li><li>在 ios 中设置->对应的视频软件（如bilibili）->本地网络选择启用</li></ul><p>播放视频时左上角 tv 的按钮，并选中本地局域网中的 kodi 即可。</p><h2 id=trouble-shooting-问题解决>Trouble Shooting 问题解决<a hidden class=anchor aria-hidden=true href=#trouble-shooting-问题解决>#</a></h2><h3 id=kodi-官方教程安装失败原因及解决>Kodi 官方教程安装失败原因及解决<a hidden class=anchor aria-hidden=true href=#kodi-官方教程安装失败原因及解决>#</a></h3><p><strong>问题描述与分析</strong></p><p>尝试了 <strong>Ubuntu22.04+RaspBerry 4B+Kodi+Alist</strong> 的方案，发现这种方案<strong>遵循官方教程</strong>无法在 Ubuntu 中成功的安装 Kodi，成功安装后出现以下的问题：</p><ul><li>command not found</li><li>无对应的 desktop app</li><li>desktop app 无法打开</li></ul><p>该原因是由于<strong>基于官方PPA</strong>在 <strong>Ubuntu 上安装的 Kodi 似乎无法在 RaspBerry 的架构</strong>上执行，因此无法成功安装，具体可以参考如下的几个连接，其中的讨论对该原因也会有所讲解。</p><ul><li><a href="https://forums.raspberrypi.com/viewtopic.php?t=312797" target=_blank rel=noopener>Has anyone got kodi working on ubuntu 21.04 - Raspberry Pi Forums</a></li><li><a href=https://www.reddit.com/r/kodi/comments/nmpcbl/kodi_for_ubuntu_raspberry_pi_version/ target=_blank rel=noopener>KODI for Ubuntu Raspberry Pi version : r/kodi (reddit.com)</a></li></ul><p>同时<a href=https://kodi.wiki/view/HOW-TO:Install_Kodi_for_Linux#Adding_Team_Kodi_PPA_repository target=_blank rel=noopener>官方</a>
指出，这种方式不适用于 armhf，（似乎 raspberry 4b 的 arm64 也无法执行</p><blockquote><p>Note that this PPA only provides builds for Ubuntu i386 and Ubuntu amd64 but <em>not for Ubuntu armhf</em>, which can run on a Raspberry Pi.</p></blockquote><p>可以以此<strong>查看系统的架构</strong>：<a href=https://www.coonote.com/note/linux-amd-arm.html target=_blank rel=noopener>查看linux系统是哪种架构：AMD、ARM、x86、x86_64、pcc 或 查看Ubuntu的版本号-菜鸟笔记 (coonote.com)</a></p><p><strong>架构间的区别</strong>如下：<a href=https://forum.cloudreve.org/d/1855 target=_blank rel=noopener>安装包amd,amd64,arm,arm64都有什么区别？ - Cloudreve Forum</a></p><blockquote><ol><li>amd64是 X86架构的 CPU，64位版。amd64又叫 X86_64。主流的桌面 PC，笔记本电脑，服务器（包括虚拟机）都在用 X86_64的 CPU。</li><li>arm64是 ARM 架构的 CPU，64位版。苹果新出的电脑在用 ARM 架构的 CPU。有些路由器和嵌入式设备在用 arm64的 CPU。手机和安卓平板电脑最常用的 CPU 也是 ARM 架构的。</li><li>MIPS 是 MIPS 架构的 CPU。有些嵌入式设备和家用路由器在用 MIPS 架构的 CPU。</li></ol></blockquote><p>简单的说就是：</p><ul><li>AMD64=linux-64bit=X86</li><li>ARM64=linux- <a href="https://so.csdn.net/so/search?q=Aarch64&amp;spm=1001.2101.3001.7020" target=_blank rel=noopener>Aarch64</a>
=ARM</li></ul><blockquote><p>Aarch 指的就是 <a href="https://so.csdn.net/so/search?q=ARM&amp;spm=1001.2101.3001.7020" target=_blank rel=noopener>ARM</a>
 architecture</p></blockquote><p><strong>解决方案</strong></p><p>发现是架构不匹配的原因导致的时候，去查询相关的源是否有对应架构的安装包：<a href=https://pkgs.org/download/kodi target=_blank rel=noopener>Kodi Download (APK, DEB, EOPKG, PKG, RPM, TXZ, XBPS, ZST) (pkgs.org)</a>
找到了 Arm64 的版本</p><p><div class=post-img-view><a data-fancybox=gallery href=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230628080044.png><img alt=image.png loading=lazy src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230628080044.png class=responsive-image src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230628080044.png style="display:block;margin:0 auto" alt=image.png></a></div><script>document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".responsive-image"),t=window.innerHeight/2.5;e.forEach(function(e){e.style.maxHeight=t+"px"})})</script></p><p>但是进去看可以发现实际上该安装还是指向了官方 PPA，安装的 ARCH 描述为 ALL（not true），不过好在后面有别的选项：</p><p><div class=post-img-view><a data-fancybox=gallery href=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230628080303.png><img alt=image.png loading=lazy src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230628080303.png class=responsive-image src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230628080303.png style="display:block;margin:0 auto" alt=image.png></a></div><script>document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".responsive-image"),t=window.innerHeight/2.5;e.forEach(function(e){e.style.maxHeight=t+"px"})})</script></p><p>找到下面的 arm64 的版本，详情页就能找到下载说明，由于是官方软件源，只需要 apt 安装就行，前提是将之前安装的会导致错误版本的 PPA 源卸载干净。</p><blockquote><p>可以到/etc/apt/sources.list.d/检查并将不需要的软件源删掉，再 sudo apt-get update 一下</p></blockquote><h3 id=ubuntu-播放-4k-视频卡顿掉帧>Ubuntu 播放 4k 视频卡顿掉帧<a hidden class=anchor aria-hidden=true href=#ubuntu-播放-4k-视频卡顿掉帧>#</a></h3><p>这部分可能是由于 Ubuntu 和 RaspBerryPi 一起用的时候，对于硬件的控制比较麻烦，导致功能中的<strong>硬解没有开启</strong>的地方导致，而在后续开启 Ubuntu 22.04 硬解的时候，需要去修改 Bios 文件，导致我这边系统损坏了无法开机，就没有做进一步的测试。</p><blockquote><p>20.04 和之前的版本有找到对应的文档， 22.04 好像暂时没有，参考之前的方案进行修改的时候出现了开机损坏的情况，所以还是要慎重。</p></blockquote><p><strong>检查硬解是否启用</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /proc/device-tree/soc/firmwarekms@7e600000/status
</span></span><span class=line><span class=cl>cat /proc/device-tree/v3dbus/v3d@7ec04000/status
</span></span></code></pre></td></tr></table></div></div><p>设置的参考资料：<a href=https://www.dedoimedo.com/computers/rpi4-ubuntu-mate-hw-video-acceleration.html target=_blank rel=noopener>RPI4 & Ubuntu MATE - How to enable video acceleration (dedoimedo.com)</a></p><h3 id=树莓派-hdmi-热插拔>树莓派 HDMI 热插拔<a hidden class=anchor aria-hidden=true href=#树莓派-hdmi-热插拔>#</a></h3><blockquote><p>树莓派的 HDMI 接口在长时间未使用，或者在开机的时候未连接显示器的时候，会默认以无显示输出的情况启动，导致电视无法正常输出图像。</p></blockquote><p>为此，我们需要开启设置中的 <code>hdmi_force_hotplug=1</code>，无论是否检测到 Hdmi 显示器，都默认有 hdmi 连接，确保无需每次需要视频输出的时候都重启树莓派，具体的操作步骤如下：</p><blockquote><p>适用于 RaspBerryPi OS</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vim /boot/config.txt <span class=c1># 默认配置文件的地址</span>
</span></span></code></pre></td></tr></table></div></div><p>如果不在该地址，就需要找到启动分区所在的目录，应该在该目录下，找到该文件后修改将以下两项打开或新增之后重启树莓派即可；</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>hdmi_force_hotplug=1  
</span></span><span class=line><span class=cl>hdmi_drive=2
</span></span></code></pre></td></tr></table></div></div><ul><li><code>hdmi_force_hotplug=1</code> 设置树莓派使用 HDMI 热插拔模式，即使没有检测到 HDMI 显示器。</li><li><code>hdmi_drive=2</code> 将树莓派设置为正常的 HDMI 模式（如果支持和启用，将发送声音）。如果没有这条线，树莓派将默认切换到 DVI（无音频）模式。</li></ul><p>但是热插拔的情况下，可能会导致在最终使用 hdmi 输出的时候，树莓派自动设定的分辨率不符合我们的使用和设备预期，因此我们可能还要基于设备对树莓派的分辨率和输出模式做一个限制；</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>hdmi_group=1
</span></span><span class=line><span class=cl>hdmi_mode=16
</span></span></code></pre></td></tr></table></div></div><ul><li><code>hdmi_group</code> 指定分辨率格式1为 CEA，电视规格的分辨率；2为 DMT，计算机显示器使用的分辨率</li><li><code>hdmi_mode</code> 不同分辨率格式下的指定分辨率和刷新率情况，具体可以见表</li></ul><p><div class=post-img-view><a data-fancybox=gallery href=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230803091910.png><img alt=image.png loading=lazy src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230803091910.png class=responsive-image src=https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230803091910.png style="display:block;margin:0 auto" alt=image.png></a></div><script>document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".responsive-image"),t=window.innerHeight/2.5;e.forEach(function(e){e.style.maxHeight=t+"px"})})</script></p><p>参考资料：</p><ul><li><a href="https://www.cyandragon.net/?p=471" target=_blank rel=noopener>解决树莓派不接HDMI导致开机VNC无信号问题和分辨率不对问题 – CyanDragon</a></li><li><a href=https://likfe.com/2021/12/19/raspberry-pi-hdmi/ target=_blank rel=noopener>树莓派配置文件 config.txt - HDMI 热插拔 | Cafeting (likfe.com)</a></li><li><a href=https://shumeipai.nxez.com/2013/08/31/custom-display-resolution-raspberry-pie.html target=_blank rel=noopener>自定义树莓派的显示分辨率 | 树莓派实验室 (nxez.com)</a></li><li><a href=https://cloud-atlas.readthedocs.io/zh_CN/latest/arm/raspberry_pi/display/pi_hdmi.html target=_blank rel=noopener>树莓派HDMI配置 — Cloud Atlas 0.1 文档 (cloud-atlas.readthedocs.io)</a></li></ul><h2 id=fi>FI<a hidden class=anchor aria-hidden=true href=#fi>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://hugotest-phi.vercel.app/tags/dev/>Dev</a></li><li><a href=https://hugotest-phi.vercel.app/tags/raspberry-pie/>Raspberry-Pie</a></li><li><a href=https://hugotest-phi.vercel.app/tags/kodi/>Kodi</a></li></ul><nav class=paginav><a class=prev href=https://hugotest-phi.vercel.app/posts/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%B6%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/><span class=title>« Prev</span><br><span>树莓派02 家用服务器</span>
</a><a class=next href=https://hugotest-phi.vercel.app/posts/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BB%A3%E7%90%86%E5%85%B1%E4%BA%AB/><span class=title>Next »</span><br><span>Clash局域网代理共享</span></a></nav></footer><div id=disqus_thread></div><script>function loadDisqus(){var e=document,t=e.createElement("script");t.src="https://aiken-hugo.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t),window.disqus_config=function(){this.page.url=window.location.href,this.page.identifier=window.location.href.substring(18)}}var runningOnBrowser=typeof window!="undefined",isBot=runningOnBrowser&&!("onscroll"in window)||typeof navigator!="undefined"&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent),supportsIntersectionObserver=runningOnBrowser&&"IntersectionObserver"in window;setTimeout(function(){if(!isBot&&supportsIntersectionObserver){var e=new IntersectionObserver(function(t){t[0].isIntersecting&&(loadDisqus(),e.disconnect())},{threshold:[0]});e.observe(document.getElementById("disqus_thread"))}else loadDisqus()},1)</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by
Disqus.</a></noscript></article></main><footer class=footer><span>&copy; 2024 <a href=https://hugotest-phi.vercel.app/>aiken's blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a>
</span><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><span id=busuanzi_container>Visitors: <span id=busuanzi_value_site_uv></span>
Views: <span id=busuanzi_value_site_pv></span></span></footer><script>document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("busuanzi_value_site_uv"),t=document.getElementById("busuanzi_value_site_pv"),o=13863,i=16993;if(!e||!t){console.error("Busuanzi elements not found.");return}const n=new MutationObserver(e=>{for(let t of e)if(t.type==="childList"){n.disconnect(),t.target.innerHTML=parseInt(t.target.innerHTML||0)+o;break}}),s=new MutationObserver(e=>{for(let t of e)if(t.type==="childList"){s.disconnect(),t.target.innerHTML=parseInt(t.target.innerHTML||0)+i;break}});n.observe(e,{childList:!0}),s.observe(t,{childList:!0})})</script><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><span class=topInner><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
<span id=read_progress></span>
</span></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))}),document.getElementById("theme-toggle-nav").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script>document.addEventListener("scroll",function(){const t=document.getElementById("read_progress"),n=document.documentElement.scrollHeight,s=document.documentElement.clientHeight,o=document.documentElement.scrollTop||document.body.scrollTop;t.innerText=((o/(n-s)).toFixed(2)*100).toFixed(0)})</script><script>(function(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(e)}),i.parentNode.insertBefore(n,i)})("/js/pangu.js",function(){pangu.spacingPage()})</script></body></html>